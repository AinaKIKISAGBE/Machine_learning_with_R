<!DOCTYPE html>
<!-- saved from url=(0066)https://www.datacamp.com/community/tutorials/keras-r-deep-learning -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style type="text/css">@charset "UTF-8";[ng\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\:form{display:block;}.ng-animate-shim{visibility:hidden;}.ng-anchor{position:absolute;}</style><link rel="preload" href="./keras_ Deep Learning in R (article) - DataCamp_files/tutorial" as="script"><link rel="preload" href="./keras_ Deep Learning in R (article) - DataCamp_files/index.js.téléchargement" as="script"><link rel="preload" href="./keras_ Deep Learning in R (article) - DataCamp_files/app.js.téléchargement" as="script"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" class="next-head"><meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" class="next-head"><meta name="keywords" content="keras R" class="next-head"><meta name="description" content="In this tutorial to deep learning in R with RStudio&#39;s keras package, you&#39;ll learn how to build a Multi-Layer Perceptron (MLP)." class="next-head"><title class="next-head">keras: Deep Learning in R (article) - DataCamp</title><link rel="canonical" href="http://www.datacamp.com/community/tutorials/keras-r-deep-learning" class="next-head"><link rel="author" href="https://plus.google.com/u/0/+Datacamp/" class="next-head"><link rel="shortcut icon" type="image/x-icon" href="https://cdn.datacamp.com/main-app/assets/favicon-335cd0394b32102a39221d79e5fd7e51078e6d32a0c8aea59676a6869f84e9d8.ico" class="next-head"><meta property="og:title" content="keras: Deep Learning in R" class="next-head"><meta property="og:image" content="https://cdn.datacamp.com/community/logos/medium/placeholder.jpg" class="next-head"><meta property="og:url" content="http://www.datacamp.com/community/tutorials/keras-r-deep-learning" class="next-head"><meta property="og:type" content="article" class="next-head"><meta property="og:published_time" content="2017-06-28T14:09:19.000Z" class="next-head"><meta property="og:author" content="Karlijn Willems" class="next-head"><meta property="og:description" content="In this tutorial to deep learning in R with RStudio&#39;s keras package, you&#39;ll learn how to build a Multi-Layer Perceptron (MLP)." class="next-head"><meta property="og:site_name" content="DataCamp Community" class="next-head"><meta name="twitter:title" content="keras: Deep Learning in R" class="next-head"><meta name="twitter:description" content="In this tutorial to deep learning in R with RStudio&#39;s keras package, you&#39;ll learn how to build a Multi-Layer Perceptron (MLP)." class="next-head"><meta name="twitter:card" content="summary" class="next-head"><meta name="twitter:site" content="@DataCamp" class="next-head"><meta name="twitter:creator" content="@DataCamp" class="next-head"><meta name="twitter:domain" content="www.datacamp.com" class="next-head"><meta name="twitter:image" content="https://cdn.datacamp.com/community/logos/medium/placeholder.jpg" class="next-head"><meta name="twitter:image:width" content="300" class="next-head"><meta name="twitter:image:height" content="300" class="next-head"><meta name="twitter:image:alt" content="keras: Deep Learning in R" class="next-head"><meta name="article:publisher" content="https://www.facebook.com/DataCamp-726282547396228" class="next-head"><meta name="fb:app_id" content="726282547396228" class="next-head"><script type="text/javascript" async="" src="./keras_ Deep Learning in R (article) - DataCamp_files/linkid.js.téléchargement"></script><script async="" src="./keras_ Deep Learning in R (article) - DataCamp_files/get-loader.js.téléchargement"></script><script async="" src="./keras_ Deep Learning in R (article) - DataCamp_files/qevents.js.téléchargement"></script><script async="" src="./keras_ Deep Learning in R (article) - DataCamp_files/fs.js.téléchargement"></script><script src="./keras_ Deep Learning in R (article) - DataCamp_files/286618111707433" async=""></script><script async="" src="./keras_ Deep Learning in R (article) - DataCamp_files/fbevents.js.téléchargement"></script><script type="text/javascript" async="" src="./keras_ Deep Learning in R (article) - DataCamp_files/insight.min.js.téléchargement"></script><script type="text/javascript" async="" src="./keras_ Deep Learning in R (article) - DataCamp_files/analytics.js.téléchargement"></script><script async="" src="./keras_ Deep Learning in R (article) - DataCamp_files/gtm.js.téléchargement"></script><script class="next-head">
      (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-TGGWB2P');
    </script><style id="__jsx-style-23248140663">.Logo[data-jsx-ext~="23248140663"]{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto}.Logo__image[data-jsx-ext~="23248140663"]{display:block;width:122px;height:28px;margin-left:8px}.Logo__image[data-jsx-ext~="23248140663"] svg{fill:#FFFFFF}@media (min-width:800px){.Logo[data-jsx-ext~="23248140663"]{height:59px}.Logo__image[data-jsx-ext~="23248140663"]{margin:17px auto 0}}</style><style id="__jsx-style-21131652802">.Menu[data-jsx-ext~="21131652802"]{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto}.icon[data-jsx-ext~="21131652802"]{text-align:right}.icon[data-jsx-ext~="21131652802"] svg{margin-right:9px;width:20px;height:20px;fill:#FFFFFF}.content[data-jsx-ext~="21131652802"]{position:absolute;top:48px;left:0;right:0}.section[data-jsx-ext~="21131652802"]{margin-bottom:20px}.section[data-jsx-ext~="21131652802"] h5[data-jsx-ext~="21131652802"]{margin:0;padding-left:17px;font-size:13px;-webkit-letter-spacing:3.3px;-moz-letter-spacing:3.3px;-ms-letter-spacing:3.3px;letter-spacing:3.3px;line-height:36px;text-align:left;text-transform:uppercase;background-color:#195B73;color:#7ECCE2}.item[data-jsx-ext~="21131652802"]{margin-bottom:1px;padding-left:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-content:center;-ms-flex-line-pack:center;align-content:center;font-size:15px;-webkit-letter-spacing:0.2px;-moz-letter-spacing:0.2px;-ms-letter-spacing:0.2px;letter-spacing:0.2px;line-height:40px;text-decoration:none;color:#FFFFFF}.active[data-jsx-ext~="21131652802"]{background-color:#55AECB}a[data-jsx-ext~="21131652802"]:hover{background-color:#55AECB}.image[data-jsx-ext~="21131652802"]{margin-top:2px;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;width:30px;height:30px;text-align:center}.image[data-jsx-ext~="21131652802"] svg{fill:#195B73}.active[data-jsx-ext~="21131652802"] svg,a[data-jsx-ext~="21131652802"]:hover svg{fill:#FFFFFF}.text[data-jsx-ext~="21131652802"]{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto}@media (min-width:800px){.Menu[data-jsx-ext~="21131652802"]{width:100%}.content[data-jsx-ext~="21131652802"]{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;position:relative;height:auto;top:auto;left:auto;right:auto;background-image:none}.section[data-jsx-ext~="21131652802"] h5[data-jsx-ext~="21131652802"]{padding-left:0;text-align:center}}</style><style id="__jsx-style-22811602996">.SidebarMenu[data-jsx-ext~="22811602996"]{position:fixed;z-index:300;width:100vw;background-image: linear-gradient(207deg, #2388B0, #33AACC)}.SidebarMenu__content[data-jsx-ext~="22811602996"]{height:50px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.SidebarMenu.banner[data-jsx-ext~="22811602996"]{top:55px;-webkit-transition:all .2s;transition:all .2s}@media (min-width:800px){.SidebarMenu[data-jsx-ext~="22811602996"]{z-index:200;width:220px;top:0;left:0;background-image:none}.SidebarMenu__content[data-jsx-ext~="22811602996"]{height:auto;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column}.SidebarMenu.banner[data-jsx-ext~="22811602996"]{top:80px}}</style><style id="__jsx-style-23026453492">.Button[data-jsx-ext~="23026453492"]{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;height:33px;margin:auto 5px;padding:0 15px;font-size:13px;font-weight:bold;-webkit-letter-spacing:0.2px;-moz-letter-spacing:0.2px;-ms-letter-spacing:0.2px;letter-spacing:0.2px;white-space:nowrap;color:#3A3A3A;border:1px solid transparent;border-radius:4px;background-color:transparent;cursor:pointer;outline:none}.Button[data-jsx-ext~="23026453492"]::before,.Button[data-jsx-ext~="23026453492"]::after{content:'';-webkit-flex:1 0 auto;-ms-flex:1 0 auto;flex:1 0 auto}.icon[data-jsx-ext~="23026453492"]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;min-height:20px}.icon[data-jsx-ext~="23026453492"] svg{-webkit-flex:1 1 0;-ms-flex:1 1 0;flex:1 1 0;height:20px;-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;fill:#33AACC}.same[data-jsx-ext~="23026453492"] .icon[data-jsx-ext~="23026453492"]{min-width:13px;height:13px;margin-right:5px}.same[data-jsx-ext~="23026453492"] .icon[data-jsx-ext~="23026453492"] svg{height:13px}.Button[data-jsx-ext~="23026453492"]:disabled,.Button[data-jsx-ext~="23026453492"]:hover[data-jsx-ext~="23026453492"]:disabled{color:#D1D3D8;background-color:#E6EAEB}.primary[data-jsx-ext~="23026453492"]{background-color:#FFC844}.primary[data-jsx-ext~="23026453492"]:hover{background-color:#FBE28D}.secondary[data-jsx-ext~="23026453492"]{color:#FFFFFF;background-color:#33AACC}.secondary[data-jsx-ext~="23026453492"]:hover{background-color:#7ECCE2}.red[data-jsx-ext~="23026453492"]{color:#FFFFFF;background-color:#FE5C5C}.green[data-jsx-ext~="23026453492"]{height:35px;color:#FFFFFF;background-color:#FFFFFF}.green[data-jsx-ext~="23026453492"] .icon[data-jsx-ext~="23026453492"] svg{fill:#36D57D;width:35px;height:35px}.grey[data-jsx-ext~="23026453492"]{color:#3D4251;background-color:#D1D3D8}.grey[data-jsx-ext~="23026453492"]:hover{color:#3D4251;background-color:#E6EAEB}.big[data-jsx-ext~="23026453492"]{font-size:15px;height:42px}.extra[data-jsx-ext~="23026453492"]{font-size:17px;height:45px}.border[data-jsx-ext~="23026453492"]{border:1px solid #E3E7E8}.border[data-jsx-ext~="23026453492"]:hover{border:1px solid #33AACC}.seeAll[data-jsx-ext~="23026453492"]{border:1px solid #33AACC}.seeAll[data-jsx-ext~="23026453492"]:hover{border:1px solid #FFC844}.iconButton[data-jsx-ext~="23026453492"]:hover{color:#33AACC}.minWidth[data-jsx-ext~="23026453492"]{min-width:85px}.noPadding[data-jsx-ext~="23026453492"]{padding:0}@media (min-width:800px){.icon[data-jsx-ext~="23026453492"]{min-width:13px;height:13px;margin-right:5px}.icon[data-jsx-ext~="23026453492"] svg{height:13px}.big[data-jsx-ext~="23026453492"] .icon[data-jsx-ext~="23026453492"]{min-width:15px;height:15px}.big[data-jsx-ext~="23026453492"] svg{height:15px}.extra[data-jsx-ext~="23026453492"] .icon[data-jsx-ext~="23026453492"],.extraIcon[data-jsx-ext~="23026453492"]{min-width:17px;height:17px}.extra[data-jsx-ext~="23026453492"] svg,.extraIcon[data-jsx-ext~="23026453492"] svg{height:17px}.green[data-jsx-ext~="23026453492"]{padding:0 15px;color:#FFFFFF;background-color:#36D57D}.green[data-jsx-ext~="23026453492"] .icon[data-jsx-ext~="23026453492"] svg{width:13px;height:13px;fill:#FFFFFF}}</style><style id="__jsx-style-2894520075">.ActionBarSearch[data-jsx-ext~="2894520075"]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start}</style><style id="__jsx-style-2433585153">.ActionBarAuth[data-jsx-ext~="2433585153"]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end}.wrapper[data-jsx-ext~="2433585153"]{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;cursor:pointer}.name[data-jsx-ext~="2433585153"]{margin-right:9px;font-size:13px;font-weight:bold;color:#3D4251;text-decoration:none}.name[data-jsx-ext~="2433585153"]:hover{color:#33AACC}.logout[data-jsx-ext~="2433585153"]{font-size:15px;padding:10px;color:#3D4251;display:inline-block;min-width:100px}.logout[data-jsx-ext~="2433585153"]:hover{background-color:#F0F4F5;border-bottom:solid 1px #E3E7E8}.menuList[data-jsx-ext~="2433585153"] a[data-jsx-ext~="2433585153"]{display:block}</style><style id="__jsx-style-22958900640">.ActionBar[data-jsx-ext~="22958900640"]{height:50px;margin-top:50px;padding:0 5px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:space-between;-webkit-justify-content:space-between;-ms-flex-pack:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:#FFFFFF;border-bottom:1px solid #E3E7E8}.Page.content .ActionBar{margin-bottom:10px}@media (min-width:800px){.ActionBar[data-jsx-ext~="22958900640"]{width:calc(100% - 220px);height:50px;margin-top:0;margin-bottom:0;padding:0 25px;position:fixed;z-index:300}}</style><style id="__jsx-style-21449127091">.Title[data-jsx-ext~="21449127091"]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.Title[data-jsx-ext~="21449127091"] .icon[data-jsx-ext~="21449127091"]{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;min-width:18px;height:18px}.icon[data-jsx-ext~="21449127091"] svg{-webkit-flex:1 1 0;-ms-flex:1 1 0;flex:1 1 0;height:18px;-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;fill:#33AACC}.Title[data-jsx-ext~="21449127091"] .h1[data-jsx-ext~="21449127091"],.Title[data-jsx-ext~="21449127091"] h1[data-jsx-ext~="21449127091"]{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;margin:auto 0 auto 9px;font-size:22px;text-transform:capitalize}</style><style id="__jsx-style-2126402434">.TitleBar[data-jsx-ext~="2126402434"]{height:50px;padding:0 5px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:space-between;-webkit-justify-content:space-between;-ms-flex-pack:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;line-height:50px;background-color:#FFFFFF;border-bottom:1px solid #E3E7E8;margin-bottom:65px}.filter[data-jsx-ext~="2126402434"]{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:48px}.action[data-jsx-ext~="2126402434"]{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;line-height:normal}.title[data-jsx-ext~="2126402434"]{height:65px;line-height:65px;-webkit-flex:0 0 100%;-ms-flex:0 0 100%;flex:0 0 100%;-webkit-order:1;-ms-flex-order:1;order:1;text-align:center}h1[data-jsx-ext~="2126402434"]{margin:0 0}.Page.content .TitleBar{display:none}@media (min-width:800px){.TitleBar[data-jsx-ext~="2126402434"]{height:50px;padding:0 25px;display:-webkit-box !important;display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex-wrap:nowrap;-ms-flex-wrap:nowrap;flex-wrap:nowrap;-webkit-box-pack:space-between;-webkit-justify-content:space-between;-ms-flex-pack:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:29px;margin-top:50px;background-color:#FFFFFF;border-bottom:1px solid #E3E7E8}.filter[data-jsx-ext~="2126402434"]{-webkit-flex:0 0 33%;-ms-flex:0 0 33%;flex:0 0 33%;line-height:normal}.action[data-jsx-ext~="2126402434"]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;line-height:normal;-webkit-flex:0 0 33%;-ms-flex:0 0 33%;flex:0 0 33%}.action[data-jsx-ext~="2126402434"] a{line-height:0}.title[data-jsx-ext~="2126402434"]{-webkit-order:0;-ms-flex-order:0;order:0;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;text-align:center}h1[data-jsx-ext~="2126402434"]{margin:0 0}}</style><style id="__jsx-style-22323102667">.Upvote[data-jsx-ext~="22323102667"]{position:relative;width:54px;height:54px;overflow:hidden;border-radius:4px;border:1px solid #E6EAEB;background-color:#F0F4F5;cursor:pointer}.Upvote.news[data-jsx-ext~="22323102667"]{width:45px;height:45px;border:none;background-color:#FFFFFF}.Upvote[data-jsx-ext~="22323102667"]>div[data-jsx-ext~="22323102667"]{position:absolute;top:0;-webkit-transition:all 0.15s ease-in-out;transition:all 0.15s ease-in-out}.Upvote.upvoted[data-jsx-ext~="22323102667"]>div[data-jsx-ext~="22323102667"]{top:-54px}.Upvote.upvoted.news[data-jsx-ext~="22323102667"]>div[data-jsx-ext~="22323102667"]{top:-45px}.Upvote[data-jsx-ext~="22323102667"]>div[data-jsx-ext~="22323102667"]>div[data-jsx-ext~="22323102667"]{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;width:54px;height:54px}.Upvote.news[data-jsx-ext~="22323102667"]>div[data-jsx-ext~="22323102667"]>div[data-jsx-ext~="22323102667"]{width:45px;height:45px}.Upvote[data-jsx-ext~="22323102667"] .icon[data-jsx-ext~="22323102667"]{font-size:13px;color:#33AACC}.Upvote[data-jsx-ext~="22323102667"] .icon[data-jsx-ext~="22323102667"] svg{width:12px;height:12px}.Upvote[data-jsx-ext~="22323102667"] .count[data-jsx-ext~="22323102667"]{font-size:13px;font-weight:bold;-webkit-letter-spacing:0.2px;-moz-letter-spacing:0.2px;-ms-letter-spacing:0.2px;letter-spacing:0.2px;color:#686F75}.Upvote[data-jsx-ext~="22323102667"]:hover{background-color:#FFFFFF}.Upvote.news[data-jsx-ext~="22323102667"]:hover{background-color:#EBF4F7}.Upvote.news[data-jsx-ext~="22323102667"]:hover .count[data-jsx-ext~="22323102667"]{color:#33AACC}.Upvote[data-jsx-ext~="22323102667"] .voted[data-jsx-ext~="22323102667"]{background-color:#33AACC;border-color:#33AACC}.Upvote.news[data-jsx-ext~="22323102667"] .voted[data-jsx-ext~="22323102667"]{background-color:#FFFFFF;border:none}.Upvote[data-jsx-ext~="22323102667"] .voted[data-jsx-ext~="22323102667"] .icon[data-jsx-ext~="22323102667"]{color:#195B73}.Upvote.news[data-jsx-ext~="22323102667"] .voted[data-jsx-ext~="22323102667"] .icon[data-jsx-ext~="22323102667"] svg{fill:#36D57D}.Upvote[data-jsx-ext~="22323102667"] .voted[data-jsx-ext~="22323102667"] .count[data-jsx-ext~="22323102667"]{color:#FFFFFF}.Upvote.news[data-jsx-ext~="22323102667"] .voted[data-jsx-ext~="22323102667"] .count[data-jsx-ext~="22323102667"]{color:#36D57D}</style><style id="__jsx-style-21337150270">.Social[data-jsx-ext~="21337150270"]{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto}.icons[data-jsx-ext~="21337150270"]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.icon[data-jsx-ext~="21337150270"]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:28px;height:28px;border:1px solid #E3E7E8;background-color:#FFFFFF;border-radius:50%}.icon[data-jsx-ext~="21337150270"]:hover{background-color:#F0F4F5}.centerIcon[data-jsx-ext~="21337150270"]{margin:0 10px}.icon[data-jsx-ext~="21337150270"] svg{fill:#686F75;-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto}@media (min-width:800px){.Social[data-jsx-ext~="21337150270"]{margin-top:18px}.vertical[data-jsx-ext~="21337150270"]{margin-top:10px}.vertical[data-jsx-ext~="21337150270"] .icons[data-jsx-ext~="21337150270"]{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column}.vertical[data-jsx-ext~="21337150270"] .centerIcon[data-jsx-ext~="21337150270"]{margin:10px 0}}</style><style id="__jsx-style-22128240407">.Avatar[data-jsx-ext~="22128240407"]{display:inline-block;background-size:cover;background-color:#E6EAEB;background-repeat:no-repeat}</style><style id="__jsx-style-21725091107">.Author[data-jsx-ext~="21725091107"] a[data-jsx-ext~="21725091107"]{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;cursor:pointer}.info[data-jsx-ext~="21725091107"]{margin-left:9px;white-space:nowrap}.mirrored[data-jsx-ext~="21725091107"] .info[data-jsx-ext~="21725091107"]{margin:0 9px 0 0;-webkit-order:-1;-ms-flex-order:-1;order:-1}.name[data-jsx-ext~="21725091107"]{font-size:13px;font-weight:bold;-webkit-letter-spacing:0.2px;-moz-letter-spacing:0.2px;-ms-letter-spacing:0.2px;letter-spacing:0.2px;color:#3D4251;text-decoration:none}.name[data-jsx-ext~="21725091107"]:hover{color:#33AACC}.date[data-jsx-ext~="21725091107"]{font-size:11px;-webkit-letter-spacing:0.2px;-moz-letter-spacing:0.2px;-ms-letter-spacing:0.2px;letter-spacing:0.2px;color:#686F75}</style><style id="__jsx-style-22003367819">.Tag[data-jsx-ext~="22003367819"]{display:inline-block;border-radius:4px;background-color:#F0F4F5;border:solid 1px #E6EAEB;-webkit-letter-spacing:0.2px;-moz-letter-spacing:0.2px;-ms-letter-spacing:0.2px;letter-spacing:0.2px;color:#686F75;cursor:default}.title[data-jsx-ext~="22003367819"]{line-height:20px;padding:0 8px;font-size:11px;text-transform:uppercase}.Tag.mustRead[data-jsx-ext~="22003367819"]{background-color:#AD86CE;border-color:#AD86CE;color:#FFFFFF;font-weight:bold}.Tag[data-jsx-ext~="22003367819"]:hover{background-color:#FFFFFF}.Tag.mustRead[data-jsx-ext~="22003367819"]:hover{background-color:#CEABEC;border-color:#CEABEC}</style><style id="__jsx-style-3587769272">.more[data-jsx="3587769272"]{font-size:11px;cursor:default;color:#686F75}.more[data-jsx="3587769272"]:hover{text-decoration:underline}</style><style id="__jsx-style-13398489307">.tooltipInner .Tag{margin:4px}.rc-tooltip{position:absolute;z-index:200;display:block;visibility:visible;line-height:1.5;font-size:12px;border-radius:4px}.rc-tooltip-hidden{display:none}.rc-tooltip-inner{padding:12px;color:#333333;text-align:left;text-decoration:none;background-color:#ffffff;border-radius:4px;min-height:34px;border:1px solid #e3e7e8}.rc-tooltip-arrow,.rc-tooltip-arrow-inner{position:absolute;width:0;height:0;border-color:transparent;border-style:solid}.rc-tooltip-placement-top .rc-tooltip-arrow,.rc-tooltip-placement-topLeft .rc-tooltip-arrow,.rc-tooltip-placement-topRight .rc-tooltip-arrow{bottom:-5px;margin-left:-6px;border-width:6px 6px 0;border-top-color:#e3e7e8}.rc-tooltip-placement-top .rc-tooltip-arrow-inner,.rc-tooltip-placement-topLeft .rc-tooltip-arrow-inner,.rc-tooltip-placement-topRight .rc-tooltip-arrow-inner{bottom:1px;margin-left:-6px;border-width:6px 6px 0;border-top-color:#ffffff}.rc-tooltip-placement-top .rc-tooltip-arrow{left:50%}.rc-tooltip-placement-topLeft .rc-tooltip-arrow{left:15%}.rc-tooltip-placement-topRight .rc-tooltip-arrow{right:15%}.rc-tooltip-placement-right .rc-tooltip-arrow,.rc-tooltip-placement-rightTop .rc-tooltip-arrow,.rc-tooltip-placement-rightBottom .rc-tooltip-arrow{left:-5px;margin-top:-6px;border-width:6px 6px 6px 0;border-right-color:#e3e7e8}.rc-tooltip-placement-right .rc-tooltip-arrow-inner,.rc-tooltip-placement-rightTop .rc-tooltip-arrow-inner,.rc-tooltip-placement-rightBottom .rc-tooltip-arrow-inner{left:1px;margin-top:-6px;border-width:6px 6px 6px 0;border-right-color:#ffffff}.rc-tooltip-placement-right .rc-tooltip-arrow{top:50%}.rc-tooltip-placement-rightTop .rc-tooltip-arrow{top:15%;margin-top:0}.rc-tooltip-placement-rightBottom .rc-tooltip-arrow{bottom:15%}.rc-tooltip-placement-left .rc-tooltip-arrow,.rc-tooltip-placement-leftTop .rc-tooltip-arrow,.rc-tooltip-placement-leftBottom .rc-tooltip-arrow{right:-5px;margin-top:-6px;border-width:6px 0 6px 6px;border-left-color:#e3e7e8}.rc-tooltip-placement-left .rc-tooltip-arrow-inner,.rc-tooltip-placement-leftTop .rc-tooltip-arrow-inner,.rc-tooltip-placement-leftBottom .rc-tooltip-arrow-inner{right:1px;margin-top:-6px;border-width:6px 0 6px 6px;border-left-color:#ffffff}.rc-tooltip-placement-left .rc-tooltip-arrow{top:50%}.rc-tooltip-placement-leftTop .rc-tooltip-arrow{top:15%;margin-top:0}.rc-tooltip-placement-leftBottom .rc-tooltip-arrow{bottom:15%}.rc-tooltip-placement-bottom .rc-tooltip-arrow,.rc-tooltip-placement-bottomLeft .rc-tooltip-arrow,.rc-tooltip-placement-bottomRight .rc-tooltip-arrow{top:-5px;margin-left:-6px;border-width:0 6px 6px;border-bottom-color:#e3e7e8}.rc-tooltip-placement-bottom .rc-tooltip-arrow-inner,.rc-tooltip-placement-bottomLeft .rc-tooltip-arrow-inner,.rc-tooltip-placement-bottomRight .rc-tooltip-arrow-inner{top:1px;margin-left:-6px;border-width:0 6px 6px;border-bottom-color:#ffffff}.rc-tooltip-placement-bottom .rc-tooltip-arrow{left:50%}.rc-tooltip-placement-bottomLeft .rc-tooltip-arrow{left:15%}.rc-tooltip-placement-bottomRight .rc-tooltip-arrow{right:15%}.rc-tooltip.rc-tooltip-zoom-enter,.rc-tooltip.rc-tooltip-zoom-leave{display:block}.rc-tooltip-zoom-enter,.rc-tooltip-zoom-appear{opacity:0;-webkit-animation-duration:0.3s;-webkit-animation-duration:0.3s;animation-duration:0.3s;-webkit-animation-fill-mode:both;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-timing-function:cubic-bezier(0.18,0.89,0.32,1.28);-webkit-animation-timing-function:cubic-bezier(0.18,0.89,0.32,1.28);animation-timing-function:cubic-bezier(0.18,0.89,0.32,1.28);-webkit-animation-play-state:paused;-webkit-animation-play-state:paused;animation-play-state:paused}.rc-tooltip-zoom-leave{-webkit-animation-duration:0.3s;-webkit-animation-duration:0.3s;animation-duration:0.3s;-webkit-animation-fill-mode:both;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-timing-function:cubic-bezier(0.6,-0.3,0.74,0.05);-webkit-animation-timing-function:cubic-bezier(0.6,-0.3,0.74,0.05);animation-timing-function:cubic-bezier(0.6,-0.3,0.74,0.05);-webkit-animation-play-state:paused;-webkit-animation-play-state:paused;animation-play-state:paused}.rc-tooltip-zoom-enter.rc-tooltip-zoom-enter-active,.rc-tooltip-zoom-appear.rc-tooltip-zoom-appear-active{-webkit-animation-name:rcToolTipZoomIn;-webkit-animation-name:rcToolTipZoomIn;animation-name:rcToolTipZoomIn;-webkit-animation-play-state:running;-webkit-animation-play-state:running;animation-play-state:running}.rc-tooltip-zoom-leave.rc-tooltip-zoom-leave-active{-webkit-animation-name:rcToolTipZoomOut;-webkit-animation-name:rcToolTipZoomOut;animation-name:rcToolTipZoomOut;-webkit-animation-play-state:running;-webkit-animation-play-state:running;animation-play-state:running}@-webkit-keyframes rcToolTipZoomIn0%{opacity:0;-webkit-transform-origin:50% 50%;-webkit-transform-origin:50% 50%;-ms-transform-origin:50% 50%;transform-origin:50% 50%;-webkit-transform:scale(0,0);-webkit-transform:scale(0,0);-ms-transform:scale(0,0);transform:scale(0,0)}100%{opacity:1;-webkit-transform-origin:50% 50%;-webkit-transform-origin:50% 50%;-ms-transform-origin:50% 50%;transform-origin:50% 50%;-webkit-transform:scale(1,1);-webkit-transform:scale(1,1);-ms-transform:scale(1,1);transform:scale(1,1)}@-webkit-keyframes rcToolTipZoomIn{0%{opacity:0;-webkit-transform-origin:50% 50%;-webkit-transform-origin:50% 50%;-ms-transform-origin:50% 50%;transform-origin:50% 50%;-webkit-transform:scale(0,0);-webkit-transform:scale(0,0);-ms-transform:scale(0,0);transform:scale(0,0)}100%{opacity:1;-webkit-transform-origin:50% 50%;-webkit-transform-origin:50% 50%;-ms-transform-origin:50% 50%;transform-origin:50% 50%;-webkit-transform:scale(1,1);-webkit-transform:scale(1,1);-ms-transform:scale(1,1);transform:scale(1,1)}}@keyframes rcToolTipZoomIn{0%{opacity:0;-webkit-transform-origin:50% 50%;-webkit-transform-origin:50% 50%;-ms-transform-origin:50% 50%;transform-origin:50% 50%;-webkit-transform:scale(0,0);-webkit-transform:scale(0,0);-ms-transform:scale(0,0);transform:scale(0,0)}100%{opacity:1;-webkit-transform-origin:50% 50%;-webkit-transform-origin:50% 50%;-ms-transform-origin:50% 50%;transform-origin:50% 50%;-webkit-transform:scale(1,1);-webkit-transform:scale(1,1);-ms-transform:scale(1,1);transform:scale(1,1)}}@-webkit-keyframes rcToolTipZoomOut0%{opacity:1;-webkit-transform-origin:50% 50%;-webkit-transform-origin:50% 50%;-ms-transform-origin:50% 50%;transform-origin:50% 50%;-webkit-transform:scale(1,1);-webkit-transform:scale(1,1);-ms-transform:scale(1,1);transform:scale(1,1)}100%{opacity:0;-webkit-transform-origin:50% 50%;-webkit-transform-origin:50% 50%;-ms-transform-origin:50% 50%;transform-origin:50% 50%;-webkit-transform:scale(0,0);-webkit-transform:scale(0,0);-ms-transform:scale(0,0);transform:scale(0,0)}@-webkit-keyframes rcToolTipZoomOut{0%{opacity:1;-webkit-transform-origin:50% 50%;-webkit-transform-origin:50% 50%;-ms-transform-origin:50% 50%;transform-origin:50% 50%;-webkit-transform:scale(1,1);-webkit-transform:scale(1,1);-ms-transform:scale(1,1);transform:scale(1,1)}100%{opacity:0;-webkit-transform-origin:50% 50%;-webkit-transform-origin:50% 50%;-ms-transform-origin:50% 50%;transform-origin:50% 50%;-webkit-transform:scale(0,0);-webkit-transform:scale(0,0);-ms-transform:scale(0,0);transform:scale(0,0)}}@keyframes rcToolTipZoomOut{0%{opacity:1;-webkit-transform-origin:50% 50%;-webkit-transform-origin:50% 50%;-ms-transform-origin:50% 50%;transform-origin:50% 50%;-webkit-transform:scale(1,1);-webkit-transform:scale(1,1);-ms-transform:scale(1,1);transform:scale(1,1)}100%{opacity:0;-webkit-transform-origin:50% 50%;-webkit-transform-origin:50% 50%;-ms-transform-origin:50% 50%;transform-origin:50% 50%;-webkit-transform:scale(0,0);-webkit-transform:scale(0,0);-ms-transform:scale(0,0);transform:scale(0,0)}}</style><style id="__jsx-style-1974660517">.TagLine[data-jsx="1974660517"]{display:inline-block;white-space:nowrap}.TagLine[data-jsx="1974660517"]>.Tag{margin-right:10px}.more[data-jsx="1974660517"]{font-size:11px}</style><style id="__jsx-style-13676989159">.markdown{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start}.markdown [data-datacamp-exercise]{overflow:hidden}.markdown>div{width:100%}.markdown div{outline:none}.markdown hr{border:0;border-bottom:1px solid #E6EAEB;margin:60px 0}.markdown div[data-type="mathjax"]{margin:30px 0}.markdown p{margin:0 20px;font-family:'Adamina',serif;font-size:21px;line-height:35px;-webkit-letter-spacing:0.5px;-moz-letter-spacing:0.5px;-ms-letter-spacing:0.5px;letter-spacing:0.5px;color:#3D4251}.markdown .powered-by-datacamp+p{margin-top:30px !important}.markdown p+p,.markdown p+img,.markdown p+div,.markdown p+table,.markdown p+ol,.markdown p+ul,.markdown p+nav{margin-top:30px !important}.markdown h2{margin:42px 20px 25px}.markdown h3{color:#3D4251;font-weight:bold;margin:42px 20px 25px}.markdown h4{color:#686F75;font-weight:bold;margin:42px 20px 25px}.markdown code{padding:4px 2px;border-radius:4px;font-family:'Roboto Mono',monospace;font-size:14px;font-weight:300;color:#3D4251;background-color:#F0F4F5}.markdown pre{padding:20px 20px;font-family:'Roboto Mono',monospace;font-size:15px;font-weight:300;line-height:25px;color:#FFFFFF;background-color:#002B36 !important;border-radius:4px;overflow-x:auto}.markdown pre code{padding:0;font-size:15px;line-height:25px;color:#FFFFFF;background-color:#002B36;overflow-x:visible}.markdown img{display:block;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;margin:auto;max-width:100%;height:auto !important}.markdown img+p{margin-top:30px !important}.markdown nav+p,.markdown nav+div{margin-top:30px !important}.markdown iframe{width:100%}.markdown ul,.markdown ol{font-family:'Adamina',serif;font-size:21px;line-height:35px;-webkit-letter-spacing:0.5px;-moz-letter-spacing:0.5px;-ms-letter-spacing:0.5px;letter-spacing:0.5px;color:#3D4251;margin:0 20px;padding:0 20px;width:100%;list-style-position:outside;line-height:35px}.markdown ul+p,.markdown ol+p,.markdown ul+div,.markdown ol+div,.markdown ul+pre,.markdown ol+pre{margin-top:30px !important}.markdown div.datacamp-exercise ul,.markdown div.datacamp-exercise ol{background-color:initial;margin:initial;padding:initial;width:initial;list-style-position:initial;line-height:initial}.markdown ul.oneliner,.markdown ol.oneliner{padding:0;list-style-position:inside;line-height:32px}.markdown li{padding-left:0;padding-right:20px;font-size:21px;line-height:35px}.markdown div.datacamp-exercise li{padding-left:initial;background-color:initial;font-size:initial;font-weight:initial;line-height:initial}.markdown li p{margin:0;font-size:21px;line-height:35px;font-weight:normal}.markdown ul.oneliner li,.markdown ol.oneliner li{padding-left:0;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.markdown ul ul{margin:0;list-style:circle}.markdown ol ol{margin:0}.markdown ol ul,.markdown ul ol{margin:0}.markdown a{font-weight:400;text-decoration:none;color:#33AACC}.markdown a:hover{text-decoration:underline}.markdown div.datacamp-exercise a{font-weight:initial;text-decoration:initial}.markdown div.datacamp-exercise a:hover{text-decoration:initial}.markdown blockquote{margin:40px 20px;font-family:'Lato',sans-serif;font-weight:300;font-size:28px;font-style:italic;-webkit-letter-spacing:0.6px;-moz-letter-spacing:0.6px;-ms-letter-spacing:0.6px;letter-spacing:0.6px;line-height:39px}.markdown blockquote::before{display:block;margin-bottom:15px;width:35px;height:35px;font-family:'Adamina',serif;font-size:36px;font-weight:bold;font-style:normal;line-height:60px;text-align:center;color:#33AACC;content:'“';border:1px solid #E3E7E8;border-radius:50%}.markdown table{width:100% !important;font-family:'Lato',sans-serif;font-size:18px;border-collapse:collapse}.markdown tr{height:50px}.markdown tr:nth-child(odd){background-color:#F0F4F5}.markdown td{padding:0 20px}.markdown table+p{margin-top:30px !important}.markdown table+img{margin-top:30px !important}.markdown table+div{margin-top:30px !important}.markdown .dcl-content--tab-body{margin-top:0 !important}@media (min-width:800px){.markdown p{margin:0;font-size:21px;line-height:35px;-webkit-letter-spacing:0.5px;-moz-letter-spacing:0.5px;-ms-letter-spacing:0.5px;letter-spacing:0.5px}.markdown h2,.markdown h3,.markdown h4{margin:40px 0 25px}.markdown ul,.markdown ol{margin:0;padding:0 0 0 20px}.markdown li{padding-right:0;font-size:21px;line-height:35px}.markdown li p{font-size:21px;line-height:35px;font-weight:normal}.markdown ul+p,.markdown ol+p,.markdown ul+div,.markdown ol+div,.markdown ul+pre,.markdown ol+pre{margin-top:36px !important}.markdown blockquote{position:relative;margin:50px 55px}.markdown blockquote::before{position:absolute;left:-55px}}.output_wrapper{overflow-x:auto}</style><style id="__jsx-style-22564400772">.SidebarSocial[data-jsx-ext~="22564400772"]{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;font-size:11px;font-weight:bold}.SidebarSocial--openMenu[data-jsx-ext~="22564400772"]{position:absolute;bottom:0;left:0;right:0}.rss[data-jsx-ext~="22564400772"]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;line-height:50px}.rss[data-jsx-ext~="22564400772"] svg{padding-right:7px;fill:#FFC844}.rss[data-jsx-ext~="22564400772"] a[data-jsx-ext~="22564400772"]{text-decoration:none;color:#FFFFFF}.rss[data-jsx-ext~="22564400772"] a[data-jsx-ext~="22564400772"]:hover{text-decoration:none;color:#FFC844}.icons[data-jsx-ext~="22564400772"]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.icon[data-jsx-ext~="22564400772"]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin:0 7px;width:30px;height:30px;background-color:#195B73;border-radius:50%}.icon[data-jsx-ext~="22564400772"] svg{fill:#7ECCE2;-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;-webkit-flex:1 1 0;-ms-flex:1 1 0;flex:1 1 0}.icon[data-jsx-ext~="22564400772"]:hover svg{fill:#FFFFFF}.menu[data-jsx-ext~="22564400772"]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;line-height:44px}.menuItem[data-jsx-ext~="22564400772"]{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;padding:5px;text-decoration:none;color:#195B73}.menuItem--active[data-jsx-ext~="22564400772"],a[data-jsx-ext~="22564400772"]:hover{color:#F0F4F5}@media (min-width:800px){.SidebarSocial[data-jsx-ext~="22564400772"]{width:220px;position:fixed;bottom:0;left:0}}</style><style id="__jsx-style-2621171990">.Layout[data-jsx-ext~="2621171990"]{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch}.Layout--openMenu[data-jsx-ext~="2621171990"]{position:relative;min-height:568px;height:100vh}.Main[data-jsx-ext~="2621171990"]{min-height:100vh;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;background-color:#F0F4F5}.Main.banner[data-jsx-ext~="2621171990"]{margin-top:55px;-webkit-transition:all .2s;transition:all .2s}@media (min-width:800px){.Main[data-jsx-ext~="2621171990"]{margin-left:220px}.Main.banner[data-jsx-ext~="2621171990"]{margin-top:80px}}</style><style id="__jsx-style-2343812706">.Tutorial[data-jsx-ext~="2343812706"]{margin:0 10px 30px;padding:20px 0 0;background-color:#FFFFFF;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;border:1px solid #E3E7E8;border-radius:4px}.preface[data-jsx-ext~="2343812706"]{margin:0 20px}.author[data-jsx-ext~="2343812706"]{margin-bottom:10px}h1[data-jsx-ext~="2343812706"]{margin:20px 0 15px}.description[data-jsx-ext~="2343812706"]{margin-bottom:30px;font-family:'Adamina',serif;font-size:26px;line-height:39px;-webkit-letter-spacing:0.5px;-moz-letter-spacing:0.5px;-ms-letter-spacing:0.5px;letter-spacing:0.5px;color:#3D4251}.Blog[data-jsx-ext~="2343812706"] .social__top{position:relative;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto}.illustration[data-jsx-ext~="2343812706"]{margin-bottom:30px}.illustration[data-jsx-ext~="2343812706"] img[data-jsx-ext~="2343812706"]{max-width:100%}.Tutorial[data-jsx-ext~="2343812706"] .social__top .voteAndSocial,.social__bottom[data-jsx-ext~="2343812706"] .voteAndSocial[data-jsx-ext~="2343812706"]{padding:25px 20px 30px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:space-between;-webkit-justify-content:space-between;-ms-flex-pack:space-between;justify-content:space-between;-webkit-align-items:flex-end;-webkit-box-align:flex-end;-ms-flex-align:flex-end;align-items:flex-end}@media (min-width:800px){.Tutorial[data-jsx-ext~="2343812706"]{margin:0 auto 115px;padding:30px 100px 100px;max-width:1120px}.Tutorial.withRecommend[data-jsx-ext~="2343812706"]{margin:0 auto 30px}.preface[data-jsx-ext~="2343812706"]{margin:0}.description[data-jsx-ext~="2343812706"]{-webkit-letter-spacing:0.5px;-moz-letter-spacing:0.5px;-ms-letter-spacing:0.5px;letter-spacing:0.5px;font-size:26px;line-height:39px}.Tutorial[data-jsx-ext~="2343812706"] .social__top{position:absolute;margin-top:210px}.Tutorial[data-jsx-ext~="2343812706"] .social__top .voteAndSocial{position:absolute;left:-100px;top:0;width:100px;height:auto;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}}</style><style id="__jsx-style-13776494915">*{box-sizing:border-box}html,body{min-height:100vh;margin:0;padding:0;background-image: linear-gradient(207deg, #2388B0, #33AACC); background-size: 100vw 100vh; background-attachment: fixed; background-repeat: no-repeat}body.ReactModal__Body--open{overflow:hidden}.ReactModal__Content{width:100%}img{margin:auto}.mobileOnlyShow{display:block !important}.mobileOnlyHide{display:none !important}.mobileOnly{display:block !important}.desktopOnly{display:none !important}@media (min-width:800px){body{background-image: linear-gradient(207deg, #2388B0, #33AACC); background-size: 220px 100vh; background-attachment: fixed; background-repeat: no-repeat}.ReactModal__Content{width:auto}.mobileOnlyShow{display:block !important}.mobileOnlyHide{display:block !important}.mobileOnly{display:none !important}.desktopOnly{display:block !important}}</style><script async="" src="./keras_ Deep Learning in R (article) - DataCamp_files/datacamp-light-latest.min.js.téléchargement"></script><script async="" src="./keras_ Deep Learning in R (article) - DataCamp_files/highlight.min.js.téléchargement"></script><script async="" src="./keras_ Deep Learning in R (article) - DataCamp_files/MathJax.js.téléchargement"></script><style id="__jsx-style-11987056293">body,input,button,select,textarea{font-family:'Lato',sans-serif;color:#686F75;font-size:15px}h1,.h1{font-size:29px;color:#3D4251;font-weight:bold}h2{font-size:20px;-webkit-letter-spacing:0.3px;-moz-letter-spacing:0.3px;-ms-letter-spacing:0.3px;letter-spacing:0.3px;line-height:1.33;font-weight:bold;margin:18px 0px;color:#3D4251}h2.blue{color:#33AACC}a{color:#33AACC;text-decoration:none}.blocText{font-size:15px;-webkit-letter-spacing:0.2px;-moz-letter-spacing:0.2px;-ms-letter-spacing:0.2px;letter-spacing:0.2px;line-height:1.47;color:#686F75}label{display:block;width:100%;margin-bottom:8px;font-size:13px}label span{float:right;font-weight:300}input,textarea{padding:15px;font-weight:300;color:#3D4251;background-color:#F0F4F5;border:1px solid transparent;border-radius:4px;outline-style:none}input:disabled,textarea:disabled{color:#686F75;background-color:#E6EAEB}input.error,textarea.error{border:1px solid #FE5C5C}input:focus,textarea:focus{border:1px solid #33AACC;-webkit-transition:border 150ms ease-out;transition:border 150ms ease-out}input::-webkit-input-placeholder,textarea::-webkit-input-placeholder{color:#33AACC;-webkit-transition:color 150ms ease-out;transition:color 150ms ease-out}input::-moz-placeholder,textarea::-moz-placeholder{color:#33AACC;-webkit-transition:color 150ms ease-out;transition:color 150ms ease-out}input:-ms-input-placeholder,textarea:-ms-input-placeholder{color:#33AACC;-webkit-transition:color 150ms ease-out;transition:color 150ms ease-out}input::placeholder,textarea::placeholder{color:#33AACC;-webkit-transition:color 150ms ease-out;transition:color 150ms ease-out}input:focus::-webkit-input-placeholder,textarea:focus::-webkit-input-placeholder{color:transparent}input:focus::-moz-placeholder,textarea:focus::-moz-placeholder{color:transparent}input:focus:-ms-input-placeholder,textarea:focus:-ms-input-placeholder{color:transparent}input:focus::placeholder,textarea:focus::placeholder{color:transparent}input.small,textarea.small{margin-bottom:19px;padding:8px 10px;font-size:13px}textarea.small{min-height:55px}@media (min-width:800px){h1,.h1{font-size:36px}h2{font-size:32px}}</style><style type="text/css">div.datacamp-exercise {  margin: 0;  border: 1px solid #d5eaef;  background: none;  position: relative;  min-height: 300px;  color: black;  box-shadow: none;}div[data-datacamp-exercise] {  margin: 0;  border: 1px solid #d5eaef;  background: #fff url(https://cdn.datacamp.com/spinner.gif) no-repeat center center !important;  background-size: auto 80px !important;  position: relative;  min-height: 300px;  color: transparent;  box-shadow: none;}div[data-datacamp-exercise] > code,div[data-datacamp-exercise] > div,div[data-datacamp-exercise] > p {  display: none;}div.powered-by-datacamp {  margin: 5px 0;  display: block;}div.powered-by-datacamp a {@import "https://fonts.googleapis.com/css?family=Open+Sans";  font-family: "Open Sans", sans-serif;  text-decoration: none;  border: 0;  color: #3ac;  font-size: 20px;}div.powered-by-datacamp .logo {  vertical-align: sub;  display: inline-block;  background: url("https://cdn.datacamp.com/dcl/assets/images/logo_blue.svg") no-repeat center center;  background-size: contain;  height: 27px;  width: 23px;  margin-left: 4px;}</style><link type="text/css" rel="stylesheet" href="./keras_ Deep Learning in R (article) - DataCamp_files/style-8c2f2e17fe.css"><link type="text/css" rel="stylesheet" href="./keras_ Deep Learning in R (article) - DataCamp_files/font-awesome.min.css"><script async="" src="./keras_ Deep Learning in R (article) - DataCamp_files/r.min.js.téléchargement"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style id="ace_editor.css">.ace_editor {position: relative;overflow: hidden;font: 12px/normal 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'source-code-pro', monospace;direction: ltr;text-align: left;}.ace_scroller {position: absolute;overflow: hidden;top: 0;bottom: 0;background-color: inherit;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;cursor: text;}.ace_content {position: absolute;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;min-width: 100%;}.ace_dragging .ace_scroller:before{position: absolute;top: 0;left: 0;right: 0;bottom: 0;content: '';background: rgba(250, 250, 250, 0.01);z-index: 1000;}.ace_dragging.ace_dark .ace_scroller:before{background: rgba(0, 0, 0, 0.01);}.ace_selecting, .ace_selecting * {cursor: text !important;}.ace_gutter {position: absolute;overflow : hidden;width: auto;top: 0;bottom: 0;left: 0;cursor: default;z-index: 4;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;}.ace_gutter-active-line {position: absolute;left: 0;right: 0;}.ace_scroller.ace_scroll-left {box-shadow: 17px 0 16px -16px rgba(0, 0, 0, 0.4) inset;}.ace_gutter-cell {padding-left: 19px;padding-right: 6px;background-repeat: no-repeat;}.ace_gutter-cell.ace_error {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABOFBMVEX/////////QRswFAb/Ui4wFAYwFAYwFAaWGAfDRymzOSH/PxswFAb/SiUwFAYwFAbUPRvjQiDllog5HhHdRybsTi3/Tyv9Tir+Syj/UC3////XurebMBIwFAb/RSHbPx/gUzfdwL3kzMivKBAwFAbbvbnhPx66NhowFAYwFAaZJg8wFAaxKBDZurf/RB6mMxb/SCMwFAYwFAbxQB3+RB4wFAb/Qhy4Oh+4QifbNRcwFAYwFAYwFAb/QRzdNhgwFAYwFAbav7v/Uy7oaE68MBK5LxLewr/r2NXewLswFAaxJw4wFAbkPRy2PyYwFAaxKhLm1tMwFAazPiQwFAaUGAb/QBrfOx3bvrv/VC/maE4wFAbRPBq6MRO8Qynew8Dp2tjfwb0wFAbx6eju5+by6uns4uH9/f36+vr/GkHjAAAAYnRSTlMAGt+64rnWu/bo8eAA4InH3+DwoN7j4eLi4xP99Nfg4+b+/u9B/eDs1MD1mO7+4PHg2MXa347g7vDizMLN4eG+Pv7i5evs/v79yu7S3/DV7/498Yv24eH+4ufQ3Ozu/v7+y13sRqwAAADLSURBVHjaZc/XDsFgGIBhtDrshlitmk2IrbHFqL2pvXf/+78DPokj7+Fz9qpU/9UXJIlhmPaTaQ6QPaz0mm+5gwkgovcV6GZzd5JtCQwgsxoHOvJO15kleRLAnMgHFIESUEPmawB9ngmelTtipwwfASilxOLyiV5UVUyVAfbG0cCPHig+GBkzAENHS0AstVF6bacZIOzgLmxsHbt2OecNgJC83JERmePUYq8ARGkJx6XtFsdddBQgZE2nPR6CICZhawjA4Fb/chv+399kfR+MMMDGOQAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: 2px center;}.ace_gutter-cell.ace_warning {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAmVBMVEX///8AAAD///8AAAAAAABPSzb/5sAAAAB/blH/73z/ulkAAAAAAAD85pkAAAAAAAACAgP/vGz/rkDerGbGrV7/pkQICAf////e0IsAAAD/oED/qTvhrnUAAAD/yHD/njcAAADuv2r/nz//oTj/p064oGf/zHAAAAA9Nir/tFIAAAD/tlTiuWf/tkIAAACynXEAAAAAAAAtIRW7zBpBAAAAM3RSTlMAABR1m7RXO8Ln31Z36zT+neXe5OzooRDfn+TZ4p3h2hTf4t3k3ucyrN1K5+Xaks52Sfs9CXgrAAAAjklEQVR42o3PbQ+CIBQFYEwboPhSYgoYunIqqLn6/z8uYdH8Vmdnu9vz4WwXgN/xTPRD2+sgOcZjsge/whXZgUaYYvT8QnuJaUrjrHUQreGczuEafQCO/SJTufTbroWsPgsllVhq3wJEk2jUSzX3CUEDJC84707djRc5MTAQxoLgupWRwW6UB5fS++NV8AbOZgnsC7BpEAAAAABJRU5ErkJggg==");background-position: 2px center;}.ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAJ0Uk5TAAB2k804AAAAPklEQVQY02NgIB68QuO3tiLznjAwpKTgNyDbMegwisCHZUETUZV0ZqOquBpXj2rtnpSJT1AEnnRmL2OgGgAAIKkRQap2htgAAAAASUVORK5CYII=");background-position: 2px center;}.ace_dark .ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAJFBMVEUAAAChoaGAgIAqKiq+vr6tra1ZWVmUlJSbm5s8PDxubm56enrdgzg3AAAAAXRSTlMAQObYZgAAAClJREFUeNpjYMAPdsMYHegyJZFQBlsUlMFVCWUYKkAZMxZAGdxlDMQBAG+TBP4B6RyJAAAAAElFTkSuQmCC");}.ace_scrollbar {position: absolute;right: 0;bottom: 0;z-index: 6;}.ace_scrollbar-inner {position: absolute;cursor: text;left: 0;top: 0;}.ace_scrollbar-v{overflow-x: hidden;overflow-y: scroll;top: 0;}.ace_scrollbar-h {overflow-x: scroll;overflow-y: hidden;left: 0;}.ace_print-margin {position: absolute;height: 100%;}.ace_text-input {position: absolute;z-index: 0;width: 0.5em;height: 1em;opacity: 0;background: transparent;-moz-appearance: none;appearance: none;border: none;resize: none;outline: none;overflow: hidden;font: inherit;padding: 0 1px;margin: 0 -1px;text-indent: -1em;-ms-user-select: text;-moz-user-select: text;-webkit-user-select: text;user-select: text;white-space: pre!important;}.ace_text-input.ace_composition {background: inherit;color: inherit;z-index: 1000;opacity: 1;text-indent: 0;}.ace_layer {z-index: 1;position: absolute;overflow: hidden;word-wrap: normal;white-space: pre;height: 100%;width: 100%;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;pointer-events: none;}.ace_gutter-layer {position: relative;width: auto;text-align: right;pointer-events: auto;}.ace_text-layer {font: inherit !important;}.ace_cjk {display: inline-block;text-align: center;}.ace_cursor-layer {z-index: 4;}.ace_cursor {z-index: 4;position: absolute;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;border-left: 2px solid;transform: translatez(0);}.ace_slim-cursors .ace_cursor {border-left-width: 1px;}.ace_overwrite-cursors .ace_cursor {border-left-width: 0;border-bottom: 1px solid;}.ace_hidden-cursors .ace_cursor {opacity: 0.2;}.ace_smooth-blinking .ace_cursor {-webkit-transition: opacity 0.18s;transition: opacity 0.18s;}.ace_editor.ace_multiselect .ace_cursor {border-left-width: 1px;}.ace_marker-layer .ace_step, .ace_marker-layer .ace_stack {position: absolute;z-index: 3;}.ace_marker-layer .ace_selection {position: absolute;z-index: 5;}.ace_marker-layer .ace_bracket {position: absolute;z-index: 6;}.ace_marker-layer .ace_active-line {position: absolute;z-index: 2;}.ace_marker-layer .ace_selected-word {position: absolute;z-index: 4;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;}.ace_line .ace_fold {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;display: inline-block;height: 11px;margin-top: -2px;vertical-align: middle;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACJJREFUeNpi+P//fxgTAwPDBxDxD078RSX+YeEyDFMCIMAAI3INmXiwf2YAAAAASUVORK5CYII=");background-repeat: no-repeat, repeat-x;background-position: center center, top left;color: transparent;border: 1px solid black;border-radius: 2px;cursor: pointer;pointer-events: auto;}.ace_dark .ace_fold {}.ace_fold:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACBJREFUeNpi+P//fz4TAwPDZxDxD5X4i5fLMEwJgAADAEPVDbjNw87ZAAAAAElFTkSuQmCC");}.ace_tooltip {background-color: #FFF;background-image: -webkit-linear-gradient(top, transparent, rgba(0, 0, 0, 0.1));background-image: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.1));border: 1px solid gray;border-radius: 1px;box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);color: black;max-width: 100%;padding: 3px 4px;position: fixed;z-index: 999999;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;cursor: default;white-space: pre;word-wrap: break-word;line-height: normal;font-style: normal;font-weight: normal;letter-spacing: normal;pointer-events: none;}.ace_folding-enabled > .ace_gutter-cell {padding-right: 13px;}.ace_fold-widget {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;margin: 0 -12px 0 1px;display: none;width: 11px;vertical-align: top;background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42mWKsQ0AMAzC8ixLlrzQjzmBiEjp0A6WwBCSPgKAXoLkqSot7nN3yMwR7pZ32NzpKkVoDBUxKAAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: center;border-radius: 3px;border: 1px solid transparent;cursor: pointer;}.ace_folding-enabled .ace_fold-widget {display: inline-block;   }.ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42m3HwQkAMAhD0YzsRchFKI7sAikeWkrxwScEB0nh5e7KTPWimZki4tYfVbX+MNl4pyZXejUO1QAAAABJRU5ErkJggg==");}.ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAGCAYAAAAG5SQMAAAAOUlEQVR42jXKwQkAMAgDwKwqKD4EwQ26sSOkVWjgIIHAzPiCgaqiqnJHZnKICBERHN194O5b9vbLuAVRL+l0YWnZAAAAAElFTkSuQmCCXA==");}.ace_fold-widget:hover {border: 1px solid rgba(0, 0, 0, 0.3);background-color: rgba(255, 255, 255, 0.2);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);}.ace_fold-widget:active {border: 1px solid rgba(0, 0, 0, 0.4);background-color: rgba(0, 0, 0, 0.05);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);}.ace_dark .ace_fold-widget {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHklEQVQIW2P4//8/AzoGEQ7oGCaLLAhWiSwB146BAQCSTPYocqT0AAAAAElFTkSuQmCC");}.ace_dark .ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAH0lEQVQIW2P4//8/AxQ7wNjIAjDMgC4AxjCVKBirIAAF0kz2rlhxpAAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAFCAYAAACAcVaiAAAAHElEQVQIW2P4//+/AxAzgDADlOOAznHAKgPWAwARji8UIDTfQQAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget:hover {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);background-color: rgba(255, 255, 255, 0.1);}.ace_dark .ace_fold-widget:active {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);}.ace_fold-widget.ace_invalid {background-color: #FFB4B4;border-color: #DE5555;}.ace_fade-fold-widgets .ace_fold-widget {-webkit-transition: opacity 0.4s ease 0.05s;transition: opacity 0.4s ease 0.05s;opacity: 0;}.ace_fade-fold-widgets:hover .ace_fold-widget {-webkit-transition: opacity 0.05s ease 0.05s;transition: opacity 0.05s ease 0.05s;opacity:1;}.ace_underline {text-decoration: underline;}.ace_bold {font-weight: bold;}.ace_nobold .ace_bold {font-weight: normal;}.ace_italic {font-style: italic;}.ace_error-marker {background-color: rgba(255, 0, 0,0.2);position: absolute;z-index: 9;}.ace_highlight-marker {background-color: rgba(255, 255, 0,0.2);position: absolute;z-index: 8;}.ace_br1 {border-top-left-radius    : 3px;}.ace_br2 {border-top-right-radius   : 3px;}.ace_br3 {border-top-left-radius    : 3px; border-top-right-radius:    3px;}.ace_br4 {border-bottom-right-radius: 3px;}.ace_br5 {border-top-left-radius    : 3px; border-bottom-right-radius: 3px;}.ace_br6 {border-top-right-radius   : 3px; border-bottom-right-radius: 3px;}.ace_br7 {border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px;}.ace_br8 {border-bottom-left-radius : 3px;}.ace_br9 {border-top-left-radius    : 3px; border-bottom-left-radius:  3px;}.ace_br10{border-top-right-radius   : 3px; border-bottom-left-radius:  3px;}.ace_br11{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-left-radius:  3px;}.ace_br12{border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br13{border-top-left-radius    : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br14{border-top-right-radius   : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br15{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;}
/*# sourceURL=ace/css/ace_editor.css */</style><style id="ace-tm">.ace-tm .ace_gutter {background: #f0f0f0;color: #333;}.ace-tm .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-tm .ace_fold {background-color: #6B72E6;}.ace-tm {background-color: #FFFFFF;color: black;}.ace-tm .ace_cursor {color: black;}.ace-tm .ace_invisible {color: rgb(191, 191, 191);}.ace-tm .ace_storage,.ace-tm .ace_keyword {color: blue;}.ace-tm .ace_constant {color: rgb(197, 6, 11);}.ace-tm .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-tm .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-tm .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-tm .ace_invalid {background-color: rgba(255, 0, 0, 0.1);color: red;}.ace-tm .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-tm .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-tm .ace_support.ace_type,.ace-tm .ace_support.ace_class {color: rgb(109, 121, 222);}.ace-tm .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-tm .ace_string {color: rgb(3, 106, 7);}.ace-tm .ace_comment {color: rgb(76, 136, 107);}.ace-tm .ace_comment.ace_doc {color: rgb(0, 102, 255);}.ace-tm .ace_comment.ace_doc.ace_tag {color: rgb(128, 159, 191);}.ace-tm .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-tm .ace_variable {color: rgb(49, 132, 149);}.ace-tm .ace_xml-pe {color: rgb(104, 104, 91);}.ace-tm .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-tm .ace_heading {color: rgb(12, 7, 255);}.ace-tm .ace_list {color:rgb(185, 6, 144);}.ace-tm .ace_meta.ace_tag {color:rgb(0, 22, 142);}.ace-tm .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-tm .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-tm.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;}.ace-tm .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-tm .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-tm .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-tm .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-tm .ace_gutter-active-line {background-color : #dcdcdc;}.ace-tm .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-tm .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}
/*# sourceURL=ace/css/ace-tm */</style><style>    .error_widget_wrapper {        background: inherit;        color: inherit;        border:none    }    .error_widget {        border-top: solid 2px;        border-bottom: solid 2px;        margin: 5px 0;        padding: 10px 40px;        white-space: pre-wrap;    }    .error_widget.ace_error, .error_widget_arrow.ace_error{        border-color: #ff5a5a    }    .error_widget.ace_warning, .error_widget_arrow.ace_warning{        border-color: #F1D817    }    .error_widget.ace_info, .error_widget_arrow.ace_info{        border-color: #5a5a5a    }    .error_widget.ace_ok, .error_widget_arrow.ace_ok{        border-color: #5aaa5a    }    .error_widget_arrow {        position: absolute;        border: solid 5px;        border-top-color: transparent!important;        border-right-color: transparent!important;        border-left-color: transparent!important;        top: -5px;    }</style><style>.ace_snippet-marker {    -moz-box-sizing: border-box;    box-sizing: border-box;    background: rgba(194, 193, 208, 0.09);    border: 1px dotted rgba(211, 208, 235, 0.62);    position: absolute;}</style><style>.ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {    background-color: #CAD6FA;    z-index: 1;}.ace_editor.ace_autocomplete .ace_line-hover {    border: 1px solid #abbffe;    margin-top: -1px;    background: rgba(233,233,253,0.4);}.ace_editor.ace_autocomplete .ace_line-hover {    position: absolute;    z-index: 2;}.ace_editor.ace_autocomplete .ace_scroller {   background: none;   border: none;   box-shadow: none;}.ace_rightAlignedText {    color: gray;    display: inline-block;    position: absolute;    right: 4px;    text-align: right;    z-index: -1;}.ace_editor.ace_autocomplete .ace_completion-highlight{    color: #000;    text-shadow: 0 0 0.01em;}.ace_editor.ace_autocomplete {    width: 280px;    z-index: 200000;    background: #fbfbfb;    color: #444;    border: 1px lightgray solid;    position: fixed;    box-shadow: 2px 3px 5px rgba(0,0,0,.2);    line-height: 1.4;}</style><style id="ace-crimson-editor">.ace-crimson-editor .ace_gutter {background: #ebebeb;color: #333;overflow : hidden;}.ace-crimson-editor .ace_gutter-layer {width: 100%;text-align: right;}.ace-crimson-editor .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-crimson-editor {background-color: #FFFFFF;color: rgb(64, 64, 64);}.ace-crimson-editor .ace_cursor {color: black;}.ace-crimson-editor .ace_invisible {color: rgb(191, 191, 191);}.ace-crimson-editor .ace_identifier {color: black;}.ace-crimson-editor .ace_keyword {color: blue;}.ace-crimson-editor .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-crimson-editor .ace_constant.ace_language {color: rgb(255, 156, 0);}.ace-crimson-editor .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-crimson-editor .ace_invalid {text-decoration: line-through;color: rgb(224, 0, 0);}.ace-crimson-editor .ace_fold {}.ace-crimson-editor .ace_support.ace_function {color: rgb(192, 0, 0);}.ace-crimson-editor .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-crimson-editor .ace_support.ace_type,.ace-crimson-editor .ace_support.ace_class {color: rgb(109, 121, 222);}.ace-crimson-editor .ace_keyword.ace_operator {color: rgb(49, 132, 149);}.ace-crimson-editor .ace_string {color: rgb(128, 0, 128);}.ace-crimson-editor .ace_comment {color: rgb(76, 136, 107);}.ace-crimson-editor .ace_comment.ace_doc {color: rgb(0, 102, 255);}.ace-crimson-editor .ace_comment.ace_doc.ace_tag {color: rgb(128, 159, 191);}.ace-crimson-editor .ace_constant.ace_numeric {color: rgb(0, 0, 64);}.ace-crimson-editor .ace_variable {color: rgb(0, 64, 128);}.ace-crimson-editor .ace_xml-pe {color: rgb(104, 104, 91);}.ace-crimson-editor .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-crimson-editor .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-crimson-editor .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-crimson-editor .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-crimson-editor .ace_marker-layer .ace_active-line {background: rgb(232, 242, 254);}.ace-crimson-editor .ace_gutter-active-line {background-color : #dcdcdc;}.ace-crimson-editor .ace_meta.ace_tag {color:rgb(28, 2, 255);}.ace-crimson-editor .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-crimson-editor .ace_string.ace_regex {color: rgb(192, 0, 192);}.ace-crimson-editor .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}
/*# sourceURL=ace/css/ace-crimson-editor */</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head><body><div id="MathJax_Message" style="display: none;"></div><div><div id="__next"><div data-reactroot="" data-reactid="1" data-react-checksum="-1807555626"><div class="Page content" data-reactid="2"><!-- react-empty: 3 --><div class="Layout" data-jsx-ext="2621171990" data-reactid="4"><!-- react-empty: 5 --><!-- react-empty: 6 --><!-- react-empty: 7 --><div class="SidebarMenu" data-jsx-ext="22811602996" data-reactid="8"><div class="SidebarMenu__content" data-jsx-ext="22811602996" data-reactid="9"><div class="Logo" data-jsx-ext="23248140663" data-reactid="10"><a href="https://www.datacamp.com/" class="Logo__image" data-jsx-ext="23248140663" data-reactid="11"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1367.47 306.77" data-reactid="12"><path d="M201.49 130.16c2.64-10.87 2.31-21.09-3.62-35.38 0 0 9.55 3.71 8.56-3.65S194.91 76 187 71.11c-3.48-2.17-12.89-6.79-25.52-9.6l2.36-5.32-.66-.32c-19.59-9.54-42.24-.89-42.47-.8l-.7.27 2.24 5.92a78 78 0 0 0-19 7.09C50 96.68 77 152 93.5 165.17s8.89 40 0 64.31H165c1-4.55.13 2.24 3.46-15.91s16.18-11.41 26.3-12 8.52-7.66 8.4-15.56c4.94-2.22 4.94-4.57 1.64-7.41 4.28-4 3.62-4 1.32-7.83s-.66-5.68-.66-5.68 6.92-1.35 7.9-5c.32-7.89-14.5-19.09-11.87-29.93zm-14.78-2.28l-10.59-3.6c-.56 1.45-6 14.9-13 17.27l-6.68-8.84c-3.21 2.51-10.54 4.72-14.07 3.69v-.32h-.19l.2 24.36c-14.05 1.45-30.84-7.06-38.88-18.77l-8.78 6.67c-10-12.07-11.51-26.62-11.62-35h11.77c0-9.27 3.62-21.34 8.72-28l9.23 6.52c.75-.93 7.72-9.27 17.05-12.28h.14l-6.67-17.64c14.09-4.06 24.44-4 35.7.19a3.87 3.87 0 0 1 1 .48l.18.13-1.99 5.26c.53.23 8 3.59 11.09 6.74l2.49-3.44a42.47 42.47 0 0 1 19 25.34L187 98v-.1a55.32 55.32 0 0 1-.28 29.98z" data-reactid="13"></path><path d="M141.69 95.69a11.77 11.77 0 1 0 11.76 11.77 11.78 11.78 0 0 0-11.76-11.77zM486.07 147.93a85.48 85.48 0 0 1-5.79 31.92 71.67 71.67 0 0 1-41.54 41.32 89 89 0 0 1-32.79 5.83h-60.24V68.9h60.23a88.33 88.33 0 0 1 32.79 5.85A74 74 0 0 1 464 91a72.76 72.76 0 0 1 16.29 25 85.49 85.49 0 0 1 5.78 31.93zm-30.17 0a73.61 73.61 0 0 0-3.44-23.34 48.4 48.4 0 0 0-9.95-17.49 43.45 43.45 0 0 0-15.74-11 54 54 0 0 0-20.82-3.83h-30.72v111.3h30.72a54 54 0 0 0 20.82-3.83 43.39 43.39 0 0 0 15.74-11 48.37 48.37 0 0 0 9.95-17.49 73.6 73.6 0 0 0 3.44-23.32zM505.36 130.44q19.35-17.71 46.57-17.71a45.54 45.54 0 0 1 17.6 3.22 37.21 37.21 0 0 1 13.12 9 38.4 38.4 0 0 1 8.14 13.72 52.72 52.72 0 0 1 2.79 17.49V227h-12.25a12.38 12.38 0 0 1-5.9-1.15q-2.08-1.15-3.28-4.65l-2.4-8.09a97.29 97.29 0 0 1-8.31 6.72 48.91 48.91 0 0 1-8.42 4.86 45.32 45.32 0 0 1-9.35 3 53.93 53.93 0 0 1-11 1 43.08 43.08 0 0 1-13.12-1.91 28.78 28.78 0 0 1-10.38-5.74 25.73 25.73 0 0 1-6.78-9.51 33.72 33.72 0 0 1-2.4-13.23 26.32 26.32 0 0 1 1.42-8.47 24.76 24.76 0 0 1 4.65-8 38.63 38.63 0 0 1 8.36-7.21 54.43 54.43 0 0 1 12.63-5.9 109.08 109.08 0 0 1 17.44-4.1 174.35 174.35 0 0 1 22.74-1.91v-6.56q0-11.26-4.81-16.67t-13.88-5.41a33 33 0 0 0-10.88 1.53 44.91 44.91 0 0 0-7.6 3.44q-3.28 1.91-6 3.44a11.78 11.78 0 0 1-6 1.53 7.79 7.79 0 0 1-4.81-1.48 12.33 12.33 0 0 1-3.17-3.44zm61.87 48.64a149.08 149.08 0 0 0-19.68 2 52.42 52.42 0 0 0-12.79 3.77 16.8 16.8 0 0 0-6.89 5.36 11.63 11.63 0 0 0-2.08 6.67q0 7.11 4.21 10.17t11 3.06a32 32 0 0 0 14.37-3 42.69 42.69 0 0 0 11.86-9.11zM657.79 228.72q-14.65 0-22.46-8.25t-7.82-22.79V135H616a5.26 5.26 0 0 1-3.72-1.42 5.53 5.53 0 0 1-1.53-4.26v-10.68l18-3 5.68-30.61a6 6 0 0 1 2.08-3.39 6.18 6.18 0 0 1 3.94-1.2h14v35.36h30V135h-30v60.78q0 5.25 2.57 8.2a8.85 8.85 0 0 0 7 3 12.7 12.7 0 0 0 4.21-.6 23 23 0 0 0 3-1.26q1.26-.66 2.24-1.26a3.75 3.75 0 0 1 2-.6 3.1 3.1 0 0 1 2 .6 9.23 9.23 0 0 1 1.64 1.8l8.09 13.12a40.87 40.87 0 0 1-13.55 7.43 50.47 50.47 0 0 1-15.86 2.51zM702.11 130.44q19.35-17.71 46.57-17.71a45.54 45.54 0 0 1 17.6 3.22 37.19 37.19 0 0 1 13.12 9 38.37 38.37 0 0 1 8.14 13.72 52.72 52.72 0 0 1 2.79 17.49V227h-12.25a12.37 12.37 0 0 1-5.9-1.15q-2.08-1.15-3.28-4.65l-2.4-8.09a97.21 97.21 0 0 1-8.31 6.72 49 49 0 0 1-8.42 4.86 45.33 45.33 0 0 1-9.35 3 53.92 53.92 0 0 1-11 1 43.08 43.08 0 0 1-13.12-1.91 28.78 28.78 0 0 1-10.38-5.74 25.74 25.74 0 0 1-6.78-9.51 33.72 33.72 0 0 1-2.4-13.23 26.31 26.31 0 0 1 1.42-8.47 24.76 24.76 0 0 1 4.65-8 38.66 38.66 0 0 1 8.36-7.21 54.45 54.45 0 0 1 12.63-5.9 109.07 109.07 0 0 1 17.44-4.1 174.32 174.32 0 0 1 22.76-1.93v-6.56q0-11.26-4.81-16.67t-13.88-5.41a33 33 0 0 0-10.88 1.53 44.89 44.89 0 0 0-7.6 3.44q-3.28 1.91-6 3.44a11.79 11.79 0 0 1-6 1.53 7.79 7.79 0 0 1-4.81-1.48 12.33 12.33 0 0 1-3.17-3.44zM764 179.09a149.06 149.06 0 0 0-19.68 2 52.43 52.43 0 0 0-12.79 3.77 16.81 16.81 0 0 0-6.89 5.36 11.63 11.63 0 0 0-2.08 6.67q0 7.11 4.21 10.17t11 3.06a32 32 0 0 0 14.37-3A42.68 42.68 0 0 0 764 198zM929.42 189.69a5.87 5.87 0 0 1 4.26 1.86l11.59 12.57a63.64 63.64 0 0 1-23.67 18.26q-14 6.34-33.72 6.34-17.6 0-31.65-6a69.71 69.71 0 0 1-24-16.73A73.19 73.19 0 0 1 817 180.4a96 96 0 0 1-5.3-32.47 90.36 90.36 0 0 1 5.68-32.63 75 75 0 0 1 16-25.52A72.5 72.5 0 0 1 858 73.11a81.77 81.77 0 0 1 31.7-6q17.27 0 30.66 5.68a73.08 73.08 0 0 1 22.83 14.91l-9.84 13.66a9 9 0 0 1-2.24 2.29 6.35 6.35 0 0 1-3.77 1 7.2 7.2 0 0 1-3.39-.93q-1.75-.93-3.83-2.29t-4.81-3a39.67 39.67 0 0 0-6.34-3 51.92 51.92 0 0 0-8.36-2.29 57.87 57.87 0 0 0-11-.93A48.74 48.74 0 0 0 870.23 96a42.16 42.16 0 0 0-15.14 10.93 50.38 50.38 0 0 0-9.84 17.49 73.27 73.27 0 0 0-3.5 23.56 69.25 69.25 0 0 0 3.77 23.72 52.12 52.12 0 0 0 10.22 17.49 43.61 43.61 0 0 0 15.2 10.81 47 47 0 0 0 18.8 3.77 81.89 81.89 0 0 0 10.88-.66 46.17 46.17 0 0 0 9-2.08 39.7 39.7 0 0 0 7.76-3.66 48.48 48.48 0 0 0 7.27-5.52 10.31 10.31 0 0 1 2.29-1.58 5.56 5.56 0 0 1 2.48-.58zM961.6 130.44q19.35-17.71 46.57-17.71a45.54 45.54 0 0 1 17.6 3.22 37.19 37.19 0 0 1 13.12 9 38.37 38.37 0 0 1 8.14 13.72 52.72 52.72 0 0 1 2.79 17.49V227h-12.24a12.37 12.37 0 0 1-5.9-1.15q-2.08-1.15-3.28-4.65l-2.4-8.09a97.21 97.21 0 0 1-8.31 6.72 49 49 0 0 1-8.42 4.86 45.33 45.33 0 0 1-9.35 3 53.92 53.92 0 0 1-11 1 43.08 43.08 0 0 1-13.12-1.91 28.78 28.78 0 0 1-10.38-5.74 25.74 25.74 0 0 1-6.78-9.51 33.73 33.73 0 0 1-2.4-13.23 26.31 26.31 0 0 1 1.42-8.47 24.76 24.76 0 0 1 4.65-8 38.66 38.66 0 0 1 8.36-7.21 54.45 54.45 0 0 1 12.63-5.9 109.07 109.07 0 0 1 17.44-4.1 174.32 174.32 0 0 1 22.74-1.91v-6.56q0-11.26-4.81-16.67t-13.88-5.41a33 33 0 0 0-10.88 1.53 44.89 44.89 0 0 0-7.6 3.44q-3.28 1.91-6 3.44a11.79 11.79 0 0 1-6 1.53 7.79 7.79 0 0 1-4.81-1.48 12.33 12.33 0 0 1-3.17-3.44zm61.87 48.64a149.06 149.06 0 0 0-19.68 2 52.43 52.43 0 0 0-12.79 3.8 16.81 16.81 0 0 0-6.89 5.36 11.63 11.63 0 0 0-2.08 6.67q0 7.11 4.21 10.17t11 3.06a32 32 0 0 0 14.37-3 42.68 42.68 0 0 0 11.86-9.13zM1078.18 227V114.81h16.51a6.63 6.63 0 0 1 6.89 4.92l1.75 8.31a63.82 63.82 0 0 1 6.18-6 39.66 39.66 0 0 1 6.89-4.7 37.29 37.29 0 0 1 7.87-3.12 35.05 35.05 0 0 1 9.24-1.15q10.6 0 17.43 5.74a34.56 34.56 0 0 1 10.22 15.25 34.23 34.23 0 0 1 6.56-9.57 35.9 35.9 0 0 1 8.63-6.5 39.77 39.77 0 0 1 10-3.72 48.07 48.07 0 0 1 10.66-1.2 44.82 44.82 0 0 1 16.51 2.84 31.69 31.69 0 0 1 12.13 8.31 36.63 36.63 0 0 1 7.49 13.34 58.1 58.1 0 0 1 2.57 18V227h-27v-71.41q0-10.71-4.7-16.12t-13.77-5.41a20.57 20.57 0 0 0-7.71 1.42 18.37 18.37 0 0 0-6.23 4.1 18.73 18.73 0 0 0-4.21 6.72 26.13 26.13 0 0 0-1.53 9.29V227h-27.11v-71.41q0-11.26-4.54-16.4t-13.28-5.14a21.83 21.83 0 0 0-11 2.9 36.66 36.66 0 0 0-9.46 7.92V227zM1289.85 130.12a58.51 58.51 0 0 1 15.63-12.57q8.74-4.81 20.55-4.81a36.79 36.79 0 0 1 16.78 3.83 37.68 37.68 0 0 1 13.12 11.09 53.26 53.26 0 0 1 8.53 17.93 90.21 90.21 0 0 1 3 24.43 76.84 76.84 0 0 1-3.39 23.28 57 57 0 0 1-9.67 18.58 44.72 44.72 0 0 1-15.19 12.3 44.22 44.22 0 0 1-19.95 4.43 40.23 40.23 0 0 1-16.07-2.9 39.23 39.23 0 0 1-11.92-8v45.91h-27V114.81h16.51a6.63 6.63 0 0 1 6.89 4.92zm1.42 67.77a26.57 26.57 0 0 0 10 7.87 29.76 29.76 0 0 0 11.75 2.3 25.79 25.79 0 0 0 11-2.3 21.63 21.63 0 0 0 8.36-7 34.62 34.62 0 0 0 5.3-11.86 67.79 67.79 0 0 0 1.86-16.89 75 75 0 0 0-1.58-16.67 32.22 32.22 0 0 0-4.54-11.09 17.92 17.92 0 0 0-7.16-6.23 22.34 22.34 0 0 0-9.57-2 27.28 27.28 0 0 0-14.32 3.55 43.46 43.46 0 0 0-11.15 10z" data-reactid="14"></path><path d="M144.06 306.77a9.83 9.83 0 0 1-4.72-1.21L23.79 242a9.82 9.82 0 0 1-5-7.56L.06 57.52a9.77 9.77 0 0 1 6.5-10.29L139.37.55a9.88 9.88 0 0 1 6.43 0L281.5 47.2a9.86 9.86 0 0 1 6.5 10.47L266.47 234.6a9.85 9.85 0 0 1-4.91 7.35l-112.68 63.56a9.84 9.84 0 0 1-4.82 1.26zm-110-77l110 60.49 107.22-60.48L271.89 60.5 142.64 16 16.15 60.5z" data-reactid="15"></path></svg></a><!-- react-empty: 16 --></div><div class="Menu" data-jsx-ext="21131652802" data-reactid="17"><div class="icon mobileOnly" data-jsx-ext="21131652802" data-reactid="18"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 80 70" data-reactid="19"><path d="M6 1a6 6 0 1 0 0 12h68a6 6 0 0 0 0-12H6zm0 28a6 6 0 1 0 0 12h68a6 6 0 0 0 0-12H6zm0 28a6 6 0 1 0 0 12h68a6 6 0 0 0 0-12H6z" data-reactid="20"></path></svg></div><div class="content mobileOnlyHide" data-jsx-ext="21131652802" data-reactid="21"><div class="section" data-jsx-ext="21131652802" data-reactid="22"><h5 data-jsx-ext="21131652802" data-reactid="23">community</h5><nav data-jsx-ext="21131652802" data-reactid="24"><div data-reactid="25"><a class="item active" data-jsx-ext="21131652802" href="https://www.datacamp.com/community/tutorials" data-reactid="26"><div class="image" data-jsx-ext="21131652802" data-reactid="27"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 24.22" height="14" data-reactid="28"><path d="M16.23 24.22a2 2 0 0 1-.73-.14L7 20.79a2 2 0 0 1-1.29-1.88v-4a1.5 1.5 0 0 1 3 0v3.36l7.54 2.92 7.54-2.92v-3.45a1.5 1.5 0 0 1 3 0v4.09a2 2 0 0 1-1.29 1.88L17 24.08a2 2 0 0 1-.77.14zm-.35-2.94zm.7 0z" data-reactid="29"></path><path d="M16.23 13.35a2 2 0 0 1-.62-.1C9.17 11.16 2.36 9 1.61 8.76a2 2 0 0 1-.25-3.87l14-4.78a2 2 0 0 1 1.3 0l14 4.78a2 2 0 0 1 0 3.81l-13.8 4.55a2 2 0 0 1-.63.1zm-.31-3zM5.21 6.74c3.49 1.11 9.07 2.92 11 3.56l10.68-3.53L16 3.05z" data-reactid="30"></path></svg></div><div class="text" data-jsx-ext="21131652802" data-reactid="31">Tutorials</div></a></div><div data-reactid="32"><a class="item" data-jsx-ext="21131652802" href="https://www.datacamp.com/community/data-science-cheatsheets" data-reactid="33"><div class="image" data-jsx-ext="21131652802" data-reactid="34"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 26" height="14" data-reactid="35"><path d="M18.5 26h-13A5.51 5.51 0 0 1 0 20.5v-15A5.51 5.51 0 0 1 5.5 0h13A5.51 5.51 0 0 1 24 5.5v15a5.51 5.51 0 0 1-5.5 5.5zM5.5 3A2.5 2.5 0 0 0 3 5.5v15A2.5 2.5 0 0 0 5.5 23h13a2.5 2.5 0 0 0 2.5-2.5v-15A2.5 2.5 0 0 0 18.5 3z" data-reactid="36"></path><path d="M16 11H8a1.5 1.5 0 0 1 0-3h8a1.5 1.5 0 0 1 0 3zM16 18H8a1.5 1.5 0 0 1 0-3h8a1.5 1.5 0 0 1 0 3z" data-reactid="37"></path></svg></div><div class="text" data-jsx-ext="21131652802" data-reactid="38">Cheat Sheets</div></a></div><div data-reactid="39"><a class="item" data-jsx-ext="21131652802" href="https://www.datacamp.com/community/open-courses" data-reactid="40"><div class="image" data-jsx-ext="21131652802" data-reactid="41"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 34 26" height="14" data-reactid="42"><path d="M28.5 26h-23A5.51 5.51 0 0 1 0 20.5v-15A5.51 5.51 0 0 1 5.5 0h23A5.51 5.51 0 0 1 34 5.5v15a5.51 5.51 0 0 1-5.5 5.5zM5.5 3A2.5 2.5 0 0 0 3 5.5v15A2.5 2.5 0 0 0 5.5 23h23a2.5 2.5 0 0 0 2.5-2.5v-15A2.5 2.5 0 0 0 28.5 3z" data-reactid="43"></path><path d="M13.5 26a1.5 1.5 0 0 1-1.5-1.5v-22a1.5 1.5 0 0 1 3 0v22a1.5 1.5 0 0 1-1.5 1.5zM27 11h-8a1.5 1.5 0 0 1 0-3h8a1.5 1.5 0 0 1 0 3zM27 18h-8a1.5 1.5 0 0 1 0-3h8a1.5 1.5 0 0 1 0 3z" data-reactid="44"></path></svg></div><div class="text" data-jsx-ext="21131652802" data-reactid="45">Open Courses</div></a></div><div data-reactid="46"><a class="item" data-jsx-ext="21131652802" href="https://www.datacamp.com/community/podcast" data-reactid="47"><div class="image" data-jsx-ext="21131652802" data-reactid="48"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="14" viewBox="0 0 18 18" data-reactid="49"><path d="M9.415 11.077h-.369a2.777 2.777 0 0 1-2.769-2.77V2.77A2.777 2.777 0 0 1 9.047 0h.368a2.777 2.777 0 0 1 2.77 2.77v5.538a2.777 2.777 0 0 1-2.77 2.769zm5.008-7.615c.573 0 1.039.464 1.039 1.038v3.462c0 3.08-2.25 5.64-5.193 6.136v1.825h2.077a1.038 1.038 0 1 1 0 2.077h-6.23a1.038 1.038 0 1 1 0-2.077h2.076v-1.825C5.25 13.602 3 11.042 3 7.962V4.5a1.038 1.038 0 1 1 2.077 0v3.462a4.158 4.158 0 0 0 4.154 4.153 4.158 4.158 0 0 0 4.154-4.153V4.5c0-.574.465-1.038 1.038-1.038z" data-reactid="50"></path></svg></div><div class="text" data-jsx-ext="21131652802" data-reactid="51">Podcast - DataFramed</div></a></div></nav></div><div class="section" data-jsx-ext="21131652802" data-reactid="52"><h5 data-jsx-ext="21131652802" data-reactid="53">datacamp</h5><nav data-jsx-ext="21131652802" data-reactid="54"><div data-reactid="55"><a class="item" data-jsx-ext="21131652802" href="https://www.datacamp.com/community/blog" data-reactid="56"><div class="image" data-jsx-ext="21131652802" data-reactid="57"><svg id="Réteg_1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17 18" height="14" data-reactid="58"><path id="path-1_1_" d="M12.3 9.8s-.1.1 0 .4c.1.2.2.2-.1.5.2.2.2.3-.1.5 0 .5.1.9-.5 1-.6 0-1.4-.4-1.7.8-.2 1.1-.2.7-.2 1H5.3c.6-1.5 1-3.2 0-4-1.1-1-2.7-4.4.6-6.2.4-.2.8-.3 1.2-.4L6.9 3s1.4-.5 2.7.1v.2c.8.2 1.4.5 1.6.6.5.3 1.2.8 1.2 1.3.1.5-.5.2-.5.2.4.9.4 1.5.2 2.2-.2.7.8 1.4.7 1.9-.1.3-.5.3-.5.3m4.2-7L8.6 0h-.4L.4 2.8c-.3.1-.4.3-.4.6l1.1 10.4c0 .2.1.4.3.4l6.8 3.7c.2.1.4.1.6 0l6.6-3.7c.2-.1.3-.3.3-.4L17 3.4c-.1-.3-.2-.5-.5-.6M8.3 7c-.4 0-.7-.4-.7-.8s.3-.7.7-.7c.4 0 .7.3.7.7 0 .4-.3.8-.7.8zm2.9-1.4l.2-.1c-.3-1-1.2-1.5-1.2-1.5l-.2.2c-.1-.2-.6-.4-.7-.5l.1-.3h-.1c-.6-.3-1.3-.3-2.1 0l.4 1.1c-.6.2-1.1.7-1.1.7l-.6-.4c-.3.5-.5 1.2-.5 1.8h-.8c0 .5.1 1.4.7 2.2l.6-.4c.5.7 1.6 1.3 2.4 1.2V8.1c.3 0 .7-.1.9-.3l.4.6c.4-.1.8-1 .8-1.1l.7.2c.2-.6.2-1.3.1-1.9z" data-reactid="59"></path></svg></div><div class="text" data-jsx-ext="21131652802" data-reactid="60">Official Blog</div></a></div><div data-reactid="61"><a class="item" data-jsx-ext="21131652802" href="https://www.datacamp.com/community/tech" data-reactid="62"><div class="image" data-jsx-ext="21131652802" data-reactid="63"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 21.75 29.76" height="14" data-reactid="64"><path d="M15.56 22.57a1.5 1.5 0 0 1-1.5-1.5 7.66 7.66 0 0 1 2.47-5.29 7.38 7.38 0 0 0 2.21-5.31A7.48 7.48 0 0 0 11.28 3h-.82a7.47 7.47 0 0 0-5.2 12.83 7.63 7.63 0 0 1 2.42 5.23 1.5 1.5 0 0 1-3 0 4.65 4.65 0 0 0-1.45-3A10.47 10.47 0 0 1 10.47 0h.82a10.47 10.47 0 0 1 7.28 18 4.68 4.68 0 0 0-1.5 3.08 1.5 1.5 0 0 1-1.51 1.49zM16.5 24.26a5.5 5.5 0 0 1-11 0" data-reactid="65"></path><path d="M10.89 22.56a1.5 1.5 0 0 1-1.5-1.5v-8.84a1.5 1.5 0 0 1 3 0v8.84a1.5 1.5 0 0 1-1.5 1.5z" data-reactid="66"></path></svg></div><div class="text" data-jsx-ext="21131652802" data-reactid="67">Tech Thoughts</div></a></div></nav></div></div><!-- react-empty: 68 --></div></div><!-- react-empty: 69 --></div><main class="Main" data-jsx-ext="2621171990" data-reactid="70"><div class="ActionBar" data-jsx-ext="22958900640" data-reactid="71"><div data-reactid="72"><div class="ActionBarSearch" data-jsx-ext="2894520075" data-reactid="73"><button class="Button extra noPadding" style="font-weight:normal;" data-jsx-ext="23026453492" data-reactid="74"><div class="icon" data-jsx-ext="23026453492" data-reactid="75"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20.03 23" data-reactid="76"><path d="M10.39 19.29A9.65 9.65 0 1 1 20 9.65a9.66 9.66 0 0 1-9.61 9.64zm0-17.06a7.42 7.42 0 1 0 7.42 7.42 7.43 7.43 0 0 0-7.42-7.42z" data-reactid="77"></path><path d="M1.11 23a1.11 1.11 0 0 1-.89-1.78l4.1-5.47a1.11 1.11 0 1 1 1.78 1.34L2 22.56a1.11 1.11 0 0 1-.89.44z" data-reactid="78"></path></svg></div><div class="desktopOnly" data-jsx-ext="23026453492" data-reactid="79">Search</div><!-- react-empty: 80 --></button><!-- react-empty: 81 --></div><!-- react-empty: 82 --></div><div class="ActionBarAuth" data-jsx-ext="2433585153" data-reactid="83"><div data-jsx-ext="2433585153" data-reactid="84"><button class="Button border minWidth" data-jsx-ext="23026453492" data-reactid="85"><div class="" data-jsx-ext="23026453492" data-reactid="86">Log in</div><!-- react-empty: 87 --></button><button class="Button primary" data-jsx-ext="23026453492" data-reactid="88"><div class="" data-jsx-ext="23026453492" data-reactid="89">Create Account</div><!-- react-empty: 90 --></button></div><!-- react-empty: 91 --></div><!-- react-empty: 92 --></div><div class="TitleBar" data-jsx-ext="2126402434" data-reactid="93"><div class="filter" data-jsx-ext="2126402434" data-reactid="94"><button class="Button iconButton noPadding" data-jsx-ext="23026453492" data-reactid="95"><div class="icon" data-jsx-ext="23026453492" data-reactid="96"><svg id="Réteg_1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 7 12" data-reactid="97"><path id="path-1_1_" d="M5.9 0c.4 0 .9.3 1 .7s.1.9-.2 1.2L2.7 6l4 4.1c.3.5.3 1.1-.1 1.6s-1.1.4-1.5.1l-4.8-5c-.4-.4-.4-1.2 0-1.6L5.1.3c.2-.2.5-.3.8-.3z" data-reactid="98"></path></svg></div><div class="desktopOnly" data-jsx-ext="23026453492" data-reactid="99">Back to Tutorials</div><!-- react-empty: 100 --></button></div><div class="title" data-jsx-ext="2126402434" data-reactid="101"><div class="Title" data-jsx-ext="21449127091" data-reactid="102"><div class="icon" data-jsx-ext="21449127091" data-reactid="103"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 24.22" data-reactid="104"><path d="M16.23 24.22a2 2 0 0 1-.73-.14L7 20.79a2 2 0 0 1-1.29-1.88v-4a1.5 1.5 0 0 1 3 0v3.36l7.54 2.92 7.54-2.92v-3.45a1.5 1.5 0 0 1 3 0v4.09a2 2 0 0 1-1.29 1.88L17 24.08a2 2 0 0 1-.77.14zm-.35-2.94zm.7 0z" data-reactid="105"></path><path d="M16.23 13.35a2 2 0 0 1-.62-.1C9.17 11.16 2.36 9 1.61 8.76a2 2 0 0 1-.25-3.87l14-4.78a2 2 0 0 1 1.3 0l14 4.78a2 2 0 0 1 0 3.81l-13.8 4.55a2 2 0 0 1-.63.1zm-.31-3zM5.21 6.74c3.49 1.11 9.07 2.92 11 3.56l10.68-3.53L16 3.05z" data-reactid="106"></path></svg></div><div class="h1" data-jsx-ext="21449127091" data-reactid="107">Tutorials</div><!-- react-empty: 108 --></div></div><div class="action" data-jsx-ext="2126402434" data-reactid="109"><button class="Button iconButton noPadding" data-jsx-ext="23026453492" data-reactid="110"><div class="icon" data-jsx-ext="23026453492" data-reactid="111"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20.06 20.39" data-reactid="112"><path d="M.53 13.94l-.04.04L0 20.39l6.08-.83.04-.03-5.59-5.59zM8.37 17.27L18.9 6.74a4 4 0 0 0 0-5.59 4 4 0 0 0-5.59 0L2.78 11.69z" data-reactid="113"></path></svg></div><div class="desktopOnly" data-jsx-ext="23026453492" data-reactid="114">Write a Tutorial. Earn $250</div><!-- react-empty: 115 --></button></div><!-- react-empty: 116 --></div><div class="Tutorial withRecommend" data-jsx-ext="2343812706" data-reactid="117"><div data-reactid="118"><div data-reactid="119"><div data-reactid="120" style="padding-bottom: 0px;"></div><div class="social__top desktopOnly" data-reactid="121" style="position: fixed; top: 0px; left: 321px; width: 585px; transform: translateZ(0px);"><div class="voteAndSocial" data-reactid="122"><div class="Upvote" data-jsx-ext="22323102667" data-reactid="123"><div data-jsx-ext="22323102667" data-reactid="124"><div class="normal" data-jsx-ext="22323102667" data-reactid="125"><span class="icon" data-jsx-ext="22323102667" data-reactid="126">▲</span><span class="count" data-jsx-ext="22323102667" data-reactid="127">16</span></div><div class="voted" data-jsx-ext="22323102667" data-reactid="128"><span class="icon" data-jsx-ext="22323102667" data-reactid="129">▲</span><span class="count" data-jsx-ext="22323102667" data-reactid="130">16</span></div></div><!-- react-empty: 131 --></div><div class="Social vertical" data-jsx-ext="21337150270" data-reactid="132"><div class="icons" data-jsx-ext="21337150270" data-reactid="133"><a href="https://www.facebook.com/sharer.php?u=http://www.datacamp.com/community/tutorials/keras-r-deep-learning" class="icon" target="_blank" rel="noopener noreferrer" data-jsx-ext="21337150270" data-reactid="134"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 11.73 22.58" height="12" data-reactid="135"><path d="M7.61 22.58v-10.3h3.46l.52-4h-4V5.7c0-1.16.32-2 2-2h2.13V.16A28.47 28.47 0 0 0 8.63 0C5.56 0 3.47 1.87 3.47 5.31v3H0v4h3.47v10.3h4.14z" data-reactid="136"></path></svg></a><a href="https://twitter.com/intent/tweet?url=http://www.datacamp.com/community/tutorials/keras-r-deep-learning" class="icon centerIcon" target="_blank" rel="noopener noreferrer" data-jsx-ext="21337150270" data-reactid="137"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20.42 16.67" height="10" data-reactid="138"><path d="M10 5.18c0-.28-.06-.53-.07-.78a4 4 0 0 1 .73-2.57A4.08 4.08 0 0 1 13.93 0 4 4 0 0 1 17 1.15a.43.43 0 0 0 .46.12 8.68 8.68 0 0 0 2.2-.84l.2-.1a4.36 4.36 0 0 1-1.75 2.28A9 9 0 0 0 20.42 2l-.21.3a3.83 3.83 0 0 1-.23.3A8.45 8.45 0 0 1 18.5 4a.28.28 0 0 0-.13.27A12 12 0 0 1 17 10.18a11.8 11.8 0 0 1-3.37 4.11 11.17 11.17 0 0 1-4.39 2.06 12.53 12.53 0 0 1-4.44.22 11.87 11.87 0 0 1-4.74-1.73L0 14.79a8.6 8.6 0 0 0 6.16-1.74 4.28 4.28 0 0 1-3.91-2.91h.95a6.18 6.18 0 0 0 .89-.12A4.2 4.2 0 0 1 .8 5.88a4 4 0 0 0 1.81.49 4.23 4.23 0 0 1-1.78-3A4.07 4.07 0 0 1 1.38.79 12.06 12.06 0 0 0 10 5.18z" id="iOjKBC.tif" data-reactid="139"></path></svg></a><a href="https://www.linkedin.com/cws/share?url=http://www.datacamp.com/community/tutorials/keras-r-deep-learning" class="icon" target="_blank" rel="noopener noreferrer" data-jsx-ext="21337150270" data-reactid="140"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16.99 17" height="10" data-reactid="141"><path d="M3.85 17H.34V5.67h3.51zM2.07 4.18a2.09 2.09 0 1 1 2.08-2.09 2.08 2.08 0 0 1-2.08 2.09zM17 17h-3.5v-5.95c0-1.63-.62-2.54-1.91-2.54s-2.14.95-2.14 2.54V17H6.09V5.67h3.36v1.52a4 4 0 0 1 3.42-1.87c2.4 0 4.12 1.47 4.12 4.5V17z" data-reactid="142"></path></svg></a></div><!-- react-empty: 143 --></div></div></div></div><div class="preface" data-jsx-ext="2343812706" data-reactid="144"><div class="author" data-jsx-ext="2343812706" data-reactid="145"><div class="Author" data-jsx-ext="21725091107" data-reactid="146"><a href="https://www.datacamp.com/profile/karlijn" target="_blank" data-jsx-ext="21725091107" data-reactid="147"><div class="Avatar" style="background-image:url(https://res.cloudinary.com/dyd911kmh/image/fetch/t_avatar_thumbnail/https://assets.datacamp.com/users/avatars/000/494/311/square/Screenshot_2017-04-26_16.02.58.png?1493215479);border-radius:20px;min-width:40px;min-height:40px;" data-jsx-ext="22128240407" data-reactid="148"><!-- react-empty: 149 --></div><div class="info" data-jsx-ext="21725091107" data-reactid="150"><div class="name" data-jsx-ext="21725091107" data-reactid="151">Karlijn Willems</div><div class="date" data-jsx-ext="21725091107" data-reactid="152"><span data-reactid="153">June 28th, 2017</span></div></div></a><!-- react-empty: 154 --></div></div><div class="tags" data-jsx-ext="2343812706" data-reactid="155"><div class="TagLine" data-jsx="1974660517" data-reactid="156"><div class="Tag mustRead" data-jsx-ext="22003367819" data-reactid="157"><span class="title" data-jsx-ext="22003367819" data-reactid="158">must read</span><!-- react-empty: 159 --></div><div class="Tag" data-jsx-ext="22003367819" data-reactid="160"><span class="title" data-jsx-ext="22003367819" data-reactid="161">r programming</span><!-- react-empty: 162 --></div><a class="more" data-jsx="3587769272" data-reactid="163"><!-- react-text: 164 -->+<!-- /react-text --><!-- react-text: 165 -->1<!-- /react-text --><!-- react-empty: 166 --><!-- react-empty: 167 --></a><!-- react-empty: 168 --></div></div><h1 data-jsx-ext="2343812706" data-reactid="169">keras: Deep Learning in R</h1><div class="description" data-jsx-ext="2343812706" data-reactid="170">In this tutorial to deep learning in R with RStudio's keras package, you'll learn how to build a Multi-Layer Perceptron (MLP).</div></div><div class="markdown" data-reactid="171"><div data-reactid="172">
<p>As you know by now, machine learning is a subfield in Computer Science (CS). Deep learning, then, is a subfield of machine learning that is a set of algorithms that is inspired by the structure and function of the brain and which is usually called Artificial Neural Networks (ANN). Deep learning is one of the hottest trends in machine learning at the moment, and there are many problems where deep learning shines, such as robotics, image recognition and Artificial Intelligence (AI).</p>

<p>Today’s tutorial will give you a short introduction to deep learning in R with Keras with the <code>keras</code> package:</p>

<nav>
<ul>
	<li>You’ll start with a short overview of the <a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning#overview">deep learning packages in R</a>, and</li>
	<li>You’ll read more about the <a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning#differences">differences between the Keras, <code>kerasR</code> and <code>keras</code></a> packages and what it means when a package is an interface to another package;</li>
	<li>Then, you’ll really get started with RStudio’s <code>keras</code> package: you’ll learn how to first <a href="https://www.datacamp.com/community/tutorials/prep">prepare your workspace</a> and <a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning#data">load in</a> built-in datasets, dummy data, and data from CSVs;</li>
	<li>Next, you’ll see how you can <a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning#explore">explore</a> and <a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning#prep">preprocess the data</a> that you loaded in from a CSV file: you’ll normalize and split the data into training and test sets.</li>
	<li>After this, you’re ready to <a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning#model">construct your deep learning model</a>; In this case, you’ll build a Multi-Layer Perceptron (MLP) for multi-class classification.</li>
	<li>You’ll learn how you can <a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning#compile">compile and fit</a> the model to your data, how you can <a href="https://www.datacamp.com/community/tutorials/viz">visualize the training history</a>, and</li>
	<li>you’ll <a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning#predict">predict target values</a> based on test data;</li>
	<li>Lastly, you’ll <a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning#evaluate">evaluate your model</a>, interpret the results and <a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning#finetune">finetune your model</a> so that it performs better: you’ll learn how to add layers and hidden layers and you’ll see how you can adjust the optimization parameters to accomplish better results.</li>
	<li>Additionally, you might want to <a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning#save">save your (optimized) model or load it back in</a> another time. You'll see how this is done in the last section of this tutorial!</li>
</ul>
</nav>

<div id="scoped-content">
<style type="text/css">:target:before { content:""; display:block; height:150px; margin:-150px 0 0; } h3 {font-weight:normal; margin-top:.5em} h4 { font-weight:lighter }
</style>
<p>&nbsp;</p>

<p>Do you want to know more about the original Keras or key concepts in deep learning such as perceptrons and Multi-Layer Perceptrons (MLPs)? Consider or taking DataCamp’s <a href="https://www.datacamp.com/courses/deep-learning-in-python">Deep Learning in Python</a> course or doing the <a href="https://www.datacamp.com/community/tutorials/deep-learning-python">Keras Tutorial: Deep Learning in Python</a>.</p>

<p><strong>Tip</strong>: find our Keras cheat sheet <a href="https://www.datacamp.com/community/blog/keras-cheat-sheet">here</a>.</p>

<h2 id="overview">Deep Learning in R: Short Overview of Packages</h2>

<p>With the rise in popularity of deep learning, CRAN has been enriched with more R deep learning packages; Below you can see an overview of these packages, taken from the <a href="https://cran.r-project.org/view=MachineLearning">Machine Learning and Statistical Learning CRAN task view</a>. The “Percentile” column indicates the percentile as found on <a href="https://www.datacamp.com/community/tutorials/www.rdocumentation.org">RDocumentation</a>:</p>

<table>
	<colgroup>
		<col width="9%">
		<col width="10%">
		<col width="80%">
	</colgroup>
	<thead>
		<tr class="header">
			<th>R Package</th>
			<th>Percentile</th>
			<th>Description</th>
		</tr>
	</thead>
	<tbody>
		<tr class="odd">
			<td><code>nnet</code></td>
			<td>96th</td>
			<td>Software for feed-forward neural networks with a single hidden layer, and for multinomial log-linear models.</td>
		</tr>
		<tr class="even">
			<td><code>neuralnet</code></td>
			<td>96th</td>
			<td>Training of neural networks using backpropagation</td>
		</tr>
		<tr class="odd">
			<td><code>h2o</code></td>
			<td>95th</td>
			<td>R scripting functionality for H2O</td>
		</tr>
		<tr class="even">
			<td><code>RSNNS</code></td>
			<td>88th</td>
			<td>Interface to the Stuttgart Neural Network Simulator (SNNS)</td>
		</tr>
		<tr class="odd">
			<td><code>tensorflow</code></td>
			<td>88th</td>
			<td>Interface to TensorFlow</td>
		</tr>
		<tr class="even">
			<td><code>deepnet</code></td>
			<td>84th</td>
			<td>Deep learning toolkit in R</td>
		</tr>
		<tr class="odd">
			<td><code>darch</code></td>
			<td>79th</td>
			<td>Package for Deep Architectures and Restricted Boltzmann Machines</td>
		</tr>
		<tr class="even">
			<td><code>rnn</code></td>
			<td>73rd</td>
			<td>Package to implement Recurrent Neural Networks (RRNs)</td>
		</tr>
		<tr class="odd">
			<td><code>FCNN4R</code></td>
			<td>52nd</td>
			<td>Interface to the FCNN library that allows user-extensible ANNs</td>
		</tr>
		<tr class="even">
			<td><code>rcppDL</code></td>
			<td>7th</td>
			<td>Implementation of basic machine learning methods with many layers (deep learning), including dA (Denoising Autoencoder), SdA (Stacked Denoising Autoencoder), RBM (Restricted Boltzmann machine) and DBN (Deep Belief Nets)</td>
		</tr>
		<tr class="odd">
			<td><code>deepr</code></td>
			<td>??*</td>
			<td>Package to streamline the training, fine-tuning and predicting processes for deep learning based on <code>darch</code> and <code>deepnet</code></td>
		</tr>
		<tr class="even">
			<td><code>MXNetR</code></td>
			<td>??*</td>
			<td>Package that brings flexible and efficient GPU computing and state-of-art deep learning to R</td>
		</tr>
	</tbody>
</table>

<p><strong>Tip</strong>: for a comparison of deep learning packages in R, read <a href="http://www.rblog.uni-freiburg.de/2017/02/07/deep-learning-in-r/">this blog post</a>. For more information on ranking and score in RDocumentation, check out <a href="https://www.datacamp.com/community/blog/rdocumentation-ranking-scoring">this blog post</a>.</p>

<p><small>The <code>deepr</code> and <code>MXNetR</code> were not found on RDocumentation.org, so the percentile is unknown for these two packages.</small></p>

<h2 id="differences">Keras, <code>keras</code> and <code>kerasR</code></h2>

<p>Recently, two new packages found their way to the R community: the <a href="https://github.com/statsmaths/kerasR"><code>kerasR</code> package</a>, which was authored and created by Taylor Arnold, and <a href="https://github.com/rstudio/keras">RStudio’s <code>keras</code> package</a>.</p>

<p>Both packages provide an R interface to the Python deep learning package Keras, of which you might have already heard or maybe you have even worked with it! For those of you who don’t know what the Keras package has to offer to Python users, it’s “a high-level neural networks API, written in Python and capable of running on top of either TensorFlow, Microsoft Cognitive Toolkit (CNTK) or Theano”.</p>

<div class="section level3" id="interfaces">
<h3>Interfaces?</h3>

<p>You see, getting started with Keras is one of the easiest ways to get familiar with deep learning in Python and that also explains why the <code>kerasR</code> and <code>keras</code> packages provide an interface for this fantastic package for R users.</p>

<p>In this case, it’s good for you to understand what it exactly means when a package, such as the R <code>keras</code>, is “an interface” to another package, the Python Keras. In simple terms, this means that the <code>keras</code> R package with the interface allows you to enjoy the benefit of R programming while having access to the capabilities of the Python Keras package.</p>

<p><strong>Note</strong> that this is not an uncommon practice: for example, also the <code>h2o</code> package provides an interface, but in this case -and as the name kind of already suggests- to H2O, an open source math engine for big data that you can use to compute parallel distributed machine learning algorithms. Other packages that you might know that provide interfaces are <code>RWeka</code> (R interface to Weka), <code>tensorflow</code> (R interface to TensorFlow), <code>openml-r</code> (R interface to OpenML), … You can keep on going on and on!</p>
</div>

<div class="section level3" id="whats-the-difference-between-keras-keras-and-kerasr">
<h3>What’s the difference between Keras, <code>keras</code> and <code>kerasR</code>?</h3>

<p>Now that you know all of this, you might ask yourself the following question first: how would you compare the original Python package with the R packages?</p>

<p>In essence, you won’t find too many differences between the R packages and the original Python package, mostly because the function names are almost all the same; The only differences that you notice are mostly in the programming languages themselves (variable assignment, library loading, …), but the most important thing to notice lies in the fact of how much of the original functionality has been incorporated in the R package.</p>

<p><strong>Note</strong> that this remark isn’t only valid for the <code>keras</code> library, but also for the <code>tensorflow</code>, <code>openml-r</code>, … and other interface packages that were mentioned above!</p>

<p>Secondly, you might also wonder what then the difference is between these two R packages. Well, if you want to consider how the two differ, you might want to consider the following points:</p>

<ul>
	<li>
	<p>The <code>keras</code> package uses the pipe operator (<code>%&gt;%</code>) to connect functions or operations together, while you won’t find this in <code>kerasR</code>: for example, to make your model with <code>kerasR</code>, you’ll find that you need to make use of the <code>$</code> operator. The usage of the pipe operator generally improves the readability of your code and you’ll have definitely seen this operator already if you’ve worked with <a href="http://tidyverse.org/">Tidyverse packages</a> before.</p>
	</li>
	<li>
	<p>You’ll see that <code>kerasR</code> contains functions that are named in a similar, but not in completely the same way as the original Keras package. For example, the original (Python) <code>compile()</code> function is called <code>keras_compile()</code>; The same holds for other functions, such as for example <code>fit()</code>, which becomes <code>keras_fit()</code>, or <code>predict()</code>, which is <code>keras_predict</code> when you make use of the <code>kerasR</code> package. These are all custom wrappers.</p>
	</li>
	<li>
	<p>You can argue that the installation of RStudio’s <code>keras</code> package is easier than the installation of the <code>kerasR</code> package; To get the latter installed, you need to first make sure that you configure which Python version to use and this can get tricky if you’re working on a pc that has multiple environments or Python versions installed. But I’ll leave you to decide on this :)</p>
	</li>
</ul>

<p><a href="https://www.datacamp.com/courses/" target="_blank"><img alt="Learn Python for Data Science With DataCamp" src="./keras_ Deep Learning in R (article) - DataCamp_files/content_blog_banner.png"></a></p>

<p>&nbsp;</p>
</div>

<p>Now that you have gathered some background, it’s time to get started with Keras in R for real. As you will have read in the introduction of this tutorial, you’ll first go over the setup of you workspace. Then, you’ll load in some data and after a short data exploration and preprocessing step, you will be able to start constructing your MLP!</p>

<p>Let’s get on with it!</p>

<h2>Installing The <code>keras</code> Package</h2>

<p>As always, the first step to getting started with any package is to set up your workspace: install and load in the library into RStudio or whichever environment you’re working in.</p>

<p>No worries, for this tutorial, the package will be loaded in for you!</p>

<p>First, make sure that you install the <code>keras</code>: you can easily do this by running <code>devtools::install_github("rstudio/keras")</code> in your console. Next, you can load in the package and install TensorFlow:</p>

<pre><code># Load in the keras package
library(keras)

# Install TensorFlow
install_tensorflow()</code></pre>

<p>When you have done this, you’re good to go! That’s fast, right?</p>

<p><strong>Tip</strong>: for more information on the installation process, check out the <a href="https://rstudio.github.io/keras/">package website</a>.</p>
</div>

<h2 id="data">Loading The Data</h2>

<p>Now that the installation process is clear and your workspace is ready, you can start loading in your data! At this point, you have three big options when it comes to your data: you can pick to use one of the built-in datasets that comes with the <code>keras</code> package, you can load your own dataset from, for example, CSV files, or you can make some dummy data.</p>

<p>Whichever situation you’re in, you’ll see that you’ll be able to quickly get started with the package. This section will quickly go over the three options and explain how you can load (or create) in the data that you need to get started!</p>

<div class="section level4" id="built-in-datasets">
<h3>Built-in Datasets</h3>

<p>If you have some previous experience with the Keras package in Python, you probably will have already accessed the <a href="https://github.com/fchollet/keras/tree/master/keras/datasets">Keras built-in datasets</a> with functions such as <code>mnist.load_data()</code>, <code>cifar10.load_data()</code>, or <code>imdb.load_data()</code>.</p>

<p>Here are some examples where you load in the MNIST, CIFAR10 and IMDB data with the <code>keras</code> package:</p>

<pre><code># Read in MNIST data
mnist &lt;- dataset_mnist()

# Read in CIFAR10 data
cifar10 &lt;- dataset_cifar10()

# Read in IMDB data
imdb &lt;- dataset_imdb()</code></pre>

<p><strong>Note</strong> that all functions to load in built-in data sets with <code>keras</code> follow the same pattern; For MNIST data, you’ll use the <code>dataset_mnist()</code> function to load in your data.</p>
</div>

<div class="section level4" id="dummy-data">
<h3>Dummy Data</h3>

<p>Alternatively, you can also quickly make some dummy data to get started. You can easily use the <code>matrix()</code> function to accomplish this:</p>

<div data-encoded="true" data-height="300" class="datacamp-exercise ng-scope" style="height:300px;"><!--[if lt IE 10]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]--><div ng-controller="NormalExerciseController" class="ng-scope"><div class="dcl-exercise-area" resize-layout=""><div class="dcl-left-pane dcl-mini" ng-class="{&#39;dcl-mini&#39;: useMiniLayout}"><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;usercode&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;usercode&#39;)}" class="ng-binding dcl-active">script.R</a></li><li ng-show="solutionTabShown" class="ng-hide"><a class="dcl-animation--flash ng-binding" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;solution&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;solution&#39;)}">solution.R</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout" ng-click="activateLeftTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;console&#39;)}" class="ng-binding">R Console</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout &amp;&amp; plotTabShown" ng-click="activateLeftTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div code-editor="" control="editor" ng-show="isActiveLeftTab(&#39;usercode&#39;) || isActiveLeftTab(&#39;solution&#39;)" ng-model="userCode" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 45px; top: 0px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 271px; width: 41px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 32px;">5</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 41px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 542px; height: 271px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:16px;top:0px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Make your dummy data</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">data</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">matrix</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">rexp</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_constant ace_numeric">1000</span><span class="ace_keyword ace_operator">*</span><span class="ace_constant ace_numeric">784</span><span class="ace_paren ace_keyword ace_operator">)</span>, <span class="ace_identifier">nrow</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">1000</span>, <span class="ace_identifier">ncol</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">784</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Make dummy target values for your dummy data</span></div></div><div class="ace_line_group" style="height:32px"><div class="ace_line" style="height:16px"><span class="ace_identifier">labels</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">matrix</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">round</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">runif</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_constant ace_numeric">1000</span><span class="ace_keyword ace_operator">*</span><span class="ace_constant ace_numeric">10</span>, <span class="ace_identifier">min</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">0</span>, <span class="ace_identifier">max</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">9</span><span class="ace_paren ace_keyword ace_operator">))</span>, <span class="ace_identifier">nrow</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">1000</span>, <span class="ace_identifier">ncol</span> </div><div class="ace_line" style="height:16px"><span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">10</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 96px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 41px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 542px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div ng-show="isActiveLeftTab(&#39;console&#39;)" class="dcl-console-target dcl-console-mini-target ng-hide"><console class="dcl-console ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 18.075px; top: 0px;"></textarea><div class="ace_gutter" style="display: none;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px;"></div><div class="ace_gutter-active-line" style="display: none;"></div></div><div class="ace_scroller" style="left: 0px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 287px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_operator ace_keyword">&gt; </span><span class="ace_identifier"></span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 18.075px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 0px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 287px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></console></div><div ng-show="isActiveLeftTab(&#39;plots&#39;)" class="dcl-plots-mini-target ng-hide"><plots-container class="dcl-plots-container"><div class="dcl-plot"><img ng-show="plots.length &gt; 0" class="ng-hide"></div><div class="dcl-plot-actions"><button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="removePlot()" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-trash"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="previousPlot()" ng-disabled="plotIndex &lt;= 0" disabled="disabled"><i class="fa fa-chevron-left"></i></button> <span ng-show="plots.length &gt; 0" class="ng-binding ng-hide">1/0</span> <span ng-hide="plots.length &gt; 0">0/0</span> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="nextPlot()" ng-disabled="plotIndex &gt;= (plots.length - 1)" disabled="disabled"><i class="fa fa-chevron-right"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="expand(&#39;plot&#39;)" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-expand"></i></button></div></plots-container></div><div growl="" ng-show="!isActiveLeftTab(&#39;plots&#39;)" inline="true" limit-messages="1" sct-feedback="" class="sct-feedback-container ng-isolate-scope"><div class="growl-container bottom-left" ng-class="wrapperClasses()"><!-- ngRepeat: message in growlMessages.directives[referenceId].messages --></div></div></div></div><div ng-show="!useMiniLayout" class="dcl-right-pane clearfix ng-hide"><a class="dcl-github-link dcl-no-link-style" href="https://github.com/datacamp/datacamp-light" uib-tooltip="View DataCamp Light on Github" tooltip-placement="left" target="_blank"><div class="dcl-github-logo"></div></a><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;console&#39;)}" class="ng-binding dcl-active">R Console</a></li><li><a ng-show="plotTabShown" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div ng-show="isActiveRightTab(&#39;console&#39;)" control="console" class="dcl-console-target dcl-console-full-target"></div><div ng-show="isActiveRightTab(&#39;plots&#39;)" class="dcl-plots-full-target ng-hide"></div></div></div></div><div class="dcl-action-panel clearfix" exercise="exercise"><button ng-show="hasHint()" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showHint()" tooltip-placement="top" uib-tooltip="Get Hint">Hint</button> <button ng-show="solutionButtonShown" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showSolutionTab()" tooltip-placement="top" uib-tooltip="Show Solution">Solution</button> <button class="dcl-btn dcl-btn-primary dcl-btn-small" href="" ng-click="execute()" submit-disable="" tooltip-placement="top" uib-tooltip="Execute Code">Run</button><span class="dcl-app-status"><i class="fa fa-circle dcl-broken" ng-hide="isLoading" ng-class="{&#39;dcl-busy&#39;: isBusy, &#39;dcl-broken&#39;: isBroken}"></i> <i class="dcl-app-status-spinner fa fa-circle-o-notch fa-spin ng-hide" ng-show="isLoading"></i> <span class="dcl-app-status-text dcl-hide-xxs ng-binding" style="display: none;">Session Inactive</span></span></div></div></div>

<p><strong>Note</strong> that it’s definitely a good idea to check out the data structure of your data; It’s very important to already be aware of what data you’re working with because it will be important for the later steps that you’ll need to take. You’ll learn more about this later on in the tutorial!</p>
</div>

<div class="section level4" id="reading-data-from-files">
<h3>Reading Data From Files</h3>

<p>Besides the built-in datasets, you can also load in data from files. For this tutorial, you’ll focus on loading in data from CSV files, but if you want to know more about importing files in R, consider DataCamp’s <a href="https://www.datacamp.com/community/tutorials/r-data-import-tutorial">R Data Import Tutorial</a>.</p>

<p>Let’s use the <code>read.csv()</code> function from the <code>read.table</code> package to load in a data set from the <a href="http://archive.ics.uci.edu/ml/index.php">UCI Machine Learning Repository</a>:</p>

<div data-encoded="true" data-height="300" class="datacamp-exercise ng-scope" style="height:300px;"><!--[if lt IE 10]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]--><div ng-controller="NormalExerciseController" class="ng-scope"><div class="dcl-exercise-area" resize-layout=""><div class="dcl-left-pane dcl-mini" ng-class="{&#39;dcl-mini&#39;: useMiniLayout}"><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;usercode&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;usercode&#39;)}" class="ng-binding dcl-active">script.R</a></li><li ng-show="solutionTabShown" class="ng-hide"><a class="dcl-animation--flash ng-binding" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;solution&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;solution&#39;)}">solution.R</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout" ng-click="activateLeftTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;console&#39;)}" class="ng-binding">R Console</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout &amp;&amp; plotTabShown" ng-click="activateLeftTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div code-editor="" control="editor" ng-show="isActiveLeftTab(&#39;usercode&#39;) || isActiveLeftTab(&#39;solution&#39;)" ng-model="userCode" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 52px; top: 0px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 255px; width: 48px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 32px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div><div class="ace_gutter-cell " style="height: 16px;">6</div><div class="ace_gutter-cell " style="height: 16px;">7</div><div class="ace_gutter-cell " style="height: 16px;">8</div><div class="ace_gutter-cell " style="height: 16px;">9</div><div class="ace_gutter-cell " style="height: 16px;">10</div><div class="ace_gutter-cell " style="height: 16px;">11</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 48px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 535px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:16px;top:0px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Read in `iris` data</span></div></div><div class="ace_line_group" style="height:32px"><div class="ace_line" style="height:16px"><span class="ace_identifier">iris</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">read.csv</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">url</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_string">"http://archive.ics.uci.edu/ml/machine-learning</span></div><div class="ace_line" style="height:16px"><span class="ace_string">-databases/iris/iris.data"</span><span class="ace_paren ace_keyword ace_operator">)</span>, <span class="ace_identifier">header</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_language ace_boolean">FALSE</span><span class="ace_paren ace_keyword ace_operator">)</span> </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Return the first part of `iris`</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">head</span><span class="ace_paren ace_keyword ace_operator">(</span>....<span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Inspect the structure</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">str</span><span class="ace_paren ace_keyword ace_operator">(</span>....<span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Obtain the dimensions</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">dim</span><span class="ace_paren ace_keyword ace_operator">(</span>....<span class="ace_paren ace_keyword ace_operator">)</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="width: 22px; bottom: 0px; display: none;"><div class="ace_scrollbar-inner" style="width: 22px; height: 192px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 48px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 234px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div ng-show="isActiveLeftTab(&#39;console&#39;)" class="dcl-console-target dcl-console-mini-target ng-hide"><console class="dcl-console ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 18.075px; top: 0px;"></textarea><div class="ace_gutter" style="display: none;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px;"></div><div class="ace_gutter-active-line" style="display: none;"></div></div><div class="ace_scroller" style="left: 0px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 287px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_operator ace_keyword">&gt; </span><span class="ace_identifier"></span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 18.075px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 0px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 287px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></console></div><div ng-show="isActiveLeftTab(&#39;plots&#39;)" class="dcl-plots-mini-target ng-hide"><plots-container class="dcl-plots-container"><div class="dcl-plot"><img ng-show="plots.length &gt; 0" class="ng-hide"></div><div class="dcl-plot-actions"><button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="removePlot()" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-trash"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="previousPlot()" ng-disabled="plotIndex &lt;= 0" disabled="disabled"><i class="fa fa-chevron-left"></i></button> <span ng-show="plots.length &gt; 0" class="ng-binding ng-hide">1/0</span> <span ng-hide="plots.length &gt; 0">0/0</span> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="nextPlot()" ng-disabled="plotIndex &gt;= (plots.length - 1)" disabled="disabled"><i class="fa fa-chevron-right"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="expand(&#39;plot&#39;)" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-expand"></i></button></div></plots-container></div><div growl="" ng-show="!isActiveLeftTab(&#39;plots&#39;)" inline="true" limit-messages="1" sct-feedback="" class="sct-feedback-container ng-isolate-scope"><div class="growl-container bottom-left" ng-class="wrapperClasses()"><!-- ngRepeat: message in growlMessages.directives[referenceId].messages --></div></div></div></div><div ng-show="!useMiniLayout" class="dcl-right-pane clearfix ng-hide"><a class="dcl-github-link dcl-no-link-style" href="https://github.com/datacamp/datacamp-light" uib-tooltip="View DataCamp Light on Github" tooltip-placement="left" target="_blank"><div class="dcl-github-logo"></div></a><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;console&#39;)}" class="ng-binding dcl-active">R Console</a></li><li><a ng-show="plotTabShown" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div ng-show="isActiveRightTab(&#39;console&#39;)" control="console" class="dcl-console-target dcl-console-full-target"></div><div ng-show="isActiveRightTab(&#39;plots&#39;)" class="dcl-plots-full-target ng-hide"></div></div></div></div><div class="dcl-action-panel clearfix" exercise="exercise"><button ng-show="hasHint()" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showHint()" tooltip-placement="top" uib-tooltip="Get Hint">Hint</button> <button ng-show="solutionButtonShown" class="dcl-btn dcl-btn-secondary dcl-btn-small" href="" ng-click="showSolutionTab()" tooltip-placement="top" uib-tooltip="Show Solution">Solution</button> <button class="dcl-btn dcl-btn-primary dcl-btn-small" href="" ng-click="execute()" submit-disable="" tooltip-placement="top" uib-tooltip="Execute Code">Run</button><span class="dcl-app-status"><i class="fa fa-circle dcl-broken" ng-hide="isLoading" ng-class="{&#39;dcl-busy&#39;: isBusy, &#39;dcl-broken&#39;: isBroken}"></i> <i class="dcl-app-status-spinner fa fa-circle-o-notch fa-spin ng-hide" ng-show="isLoading"></i> <span class="dcl-app-status-text dcl-hide-xxs ng-binding" style="display: none;">Session Inactive</span></span></div></div></div>

<p>It’s always a good idea to check out whether your data import was successful. You usually use functions such as <code>head()</code>, <code>str()</code> and <code>dim()</code> like in the DataCamp Light chunk above to quickly do this.</p>

<p>The results of these three functions do not immediately point out anything out of the ordinary; By looking at the output of the <code>str()</code> function, you see that the strings of the <code>Species</code> column are read in as factors. This is no problem, but it’s definitely good to know for the next steps, where you’re going to explore and preprocess the data.</p>
</div>

<h2 id="explore">Data Exploration</h2>

<p>For this tutorial, you’ll continue to work with the famous <code>iris</code> dataset that you imported with the <code>read.csv()</code> function.</p>

<p>For those of you who don’t have the biology knowledge that is needed to work with this data, here’s some background information: all flowers contain a sepal and a petal. The sepal encloses the petals and is typically green and leaf-like, while the petals are typically colored leaves. For the iris flowers, this is just a little bit different, as you can see in the following picture:</p>

<p><img alt="deep learning Python" src="./keras_ Deep Learning in R (article) - DataCamp_files/iris-machinelearning.png"></p>

<p>You might have already seen in the previous seciton that the <code>iris</code> data frame didn’t have any column names after the import. Now, for the remainder of the tutorial, that’s not too important: even though the <code>read.csv()</code> function returns the data in a <code>data.frame</code> to you, the data that you’ll need to pass to the <code>fit()</code> function needs to be a matrix or array.</p>

<p>Some things to keep in mind about these two data structures that were just mentioned: - Matrices and arrays don’t have column names; - Matrices are two-dimensional objects of a single data type; - Arrays are multi-dimensional objects of a single data type;</p>

<p><strong>Tip</strong>: Check out <a href="https://vimeo.com/130411487">this video</a> if you want a recap of the data structures in R!</p>

<p><strong>Note</strong> that the data frame, on the other hand, is a special kind of named list where all elements have the same length. It’s a multi-dimensional object that can contain multiple data types. You already saw that this is true when you checked out the structure of the <code>iris</code> data frame in the previous section. Knowing this and taking into account that you’ll need to work towards a two- or multi-dimensional object of a <em>single</em> data type, you should already prepare to do some preprocessing before you start building your neural network!</p>

<p>For now, column names can be handy for exploring purposes and they will most definitely facilitate your understanding of the data, so let’s just add some column names with the help of the <code>names()</code> function. Next, you can immediately use the <code>iris</code> variable in your data exploration! Plot, for example, how the petal length and the petal width correlate with the <code>plot()</code> function.</p>

<div data-encoded="true" data-height="300" class="datacamp-exercise ng-scope" style="height:300px;"><!--[if lt IE 10]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]--><div ng-controller="NormalExerciseController" class="ng-scope"><div class="dcl-exercise-area" resize-layout=""><div class="dcl-left-pane dcl-mini" ng-class="{&#39;dcl-mini&#39;: useMiniLayout}"><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;usercode&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;usercode&#39;)}" class="ng-binding dcl-active">script.R</a></li><li ng-show="solutionTabShown" class="ng-hide"><a class="dcl-animation--flash ng-binding" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;solution&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;solution&#39;)}">solution.R</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout" ng-click="activateLeftTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;console&#39;)}" class="ng-binding">R Console</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout &amp;&amp; plotTabShown" ng-click="activateLeftTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div code-editor="" control="editor" ng-show="isActiveLeftTab(&#39;usercode&#39;) || isActiveLeftTab(&#39;solution&#39;)" ng-model="userCode" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 45px; top: 0px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 271px; width: 41px;"><div class="ace_gutter-cell " style="height: 32px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div><div class="ace_gutter-cell " style="height: 16px;">6</div><div class="ace_gutter-cell " style="height: 16px;">7</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 32px;"></div></div><div class="ace_scroller" style="left: 41px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 542px; height: 271px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:16px;top:0px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:32px"><div class="ace_line" style="height:16px"><span class="ace_identifier">names</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">iris</span><span class="ace_paren ace_keyword ace_operator">)</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_string">"Sepal.Length"</span>, <span class="ace_string">"Sepal.Width"</span>, <span class="ace_string">"Petal.Length"</span>, <span class="ace_string">"Petal</span></div><div class="ace_line" style="height:16px"><span class="ace_string">.Width"</span>, <span class="ace_string">"Species"</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">plot</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">iris</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">Petal.Length</span>, </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">iris</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">Petal.Width</span>, </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">pch</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">21</span>, <span class="ace_identifier">bg</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_string">"red"</span>,<span class="ace_string">"green3"</span>,<span class="ace_string">"blue"</span><span class="ace_paren ace_keyword ace_operator">)[</span><span class="ace_identifier">unclass</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">iris</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">Species</span><span class="ace_paren ace_keyword ace_operator">)]</span>, </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">xlab</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"Petal Length"</span>, </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">ylab</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"Petal Width"</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 128px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 41px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 542px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div ng-show="isActiveLeftTab(&#39;console&#39;)" class="dcl-console-target dcl-console-mini-target ng-hide"><console class="dcl-console ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 18.075px; top: 0px;"></textarea><div class="ace_gutter" style="display: none;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px;"></div><div class="ace_gutter-active-line" style="display: none;"></div></div><div class="ace_scroller" style="left: 0px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 287px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_operator ace_keyword">&gt; </span><span class="ace_identifier"></span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 18.075px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 0px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 287px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></console></div><div ng-show="isActiveLeftTab(&#39;plots&#39;)" class="dcl-plots-mini-target ng-hide"><plots-container class="dcl-plots-container"><div class="dcl-plot"><img ng-show="plots.length &gt; 0" class="ng-hide"></div><div class="dcl-plot-actions"><button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="removePlot()" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-trash"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="previousPlot()" ng-disabled="plotIndex &lt;= 0" disabled="disabled"><i class="fa fa-chevron-left"></i></button> <span ng-show="plots.length &gt; 0" class="ng-binding ng-hide">1/0</span> <span ng-hide="plots.length &gt; 0">0/0</span> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="nextPlot()" ng-disabled="plotIndex &gt;= (plots.length - 1)" disabled="disabled"><i class="fa fa-chevron-right"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="expand(&#39;plot&#39;)" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-expand"></i></button></div></plots-container></div><div growl="" ng-show="!isActiveLeftTab(&#39;plots&#39;)" inline="true" limit-messages="1" sct-feedback="" class="sct-feedback-container ng-isolate-scope"><div class="growl-container bottom-left" ng-class="wrapperClasses()"><!-- ngRepeat: message in growlMessages.directives[referenceId].messages --></div></div></div></div><div ng-show="!useMiniLayout" class="dcl-right-pane clearfix ng-hide"><a class="dcl-github-link dcl-no-link-style" href="https://github.com/datacamp/datacamp-light" uib-tooltip="View DataCamp Light on Github" tooltip-placement="left" target="_blank"><div class="dcl-github-logo"></div></a><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;console&#39;)}" class="ng-binding dcl-active">R Console</a></li><li><a ng-show="plotTabShown" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div ng-show="isActiveRightTab(&#39;console&#39;)" control="console" class="dcl-console-target dcl-console-full-target"></div><div ng-show="isActiveRightTab(&#39;plots&#39;)" class="dcl-plots-full-target ng-hide"></div></div></div></div><div class="dcl-action-panel clearfix" exercise="exercise"><button ng-show="hasHint()" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showHint()" tooltip-placement="top" uib-tooltip="Get Hint">Hint</button> <button ng-show="solutionButtonShown" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showSolutionTab()" tooltip-placement="top" uib-tooltip="Show Solution">Solution</button> <button class="dcl-btn dcl-btn-primary dcl-btn-small" href="" ng-click="execute()" submit-disable="" tooltip-placement="top" uib-tooltip="Execute Code">Run</button><span class="dcl-app-status"><i class="fa fa-circle dcl-broken" ng-hide="isLoading" ng-class="{&#39;dcl-busy&#39;: isBusy, &#39;dcl-broken&#39;: isBroken}"></i> <i class="dcl-app-status-spinner fa fa-circle-o-notch fa-spin ng-hide" ng-show="isLoading"></i> <span class="dcl-app-status-text dcl-hide-xxs ng-binding" style="display: none;">Session Inactive</span></span></div></div></div>

<p><strong>Note</strong> that you use the <code>unclass()</code> function to convert the names of the species, that is, “setosa, versicolor”, and “virginica”, to the numeric 1, 2, and 3.</p>

<p>Now take a closer look at the result of the plotting function:</p>

<p><img src="./keras_ Deep Learning in R (article) - DataCamp_files/Correlation+Iris.png"></p>

<p>The graph indicates a positive correlation between the <code>Petal.Length</code> and the <code>Petal.Width</code> for the different species of the iris flowers. However, this is something that you probably want to test with the <code>cor()</code> function, which will give you the overall correlation between all attributes that are included in the data set:</p>

<div data-encoded="true" data-height="300" class="datacamp-exercise ng-scope" style="height:300px;"><!--[if lt IE 10]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]--><div ng-controller="NormalExerciseController" class="ng-scope"><div class="dcl-exercise-area" resize-layout=""><div class="dcl-left-pane dcl-mini" ng-class="{&#39;dcl-mini&#39;: useMiniLayout}"><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;usercode&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;usercode&#39;)}" class="ng-binding dcl-active">script.R</a></li><li ng-show="solutionTabShown" class="ng-hide"><a class="dcl-animation--flash ng-binding" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;solution&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;solution&#39;)}">solution.R</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout" ng-click="activateLeftTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;console&#39;)}" class="ng-binding">R Console</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout &amp;&amp; plotTabShown" ng-click="activateLeftTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div code-editor="" control="editor" ng-show="isActiveLeftTab(&#39;usercode&#39;) || isActiveLeftTab(&#39;solution&#39;)" ng-model="userCode" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 45px; top: 0px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 255px; width: 41px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 41px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 542px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:16px;top:0px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Overall correlation between `Petal.Length` and `Petal.Width` </span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">cor</span><span class="ace_paren ace_keyword ace_operator">(</span>................., <span class="ace_identifier">iris</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">Petal.Width</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 32px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 41px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 542px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div ng-show="isActiveLeftTab(&#39;console&#39;)" class="dcl-console-target dcl-console-mini-target ng-hide"><console class="dcl-console ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 18.075px; top: 0px;"></textarea><div class="ace_gutter" style="display: none;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px;"></div><div class="ace_gutter-active-line" style="display: none;"></div></div><div class="ace_scroller" style="left: 0px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 287px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_operator ace_keyword">&gt; </span><span class="ace_identifier"></span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 18.075px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 0px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 287px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></console></div><div ng-show="isActiveLeftTab(&#39;plots&#39;)" class="dcl-plots-mini-target ng-hide"><plots-container class="dcl-plots-container"><div class="dcl-plot"><img ng-show="plots.length &gt; 0" class="ng-hide"></div><div class="dcl-plot-actions"><button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="removePlot()" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-trash"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="previousPlot()" ng-disabled="plotIndex &lt;= 0" disabled="disabled"><i class="fa fa-chevron-left"></i></button> <span ng-show="plots.length &gt; 0" class="ng-binding ng-hide">1/0</span> <span ng-hide="plots.length &gt; 0">0/0</span> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="nextPlot()" ng-disabled="plotIndex &gt;= (plots.length - 1)" disabled="disabled"><i class="fa fa-chevron-right"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="expand(&#39;plot&#39;)" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-expand"></i></button></div></plots-container></div><div growl="" ng-show="!isActiveLeftTab(&#39;plots&#39;)" inline="true" limit-messages="1" sct-feedback="" class="sct-feedback-container ng-isolate-scope"><div class="growl-container bottom-left" ng-class="wrapperClasses()"><!-- ngRepeat: message in growlMessages.directives[referenceId].messages --></div></div></div></div><div ng-show="!useMiniLayout" class="dcl-right-pane clearfix ng-hide"><a class="dcl-github-link dcl-no-link-style" href="https://github.com/datacamp/datacamp-light" uib-tooltip="View DataCamp Light on Github" tooltip-placement="left" target="_blank"><div class="dcl-github-logo"></div></a><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;console&#39;)}" class="ng-binding dcl-active">R Console</a></li><li><a ng-show="plotTabShown" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div ng-show="isActiveRightTab(&#39;console&#39;)" control="console" class="dcl-console-target dcl-console-full-target"></div><div ng-show="isActiveRightTab(&#39;plots&#39;)" class="dcl-plots-full-target ng-hide"></div></div></div></div><div class="dcl-action-panel clearfix" exercise="exercise"><button ng-show="hasHint()" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showHint()" tooltip-placement="top" uib-tooltip="Get Hint">Hint</button> <button ng-show="solutionButtonShown" class="dcl-btn dcl-btn-secondary dcl-btn-small" href="" ng-click="showSolutionTab()" tooltip-placement="top" uib-tooltip="Show Solution">Solution</button> <button class="dcl-btn dcl-btn-primary dcl-btn-small" href="" ng-click="execute()" submit-disable="" tooltip-placement="top" uib-tooltip="Execute Code">Run</button><span class="dcl-app-status"><i class="fa fa-circle dcl-broken" ng-hide="isLoading" ng-class="{&#39;dcl-busy&#39;: isBusy, &#39;dcl-broken&#39;: isBroken}"></i> <i class="dcl-app-status-spinner fa fa-circle-o-notch fa-spin ng-hide" ng-show="isLoading"></i> <span class="dcl-app-status-text dcl-hide-xxs ng-binding" style="display: none;">Session Inactive</span></span></div></div></div>

<p>Additionally, you can use the <code>corrplot</code> package in combination with the <code>cor()</code> function to plot the correlations between your data’s attributes; In this case, you calculate the overall correlation for all attributes of the <code>iris</code> data frame. You store the result of this calculation in a variable <code>M</code> and pass it to the <code>corrplot()</code> function.</p>

<p>Also, don’t forget to specify a <code>method</code> argument to indicate how you want the data to be plotted!</p>

<p>You can further experiment with the visualization method in the DataCamp Light chunk below:</p>

<div data-encoded="true" data-height="300" class="datacamp-exercise ng-scope" style="height:300px;"><!--[if lt IE 10]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]--><div ng-controller="NormalExerciseController" class="ng-scope"><div class="dcl-exercise-area" resize-layout=""><div class="dcl-left-pane dcl-mini" ng-class="{&#39;dcl-mini&#39;: useMiniLayout}"><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;usercode&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;usercode&#39;)}" class="ng-binding dcl-active">script.R</a></li><li ng-show="solutionTabShown" class="ng-hide"><a class="dcl-animation--flash ng-binding" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;solution&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;solution&#39;)}">solution.R</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout" ng-click="activateLeftTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;console&#39;)}" class="ng-binding">R Console</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout &amp;&amp; plotTabShown" ng-click="activateLeftTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div code-editor="" control="editor" ng-show="isActiveLeftTab(&#39;usercode&#39;) || isActiveLeftTab(&#39;solution&#39;)" ng-model="userCode" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 45px; top: 0px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 255px; width: 41px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 41px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 542px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:16px;top:0px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Store the overall correlation in `M`</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">M</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">cor</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">iris</span><span class="ace_paren ace_keyword ace_operator">[</span>,<span class="ace_constant ace_numeric">1</span><span class="ace_keyword ace_operator">:</span><span class="ace_constant ace_numeric">4</span><span class="ace_paren ace_keyword ace_operator">])</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Plot the correlation plot with `M`</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">corrplot</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">M</span>, <span class="ace_identifier">method</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"circle"</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 80px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 41px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 542px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div ng-show="isActiveLeftTab(&#39;console&#39;)" class="dcl-console-target dcl-console-mini-target ng-hide"><console class="dcl-console ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 18.075px; top: 0px;"></textarea><div class="ace_gutter" style="display: none;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px;"></div><div class="ace_gutter-active-line" style="display: none;"></div></div><div class="ace_scroller" style="left: 0px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 287px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_operator ace_keyword">&gt; </span><span class="ace_identifier"></span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 18.075px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 0px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 287px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></console></div><div ng-show="isActiveLeftTab(&#39;plots&#39;)" class="dcl-plots-mini-target ng-hide"><plots-container class="dcl-plots-container"><div class="dcl-plot"><img ng-show="plots.length &gt; 0" class="ng-hide"></div><div class="dcl-plot-actions"><button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="removePlot()" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-trash"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="previousPlot()" ng-disabled="plotIndex &lt;= 0" disabled="disabled"><i class="fa fa-chevron-left"></i></button> <span ng-show="plots.length &gt; 0" class="ng-binding ng-hide">1/0</span> <span ng-hide="plots.length &gt; 0">0/0</span> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="nextPlot()" ng-disabled="plotIndex &gt;= (plots.length - 1)" disabled="disabled"><i class="fa fa-chevron-right"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="expand(&#39;plot&#39;)" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-expand"></i></button></div></plots-container></div><div growl="" ng-show="!isActiveLeftTab(&#39;plots&#39;)" inline="true" limit-messages="1" sct-feedback="" class="sct-feedback-container ng-isolate-scope"><div class="growl-container bottom-left" ng-class="wrapperClasses()"><!-- ngRepeat: message in growlMessages.directives[referenceId].messages --></div></div></div></div><div ng-show="!useMiniLayout" class="dcl-right-pane clearfix ng-hide"><a class="dcl-github-link dcl-no-link-style" href="https://github.com/datacamp/datacamp-light" uib-tooltip="View DataCamp Light on Github" tooltip-placement="left" target="_blank"><div class="dcl-github-logo"></div></a><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;console&#39;)}" class="ng-binding dcl-active">R Console</a></li><li><a ng-show="plotTabShown" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div ng-show="isActiveRightTab(&#39;console&#39;)" control="console" class="dcl-console-target dcl-console-full-target"></div><div ng-show="isActiveRightTab(&#39;plots&#39;)" class="dcl-plots-full-target ng-hide"></div></div></div></div><div class="dcl-action-panel clearfix" exercise="exercise"><button ng-show="hasHint()" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showHint()" tooltip-placement="top" uib-tooltip="Get Hint">Hint</button> <button ng-show="solutionButtonShown" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showSolutionTab()" tooltip-placement="top" uib-tooltip="Show Solution">Solution</button> <button class="dcl-btn dcl-btn-primary dcl-btn-small" href="" ng-click="execute()" submit-disable="" tooltip-placement="top" uib-tooltip="Execute Code">Run</button><span class="dcl-app-status"><i class="fa fa-circle dcl-broken" ng-hide="isLoading" ng-class="{&#39;dcl-busy&#39;: isBusy, &#39;dcl-broken&#39;: isBroken}"></i> <i class="dcl-app-status-spinner fa fa-circle-o-notch fa-spin ng-hide" ng-show="isLoading"></i> <span class="dcl-app-status-text dcl-hide-xxs ng-binding" style="display: none;">Session Inactive</span></span></div></div></div>

<p><img src="./keras_ Deep Learning in R (article) - DataCamp_files/Correlation+Plot.png"></p>

<p>Make use of the R console to explore your data further.</p>

<p>If you want to make plots for this data with the <code>ggvis</code> package, which is the interactive grammar of graphics, take a look at DataCamp’s <a href="https://www.datacamp.com/community/tutorials/machine-learning-in-r">Machine Learning in R For Beginners</a> tutorial or take DataCamp’s <a href="https://www.datacamp.com/courses/ggvis-data-visualization-r-tutorial/">ggvis course</a>.</p>

<h2 id="prep">Data Preprocessing</h2>

<p>Before you can build your model, you also need to make sure that your data is cleaned, normalized (if applicable) and divided into training and test sets. Since the dataset comes from the UCI Machine Learning Repository, you can expect it to already be somewhat clean, but let’s double check the quality of your data anyway.</p>

<p>At first sight, when you inspected the data with <code>head()</code>, you didn’t really see anything out of the ordinary, right? Let’s make use of <code>summary()</code> and <code>str()</code> to briefly recap what you learned when you checked whether the import of your data was successful:</p>

<div data-encoded="true" data-height="300" class="datacamp-exercise ng-scope" style="height:300px;"><!--[if lt IE 10]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]--><div ng-controller="NormalExerciseController" class="ng-scope"><div class="dcl-exercise-area" resize-layout=""><div class="dcl-left-pane dcl-mini" ng-class="{&#39;dcl-mini&#39;: useMiniLayout}"><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;usercode&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;usercode&#39;)}" class="ng-binding dcl-active">script.R</a></li><li ng-show="solutionTabShown" class="ng-hide"><a class="dcl-animation--flash ng-binding" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;solution&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;solution&#39;)}">solution.R</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout" ng-click="activateLeftTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;console&#39;)}" class="ng-binding">R Console</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout &amp;&amp; plotTabShown" ng-click="activateLeftTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div code-editor="" control="editor" ng-show="isActiveLeftTab(&#39;usercode&#39;) || isActiveLeftTab(&#39;solution&#39;)" ng-model="userCode" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 45px; top: 0px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 255px; width: 41px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 41px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 542px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:16px;top:0px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Pull up a summary of `iris`</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">summary</span><span class="ace_paren ace_keyword ace_operator">(</span>....<span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Inspect the structure of `iris`</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">str</span><span class="ace_paren ace_keyword ace_operator">(</span>....<span class="ace_paren ace_keyword ace_operator">)</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 80px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 41px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 542px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div ng-show="isActiveLeftTab(&#39;console&#39;)" class="dcl-console-target dcl-console-mini-target ng-hide"><console class="dcl-console ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 18.075px; top: 0px;"></textarea><div class="ace_gutter" style="display: none;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px;"></div><div class="ace_gutter-active-line" style="display: none;"></div></div><div class="ace_scroller" style="left: 0px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 287px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_operator ace_keyword">&gt; </span><span class="ace_identifier"></span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 18.075px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 0px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 287px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></console></div><div ng-show="isActiveLeftTab(&#39;plots&#39;)" class="dcl-plots-mini-target ng-hide"><plots-container class="dcl-plots-container"><div class="dcl-plot"><img ng-show="plots.length &gt; 0" class="ng-hide"></div><div class="dcl-plot-actions"><button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="removePlot()" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-trash"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="previousPlot()" ng-disabled="plotIndex &lt;= 0" disabled="disabled"><i class="fa fa-chevron-left"></i></button> <span ng-show="plots.length &gt; 0" class="ng-binding ng-hide">1/0</span> <span ng-hide="plots.length &gt; 0">0/0</span> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="nextPlot()" ng-disabled="plotIndex &gt;= (plots.length - 1)" disabled="disabled"><i class="fa fa-chevron-right"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="expand(&#39;plot&#39;)" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-expand"></i></button></div></plots-container></div><div growl="" ng-show="!isActiveLeftTab(&#39;plots&#39;)" inline="true" limit-messages="1" sct-feedback="" class="sct-feedback-container ng-isolate-scope"><div class="growl-container bottom-left" ng-class="wrapperClasses()"><!-- ngRepeat: message in growlMessages.directives[referenceId].messages --></div></div></div></div><div ng-show="!useMiniLayout" class="dcl-right-pane clearfix ng-hide"><a class="dcl-github-link dcl-no-link-style" href="https://github.com/datacamp/datacamp-light" uib-tooltip="View DataCamp Light on Github" tooltip-placement="left" target="_blank"><div class="dcl-github-logo"></div></a><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;console&#39;)}" class="ng-binding dcl-active">R Console</a></li><li><a ng-show="plotTabShown" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div ng-show="isActiveRightTab(&#39;console&#39;)" control="console" class="dcl-console-target dcl-console-full-target"></div><div ng-show="isActiveRightTab(&#39;plots&#39;)" class="dcl-plots-full-target ng-hide"></div></div></div></div><div class="dcl-action-panel clearfix" exercise="exercise"><button ng-show="hasHint()" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showHint()" tooltip-placement="top" uib-tooltip="Get Hint">Hint</button> <button ng-show="solutionButtonShown" class="dcl-btn dcl-btn-secondary dcl-btn-small" href="" ng-click="showSolutionTab()" tooltip-placement="top" uib-tooltip="Show Solution">Solution</button> <button class="dcl-btn dcl-btn-primary dcl-btn-small" href="" ng-click="execute()" submit-disable="" tooltip-placement="top" uib-tooltip="Execute Code">Run</button><span class="dcl-app-status"><i class="fa fa-circle dcl-broken" ng-hide="isLoading" ng-class="{&#39;dcl-busy&#39;: isBusy, &#39;dcl-broken&#39;: isBroken}"></i> <i class="dcl-app-status-spinner fa fa-circle-o-notch fa-spin ng-hide" ng-show="isLoading"></i> <span class="dcl-app-status-text dcl-hide-xxs ng-binding" style="display: none;">Session Inactive</span></span></div></div></div>

<p>Now that you’re sure that the data is clean enough, you can start by checking if the normalization is necessary for any of the data with which you’re working for this tutorial.</p>

<div class="section level3" id="normalizing-your-data-with-a-user-defined-function-udf">
<h3>Normalizing Your Data With A User Defined Function (UDF)</h3>

<p>From the result of the <code>summary()</code> function in the DataCamp Light chunk above, you see that the Iris data set doesn’t need to be normalized: the <code>Sepal.Length</code> attribute has values that go from <code>4.3</code> to <code>7.9</code> and <code>Sepal.Width</code> contains values from <code>2</code> to <code>4.4</code>, while <code>Petal.Length</code>’s values range from <code>1</code> to <code>6.9</code> and <code>Petal.Width</code> goes from <code>0.1</code> to <code>2.5</code>. In other words, all values of all the attributes of the Iris data set are contained within the range of <code>0.1</code> and <code>7.9</code>, which you can consider acceptable.</p>

<p>However, it can still be a good idea to study the effect of normalization on your data; You can even go as far as passing the normalized data to your model to see if there is any effect. This is outside the scope of this tutorial, but feel free to try it out on your own! The code is all here in this tutorial :)</p>

<p>You can make your own function to normalize the iris data; In this case, it’s a min-max normalization function, which linearly transforms your data to the function <em>(x-min)/(max-min)</em>. From that perspective, translating this formula to R is pretty simple: you make a function to which you pass <code>x</code> or some data. You’ll then calculate the result of the first subtraction <em>x-min</em> and store the result in <code>num</code>. Next, you also calculate <em>max-min</em> and store the result in <code>denom</code>. The result of your <code>normalize()</code> function should return the division of <code>num</code> by <code>max</code>.</p>

<p>To apply this user-defined function on your <code>iris</code> data (target values excluded), you need to not only use <code>normalize</code>, but also the <code>lapply()</code> function to normalize the data, just like here below:</p>

<div data-encoded="true" data-height="300" class="datacamp-exercise ng-scope" style="height:300px;"><!--[if lt IE 10]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]--><div ng-controller="NormalExerciseController" class="ng-scope"><div class="dcl-exercise-area" resize-layout=""><div class="dcl-left-pane dcl-mini" ng-class="{&#39;dcl-mini&#39;: useMiniLayout}"><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;usercode&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;usercode&#39;)}" class="ng-binding dcl-active">script.R</a></li><li ng-show="solutionTabShown" class="ng-hide"><a class="dcl-animation--flash ng-binding" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;solution&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;solution&#39;)}">solution.R</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout" ng-click="activateLeftTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;console&#39;)}" class="ng-binding">R Console</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout &amp;&amp; plotTabShown" ng-click="activateLeftTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div code-editor="" control="editor" ng-show="isActiveLeftTab(&#39;usercode&#39;) || isActiveLeftTab(&#39;solution&#39;)" ng-model="userCode" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 52px; top: 0px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 255px; width: 48px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div><div class="ace_gutter-cell " style="height: 16px;">6</div><div class="ace_gutter-cell " style="height: 16px;">7</div><div class="ace_gutter-cell " style="height: 16px;">8</div><div class="ace_gutter-cell " style="height: 16px;">9</div><div class="ace_gutter-cell " style="height: 16px;">10</div><div class="ace_gutter-cell " style="height: 16px;">11</div><div class="ace_gutter-cell " style="height: 16px;">12</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 48px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 535px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:16px;top:0px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Build your own `normalize()` function</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">normalize</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_keyword">function</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">x</span><span class="ace_paren ace_keyword ace_operator">)</span> <span class="ace_paren ace_keyword ace_operator">{</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">  <span class="ace_identifier">num</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">x</span> <span class="ace_keyword ace_operator">-</span> <span class="ace_identifier">min</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">x</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">  <span class="ace_identifier">denom</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">max</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">x</span><span class="ace_paren ace_keyword ace_operator">)</span> <span class="ace_keyword ace_operator">-</span> <span class="ace_identifier">min</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">x</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">  <span class="ace_keyword">return</span> <span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">num</span><span class="ace_keyword ace_operator">/</span><span class="ace_identifier">denom</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_paren ace_keyword ace_operator">}</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Normalize the `iris` data</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">iris_norm</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">as.data.frame</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">lapply</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">iris</span><span class="ace_paren ace_keyword ace_operator">[</span><span class="ace_constant ace_numeric">1</span><span class="ace_keyword ace_operator">:</span><span class="ace_constant ace_numeric">4</span><span class="ace_paren ace_keyword ace_operator">]</span>, .........<span class="ace_paren ace_keyword ace_operator">))</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Return the first part of `iris` </span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">head</span><span class="ace_paren ace_keyword ace_operator">(</span>....<span class="ace_paren ace_keyword ace_operator">)</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="width: 22px; bottom: 0px; display: none;"><div class="ace_scrollbar-inner" style="width: 22px; height: 192px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 48px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 234px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div ng-show="isActiveLeftTab(&#39;console&#39;)" class="dcl-console-target dcl-console-mini-target ng-hide"><console class="dcl-console ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 18.075px; top: 0px;"></textarea><div class="ace_gutter" style="display: none;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px;"></div><div class="ace_gutter-active-line" style="display: none;"></div></div><div class="ace_scroller" style="left: 0px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 287px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_operator ace_keyword">&gt; </span><span class="ace_identifier"></span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 18.075px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 0px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 287px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></console></div><div ng-show="isActiveLeftTab(&#39;plots&#39;)" class="dcl-plots-mini-target ng-hide"><plots-container class="dcl-plots-container"><div class="dcl-plot"><img ng-show="plots.length &gt; 0" class="ng-hide"></div><div class="dcl-plot-actions"><button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="removePlot()" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-trash"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="previousPlot()" ng-disabled="plotIndex &lt;= 0" disabled="disabled"><i class="fa fa-chevron-left"></i></button> <span ng-show="plots.length &gt; 0" class="ng-binding ng-hide">1/0</span> <span ng-hide="plots.length &gt; 0">0/0</span> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="nextPlot()" ng-disabled="plotIndex &gt;= (plots.length - 1)" disabled="disabled"><i class="fa fa-chevron-right"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="expand(&#39;plot&#39;)" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-expand"></i></button></div></plots-container></div><div growl="" ng-show="!isActiveLeftTab(&#39;plots&#39;)" inline="true" limit-messages="1" sct-feedback="" class="sct-feedback-container ng-isolate-scope"><div class="growl-container bottom-left" ng-class="wrapperClasses()"><!-- ngRepeat: message in growlMessages.directives[referenceId].messages --></div></div></div></div><div ng-show="!useMiniLayout" class="dcl-right-pane clearfix ng-hide"><a class="dcl-github-link dcl-no-link-style" href="https://github.com/datacamp/datacamp-light" uib-tooltip="View DataCamp Light on Github" tooltip-placement="left" target="_blank"><div class="dcl-github-logo"></div></a><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;console&#39;)}" class="ng-binding dcl-active">R Console</a></li><li><a ng-show="plotTabShown" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div ng-show="isActiveRightTab(&#39;console&#39;)" control="console" class="dcl-console-target dcl-console-full-target"></div><div ng-show="isActiveRightTab(&#39;plots&#39;)" class="dcl-plots-full-target ng-hide"></div></div></div></div><div class="dcl-action-panel clearfix" exercise="exercise"><button ng-show="hasHint()" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showHint()" tooltip-placement="top" uib-tooltip="Get Hint">Hint</button> <button ng-show="solutionButtonShown" class="dcl-btn dcl-btn-secondary dcl-btn-small" href="" ng-click="showSolutionTab()" tooltip-placement="top" uib-tooltip="Show Solution">Solution</button> <button class="dcl-btn dcl-btn-primary dcl-btn-small" href="" ng-click="execute()" submit-disable="" tooltip-placement="top" uib-tooltip="Execute Code">Run</button><span class="dcl-app-status"><i class="fa fa-circle dcl-broken" ng-hide="isLoading" ng-class="{&#39;dcl-busy&#39;: isBusy, &#39;dcl-broken&#39;: isBroken}"></i> <i class="dcl-app-status-spinner fa fa-circle-o-notch fa-spin ng-hide" ng-show="isLoading"></i> <span class="dcl-app-status-text dcl-hide-xxs ng-binding" style="display: none;">Session Inactive</span></span></div></div></div>

<p><strong>Tip</strong> use the <code>hist()</code> function in the R console to to study the distribution of the Iris data before (<code>iris</code>) and after the normalization (<code>iris_norm</code>).</p>
</div>

<div class="section level3" id="normalize-your-data-with-keras">
<h3>Normalize Your Data With <code>keras</code></h3>

<p>To use the <code>normalize()</code> function from the <code>keras</code> package, you first need to make sure that you’re working with a matrix. As you probably remember from earlier, the characteristic of matrices is that the matrix data elements are of the same basic type; In this case, you have target values that are of type factor, while the rest is all numeric.</p>

<p>This needs to change first.</p>

<p>You can use the <code>as.numeric()</code> function to convert the data to numbers:</p>

<div data-encoded="true" data-height="300" class="datacamp-exercise ng-scope" style="height:300px;"><!--[if lt IE 10]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]--><div ng-controller="NormalExerciseController" class="ng-scope"><div class="dcl-exercise-area" resize-layout=""><div class="dcl-left-pane dcl-mini" ng-class="{&#39;dcl-mini&#39;: useMiniLayout}"><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;usercode&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;usercode&#39;)}" class="ng-binding dcl-active">script.R</a></li><li ng-show="solutionTabShown" class="ng-hide"><a class="dcl-animation--flash ng-binding" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;solution&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;solution&#39;)}">solution.R</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout" ng-click="activateLeftTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;console&#39;)}" class="ng-binding">R Console</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout &amp;&amp; plotTabShown" ng-click="activateLeftTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div code-editor="" control="editor" ng-show="isActiveLeftTab(&#39;usercode&#39;) || isActiveLeftTab(&#39;solution&#39;)" ng-model="userCode" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 45px; top: 0px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 255px; width: 41px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div><div class="ace_gutter-cell " style="height: 16px;">6</div><div class="ace_gutter-cell " style="height: 16px;">7</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 41px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 542px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:16px;top:0px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">iris</span><span class="ace_paren ace_keyword ace_operator">[</span>,<span class="ace_constant ace_numeric">5</span><span class="ace_paren ace_keyword ace_operator">]</span> <span class="ace_keyword ace_operator">&lt;-</span> ...........<span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">iris</span><span class="ace_paren ace_keyword ace_operator">[</span>,<span class="ace_constant ace_numeric">5</span><span class="ace_paren ace_keyword ace_operator">])</span> <span class="ace_keyword ace_operator">-</span><span class="ace_constant ace_numeric">1</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Turn `iris` into a matrix</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">iris</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">as.matrix</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">iris</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Set `iris` `dimnames` to `NULL`</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">dimnames</span><span class="ace_paren ace_keyword ace_operator">(</span>....<span class="ace_paren ace_keyword ace_operator">)</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_constant ace_language">NULL</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 112px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 41px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 542px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div ng-show="isActiveLeftTab(&#39;console&#39;)" class="dcl-console-target dcl-console-mini-target ng-hide"><console class="dcl-console ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 18.075px; top: 0px;"></textarea><div class="ace_gutter" style="display: none;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px;"></div><div class="ace_gutter-active-line" style="display: none;"></div></div><div class="ace_scroller" style="left: 0px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 287px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_operator ace_keyword">&gt; </span><span class="ace_identifier"></span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 18.075px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 0px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 287px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></console></div><div ng-show="isActiveLeftTab(&#39;plots&#39;)" class="dcl-plots-mini-target ng-hide"><plots-container class="dcl-plots-container"><div class="dcl-plot"><img ng-show="plots.length &gt; 0" class="ng-hide"></div><div class="dcl-plot-actions"><button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="removePlot()" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-trash"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="previousPlot()" ng-disabled="plotIndex &lt;= 0" disabled="disabled"><i class="fa fa-chevron-left"></i></button> <span ng-show="plots.length &gt; 0" class="ng-binding ng-hide">1/0</span> <span ng-hide="plots.length &gt; 0">0/0</span> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="nextPlot()" ng-disabled="plotIndex &gt;= (plots.length - 1)" disabled="disabled"><i class="fa fa-chevron-right"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="expand(&#39;plot&#39;)" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-expand"></i></button></div></plots-container></div><div growl="" ng-show="!isActiveLeftTab(&#39;plots&#39;)" inline="true" limit-messages="1" sct-feedback="" class="sct-feedback-container ng-isolate-scope"><div class="growl-container bottom-left" ng-class="wrapperClasses()"><!-- ngRepeat: message in growlMessages.directives[referenceId].messages --></div></div></div></div><div ng-show="!useMiniLayout" class="dcl-right-pane clearfix ng-hide"><a class="dcl-github-link dcl-no-link-style" href="https://github.com/datacamp/datacamp-light" uib-tooltip="View DataCamp Light on Github" tooltip-placement="left" target="_blank"><div class="dcl-github-logo"></div></a><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;console&#39;)}" class="ng-binding dcl-active">R Console</a></li><li><a ng-show="plotTabShown" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div ng-show="isActiveRightTab(&#39;console&#39;)" control="console" class="dcl-console-target dcl-console-full-target"></div><div ng-show="isActiveRightTab(&#39;plots&#39;)" class="dcl-plots-full-target ng-hide"></div></div></div></div><div class="dcl-action-panel clearfix" exercise="exercise"><button ng-show="hasHint()" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showHint()" tooltip-placement="top" uib-tooltip="Get Hint">Hint</button> <button ng-show="solutionButtonShown" class="dcl-btn dcl-btn-secondary dcl-btn-small" href="" ng-click="showSolutionTab()" tooltip-placement="top" uib-tooltip="Show Solution">Solution</button> <button class="dcl-btn dcl-btn-primary dcl-btn-small" href="" ng-click="execute()" submit-disable="" tooltip-placement="top" uib-tooltip="Execute Code">Run</button><span class="dcl-app-status"><i class="fa fa-circle dcl-broken" ng-hide="isLoading" ng-class="{&#39;dcl-busy&#39;: isBusy, &#39;dcl-broken&#39;: isBroken}"></i> <i class="dcl-app-status-spinner fa fa-circle-o-notch fa-spin ng-hide" ng-show="isLoading"></i> <span class="dcl-app-status-text dcl-hide-xxs ng-binding" style="display: none;">Session Inactive</span></span></div></div></div>

<p>A numerical data frame is alright, but you’ll need to convert the data to an array or a matrix if you want to make use of the <code>keras</code> package. You can easily do this with the <code>as.matrix()</code> function; Don’t forget here to set the <code>dimnames</code> to <code>NULL</code>.</p>

<p>As you might have read in the section above, normalizing the Iris data is not necessary. Nevertheless, it’s still a good idea to study normalization and its effect, and to see how this can not only be done with a UDF but also with the <code>keras</code> built-in <code>normalize()</code> function.</p>

<p>With your data converted to a matrix, you can indeed also use the <code>keras</code> package to study the effect of a possible normalization on your data:</p>

<div data-encoded="true" data-height="300" class="datacamp-exercise ng-scope" style="height:300px;"><!--[if lt IE 10]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]--><div ng-controller="NormalExerciseController" class="ng-scope"><div class="dcl-exercise-area" resize-layout=""><div class="dcl-left-pane dcl-mini" ng-class="{&#39;dcl-mini&#39;: useMiniLayout}"><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;usercode&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;usercode&#39;)}" class="ng-binding dcl-active">script.R</a></li><li ng-show="solutionTabShown" class="ng-hide"><a class="dcl-animation--flash ng-binding" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;solution&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;solution&#39;)}">solution.R</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout" ng-click="activateLeftTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;console&#39;)}" class="ng-binding">R Console</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout &amp;&amp; plotTabShown" ng-click="activateLeftTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div code-editor="" control="editor" ng-show="isActiveLeftTab(&#39;usercode&#39;) || isActiveLeftTab(&#39;solution&#39;)" ng-model="userCode" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 45px; top: 0px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 255px; width: 41px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 41px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 542px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:16px;top:0px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Normalize the `iris` data</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">iris</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">normalize</span><span class="ace_paren ace_keyword ace_operator">(</span>....<span class="ace_paren ace_keyword ace_operator">[</span>,<span class="ace_constant ace_numeric">1</span><span class="ace_keyword ace_operator">:</span><span class="ace_constant ace_numeric">4</span><span class="ace_paren ace_keyword ace_operator">])</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Return the summary of `iris`</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">summary</span><span class="ace_paren ace_keyword ace_operator">(</span>....<span class="ace_paren ace_keyword ace_operator">)</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 80px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 41px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 542px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div ng-show="isActiveLeftTab(&#39;console&#39;)" class="dcl-console-target dcl-console-mini-target ng-hide"><console class="dcl-console ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 18.075px; top: 0px;"></textarea><div class="ace_gutter" style="display: none;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px;"></div><div class="ace_gutter-active-line" style="display: none;"></div></div><div class="ace_scroller" style="left: 0px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 287px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_operator ace_keyword">&gt; </span><span class="ace_identifier"></span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 18.075px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 0px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 287px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></console></div><div ng-show="isActiveLeftTab(&#39;plots&#39;)" class="dcl-plots-mini-target ng-hide"><plots-container class="dcl-plots-container"><div class="dcl-plot"><img ng-show="plots.length &gt; 0" class="ng-hide"></div><div class="dcl-plot-actions"><button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="removePlot()" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-trash"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="previousPlot()" ng-disabled="plotIndex &lt;= 0" disabled="disabled"><i class="fa fa-chevron-left"></i></button> <span ng-show="plots.length &gt; 0" class="ng-binding ng-hide">1/0</span> <span ng-hide="plots.length &gt; 0">0/0</span> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="nextPlot()" ng-disabled="plotIndex &gt;= (plots.length - 1)" disabled="disabled"><i class="fa fa-chevron-right"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="expand(&#39;plot&#39;)" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-expand"></i></button></div></plots-container></div><div growl="" ng-show="!isActiveLeftTab(&#39;plots&#39;)" inline="true" limit-messages="1" sct-feedback="" class="sct-feedback-container ng-isolate-scope"><div class="growl-container bottom-left" ng-class="wrapperClasses()"><!-- ngRepeat: message in growlMessages.directives[referenceId].messages --></div></div></div></div><div ng-show="!useMiniLayout" class="dcl-right-pane clearfix ng-hide"><a class="dcl-github-link dcl-no-link-style" href="https://github.com/datacamp/datacamp-light" uib-tooltip="View DataCamp Light on Github" tooltip-placement="left" target="_blank"><div class="dcl-github-logo"></div></a><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;console&#39;)}" class="ng-binding dcl-active">R Console</a></li><li><a ng-show="plotTabShown" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div ng-show="isActiveRightTab(&#39;console&#39;)" control="console" class="dcl-console-target dcl-console-full-target"></div><div ng-show="isActiveRightTab(&#39;plots&#39;)" class="dcl-plots-full-target ng-hide"></div></div></div></div><div class="dcl-action-panel clearfix" exercise="exercise"><button ng-show="hasHint()" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showHint()" tooltip-placement="top" uib-tooltip="Get Hint">Hint</button> <button ng-show="solutionButtonShown" class="dcl-btn dcl-btn-secondary dcl-btn-small" href="" ng-click="showSolutionTab()" tooltip-placement="top" uib-tooltip="Show Solution">Solution</button> <button class="dcl-btn dcl-btn-primary dcl-btn-small" href="" ng-click="execute()" submit-disable="" tooltip-placement="top" uib-tooltip="Execute Code">Run</button><span class="dcl-app-status"><i class="fa fa-circle dcl-broken" ng-hide="isLoading" ng-class="{&#39;dcl-busy&#39;: isBusy, &#39;dcl-broken&#39;: isBroken}"></i> <i class="dcl-app-status-spinner fa fa-circle-o-notch fa-spin ng-hide" ng-show="isLoading"></i> <span class="dcl-app-status-text dcl-hide-xxs ng-binding" style="display: none;">Session Inactive</span></span></div></div></div>

<p><strong>Note</strong> that here, you use <code>dimnames()</code> to set the dimnames of <code>iris</code> to <code>NULL</code>. This ensures that there are no column names in your data.</p>
</div>

<div class="section level3" id="training-and-test-sets">
<h3>Training And Test Sets</h3>

<p>Now that you have checked the quality of your data and you know that it’s not necessary to normalize your data, you can continue to work with the original data and split it into training and test sets so that you’re finally ready to start building your model. By doing this, you ensure that you can make honest assessments of the performance of your predicte model afterwards.</p>

<p>Before you split your data into training and test sets, you best first set a seed. You can easily do this with <code>set.seed()</code>: use this exact function and just pass a random integer to it. A seed is a number of R’s random number generator. The major advantage of setting a seed is that you can get the same sequence of random numbers whenever you supply the same seed in the random number generator.</p>

<p>This is great for the reproducibility of your code!</p>

<p>You use the <code>sample()</code> function to take a sample with a size that is set as the number of rows of the Iris data set, or 150. You sample with replacement: you choose from a vector of 2 elements and assign either 1 or 2 to the 150 rows of the Iris data set. The assignment of the elements is subject to probability weights of <code>0.67</code> and <code>0.33</code>.</p>

<div data-encoded="true" data-height="300" class="datacamp-exercise ng-scope" style="height:300px;"><!--[if lt IE 10]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]--><div ng-controller="NormalExerciseController" class="ng-scope"><div class="dcl-exercise-area" resize-layout=""><div class="dcl-left-pane dcl-mini" ng-class="{&#39;dcl-mini&#39;: useMiniLayout}"><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;usercode&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;usercode&#39;)}" class="ng-binding dcl-active">script.R</a></li><li ng-show="solutionTabShown" class="ng-hide"><a class="dcl-animation--flash ng-binding" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;solution&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;solution&#39;)}">solution.R</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout" ng-click="activateLeftTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;console&#39;)}" class="ng-binding">R Console</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout &amp;&amp; plotTabShown" ng-click="activateLeftTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div code-editor="" control="editor" ng-show="isActiveLeftTab(&#39;usercode&#39;) || isActiveLeftTab(&#39;solution&#39;)" ng-model="userCode" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 52px; top: 0px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 255px; width: 48px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div><div class="ace_gutter-cell " style="height: 16px;">6</div><div class="ace_gutter-cell " style="height: 16px;">7</div><div class="ace_gutter-cell " style="height: 16px;">8</div><div class="ace_gutter-cell " style="height: 16px;">9</div><div class="ace_gutter-cell " style="height: 16px;">10</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 48px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 535px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:16px;top:0px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Determine sample size</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">ind</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">sample</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_constant ace_numeric">2</span>, <span class="ace_identifier">nrow</span><span class="ace_paren ace_keyword ace_operator">(</span>....<span class="ace_paren ace_keyword ace_operator">)</span>, <span class="ace_identifier">replace</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_language ace_boolean">TRUE</span>, <span class="ace_identifier">prob</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_constant ace_numeric">0.67</span>, <span class="ace_constant ace_numeric">0.33</span><span class="ace_paren ace_keyword ace_operator">))</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Split the `iris` data</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">iris.training</span> <span class="ace_keyword ace_operator">&lt;-</span> ....<span class="ace_paren ace_keyword ace_operator">[</span><span class="ace_identifier">ind</span><span class="ace_keyword ace_operator">==</span><span class="ace_constant ace_numeric">1</span>, <span class="ace_constant ace_numeric">1</span><span class="ace_keyword ace_operator">:</span><span class="ace_constant ace_numeric">4</span><span class="ace_paren ace_keyword ace_operator">]</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">iris.test</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">iris</span><span class="ace_paren ace_keyword ace_operator">[</span><span class="ace_identifier">ind</span><span class="ace_keyword ace_operator">==</span><span class="ace_constant ace_numeric">2</span>, <span class="ace_constant ace_numeric">1</span><span class="ace_keyword ace_operator">:</span><span class="ace_constant ace_numeric">4</span><span class="ace_paren ace_keyword ace_operator">]</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Split the class attribute</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">iris.trainingtarget</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">iris</span><span class="ace_paren ace_keyword ace_operator">[</span>...<span class="ace_keyword ace_operator">==</span><span class="ace_constant ace_numeric">1</span>, <span class="ace_constant ace_numeric">5</span><span class="ace_paren ace_keyword ace_operator">]</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">iris.testtarget</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">iris</span><span class="ace_paren ace_keyword ace_operator">[</span><span class="ace_identifier">ind</span><span class="ace_keyword ace_operator">==</span><span class="ace_constant ace_numeric">2</span>, <span class="ace_constant ace_numeric">5</span><span class="ace_paren ace_keyword ace_operator">]</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="width: 22px; bottom: 0px; display: none;"><div class="ace_scrollbar-inner" style="width: 22px; height: 160px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 48px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 251px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div ng-show="isActiveLeftTab(&#39;console&#39;)" class="dcl-console-target dcl-console-mini-target ng-hide"><console class="dcl-console ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 18.075px; top: 0px;"></textarea><div class="ace_gutter" style="display: none;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px;"></div><div class="ace_gutter-active-line" style="display: none;"></div></div><div class="ace_scroller" style="left: 0px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 287px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_operator ace_keyword">&gt; </span><span class="ace_identifier"></span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 18.075px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 0px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 287px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></console></div><div ng-show="isActiveLeftTab(&#39;plots&#39;)" class="dcl-plots-mini-target ng-hide"><plots-container class="dcl-plots-container"><div class="dcl-plot"><img ng-show="plots.length &gt; 0" class="ng-hide"></div><div class="dcl-plot-actions"><button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="removePlot()" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-trash"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="previousPlot()" ng-disabled="plotIndex &lt;= 0" disabled="disabled"><i class="fa fa-chevron-left"></i></button> <span ng-show="plots.length &gt; 0" class="ng-binding ng-hide">1/0</span> <span ng-hide="plots.length &gt; 0">0/0</span> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="nextPlot()" ng-disabled="plotIndex &gt;= (plots.length - 1)" disabled="disabled"><i class="fa fa-chevron-right"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="expand(&#39;plot&#39;)" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-expand"></i></button></div></plots-container></div><div growl="" ng-show="!isActiveLeftTab(&#39;plots&#39;)" inline="true" limit-messages="1" sct-feedback="" class="sct-feedback-container ng-isolate-scope"><div class="growl-container bottom-left" ng-class="wrapperClasses()"><!-- ngRepeat: message in growlMessages.directives[referenceId].messages --></div></div></div></div><div ng-show="!useMiniLayout" class="dcl-right-pane clearfix ng-hide"><a class="dcl-github-link dcl-no-link-style" href="https://github.com/datacamp/datacamp-light" uib-tooltip="View DataCamp Light on Github" tooltip-placement="left" target="_blank"><div class="dcl-github-logo"></div></a><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;console&#39;)}" class="ng-binding dcl-active">R Console</a></li><li><a ng-show="plotTabShown" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div ng-show="isActiveRightTab(&#39;console&#39;)" control="console" class="dcl-console-target dcl-console-full-target"></div><div ng-show="isActiveRightTab(&#39;plots&#39;)" class="dcl-plots-full-target ng-hide"></div></div></div></div><div class="dcl-action-panel clearfix" exercise="exercise"><button ng-show="hasHint()" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showHint()" tooltip-placement="top" uib-tooltip="Get Hint">Hint</button> <button ng-show="solutionButtonShown" class="dcl-btn dcl-btn-secondary dcl-btn-small" href="" ng-click="showSolutionTab()" tooltip-placement="top" uib-tooltip="Show Solution">Solution</button> <button class="dcl-btn dcl-btn-primary dcl-btn-small" href="" ng-click="execute()" submit-disable="" tooltip-placement="top" uib-tooltip="Execute Code">Run</button><span class="dcl-app-status"><i class="fa fa-circle dcl-broken" ng-hide="isLoading" ng-class="{&#39;dcl-busy&#39;: isBusy, &#39;dcl-broken&#39;: isBroken}"></i> <i class="dcl-app-status-spinner fa fa-circle-o-notch fa-spin ng-hide" ng-show="isLoading"></i> <span class="dcl-app-status-text dcl-hide-xxs ng-binding" style="display: none;">Session Inactive</span></span></div></div></div>

<p>The <code>replace</code> argument of the <code>sample()</code> function is set to <code>TRUE</code>, which means that you assign a <code>1</code> or a <code>2</code> to a certain row and then reset the vector of <code>2</code> to its original state.</p>

<p>In other words, for the next rows in your data set, you can either assign a <code>1</code> or a <code>2</code>, each time again. The probability of choosing a <code>1</code> or a <code>2</code> should not be proportional to the weights amongst the remaining items, so you specify probability weights.</p>

<p><em>Side note:</em> if you would have used a built-in dataset with the specific <code>dataset_imdb()</code> function, for example, your data can easily be split by using the <code>$</code> operator:</p>

<pre><code>x_train &lt;- imdb$train$x
y_train &lt;- imdb$train$y
x_test &lt;- imdb$test$x
y_test &lt;- imdb$test$y</code></pre>
</div>

<div class="section level3" id="one-hot-encoding">
<h3>One-Hot Encoding</h3>

<p>You have successfully split your data but there is still one step that you need to go through to start building your model. Can you guess which one?</p>

<p>When you want to model multi-class classification problems with neural networks, it is generally a good practice to make sure that you transform your target attribute from a vector that contains values for each class value to a matrix with a boolean for each class value and whether or not a given instance has that class value or not.</p>

<p>This is a loose explanation of One Hot Encoding (OHE). It sounds quite complex, doesn’t it?</p>

<p>Luckily, the <code>keras</code> package has a <code>to_categorical()</code> function that will do all of this for you; Pass in the <code>iris.trainingtarget</code> and the <code>iris.testtarget</code> to this function and store the result in <code>iris.trainLabels</code> and <code>iris.testLabels</code>:</p>

<div data-encoded="true" data-height="300" class="datacamp-exercise ng-scope" style="height:300px;"><!--[if lt IE 10]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]--><div ng-controller="NormalExerciseController" class="ng-scope"><div class="dcl-exercise-area" resize-layout=""><div class="dcl-left-pane dcl-mini" ng-class="{&#39;dcl-mini&#39;: useMiniLayout}"><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;usercode&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;usercode&#39;)}" class="ng-binding dcl-active">script.R</a></li><li ng-show="solutionTabShown" class="ng-hide"><a class="dcl-animation--flash ng-binding" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;solution&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;solution&#39;)}">solution.R</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout" ng-click="activateLeftTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;console&#39;)}" class="ng-binding">R Console</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout &amp;&amp; plotTabShown" ng-click="activateLeftTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div code-editor="" control="editor" ng-show="isActiveLeftTab(&#39;usercode&#39;) || isActiveLeftTab(&#39;solution&#39;)" ng-model="userCode" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 45px; top: 0px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 255px; width: 41px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div><div class="ace_gutter-cell " style="height: 16px;">6</div><div class="ace_gutter-cell " style="height: 16px;">7</div><div class="ace_gutter-cell " style="height: 16px;">8</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 41px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 542px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:16px;top:0px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># One hot encode training target values</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">iris.trainLabels</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">to_categorical</span><span class="ace_paren ace_keyword ace_operator">(</span>..................<span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># One hot encode test target values</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">iris.testLabels</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">to_categorical</span><span class="ace_paren ace_keyword ace_operator">(</span>...............<span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Print out the iris.testLabels to double check the result</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">print</span><span class="ace_paren ace_keyword ace_operator">(</span>.............<span class="ace_paren ace_keyword ace_operator">)</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 128px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 41px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 542px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div ng-show="isActiveLeftTab(&#39;console&#39;)" class="dcl-console-target dcl-console-mini-target ng-hide"><console class="dcl-console ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 18.075px; top: 0px;"></textarea><div class="ace_gutter" style="display: none;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px;"></div><div class="ace_gutter-active-line" style="display: none;"></div></div><div class="ace_scroller" style="left: 0px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 287px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_operator ace_keyword">&gt; </span><span class="ace_identifier"></span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 18.075px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 0px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 287px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></console></div><div ng-show="isActiveLeftTab(&#39;plots&#39;)" class="dcl-plots-mini-target ng-hide"><plots-container class="dcl-plots-container"><div class="dcl-plot"><img ng-show="plots.length &gt; 0" class="ng-hide"></div><div class="dcl-plot-actions"><button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="removePlot()" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-trash"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="previousPlot()" ng-disabled="plotIndex &lt;= 0" disabled="disabled"><i class="fa fa-chevron-left"></i></button> <span ng-show="plots.length &gt; 0" class="ng-binding ng-hide">1/0</span> <span ng-hide="plots.length &gt; 0">0/0</span> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="nextPlot()" ng-disabled="plotIndex &gt;= (plots.length - 1)" disabled="disabled"><i class="fa fa-chevron-right"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="expand(&#39;plot&#39;)" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-expand"></i></button></div></plots-container></div><div growl="" ng-show="!isActiveLeftTab(&#39;plots&#39;)" inline="true" limit-messages="1" sct-feedback="" class="sct-feedback-container ng-isolate-scope"><div class="growl-container bottom-left" ng-class="wrapperClasses()"><!-- ngRepeat: message in growlMessages.directives[referenceId].messages --></div></div></div></div><div ng-show="!useMiniLayout" class="dcl-right-pane clearfix ng-hide"><a class="dcl-github-link dcl-no-link-style" href="https://github.com/datacamp/datacamp-light" uib-tooltip="View DataCamp Light on Github" tooltip-placement="left" target="_blank"><div class="dcl-github-logo"></div></a><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;console&#39;)}" class="ng-binding dcl-active">R Console</a></li><li><a ng-show="plotTabShown" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div ng-show="isActiveRightTab(&#39;console&#39;)" control="console" class="dcl-console-target dcl-console-full-target"></div><div ng-show="isActiveRightTab(&#39;plots&#39;)" class="dcl-plots-full-target ng-hide"></div></div></div></div><div class="dcl-action-panel clearfix" exercise="exercise"><button ng-show="hasHint()" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showHint()" tooltip-placement="top" uib-tooltip="Get Hint">Hint</button> <button ng-show="solutionButtonShown" class="dcl-btn dcl-btn-secondary dcl-btn-small" href="" ng-click="showSolutionTab()" tooltip-placement="top" uib-tooltip="Show Solution">Solution</button> <button class="dcl-btn dcl-btn-primary dcl-btn-small" href="" ng-click="execute()" submit-disable="" tooltip-placement="top" uib-tooltip="Execute Code">Run</button><span class="dcl-app-status"><i class="fa fa-circle dcl-broken" ng-hide="isLoading" ng-class="{&#39;dcl-busy&#39;: isBusy, &#39;dcl-broken&#39;: isBroken}"></i> <i class="dcl-app-status-spinner fa fa-circle-o-notch fa-spin ng-hide" ng-show="isLoading"></i> <span class="dcl-app-status-text dcl-hide-xxs ng-binding" style="display: none;">Session Inactive</span></span></div></div></div>

<p>Now you have officially reached the end of the exploration and preprocessing steps in this tutorial. You can now go on to building your neural network with <code>keras</code>!</p>
</div>

<h2 id="model">Constructing the Model</h2>

<p>To start constructing a model, you should first initialize a sequential model with the help of the <code>keras_model_sequential()</code> function. Then, you’re ready to start modeling.</p>

<p>However, before you begin, it’s a good idea to revisit your original question about this data set: can you predict the species of a certain Iris flower? It’s easier to work with numerical data and you have preprocessed the data and one hot encoded the values of the target variable: a flower is either of type versicolor, setosa or virginica and this is reflected with binary <code>1</code> and <code>0</code> values.</p>

<p>A type of network that performs well on such a problem is a multi-layer perceptron. This type of neural network is often fully connected. That means that you’re looking to build a fairly simple stack of fully-connected layers to solve this problem. As for the activation functions that you will use, it’s best to use one of the most common ones here for the purpose of getting familiar with Keras and neural networks, which is the relu activation function. This rectifier activation function is used in a hidden layer, which is generally speaking a good practice.</p>

<p>In addition, you also see that the softmax activation function is used in the output layer. You do this because you want to make sure that the output values are in the range of 0 and 1 and may be used as predicted probabilities:</p>

<div data-encoded="true" data-height="300" class="datacamp-exercise ng-scope" style="height:300px;"><!--[if lt IE 10]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]--><div ng-controller="NormalExerciseController" class="ng-scope"><div class="dcl-exercise-area" resize-layout=""><div class="dcl-left-pane dcl-mini" ng-class="{&#39;dcl-mini&#39;: useMiniLayout}"><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;usercode&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;usercode&#39;)}" class="ng-binding dcl-active">script.R</a></li><li ng-show="solutionTabShown" class="ng-hide"><a class="dcl-animation--flash ng-binding" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;solution&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;solution&#39;)}">solution.R</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout" ng-click="activateLeftTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;console&#39;)}" class="ng-binding">R Console</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout &amp;&amp; plotTabShown" ng-click="activateLeftTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div code-editor="" control="editor" ng-show="isActiveLeftTab(&#39;usercode&#39;) || isActiveLeftTab(&#39;solution&#39;)" ng-model="userCode" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 45px; top: 0px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 255px; width: 41px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div><div class="ace_gutter-cell " style="height: 16px;">6</div><div class="ace_gutter-cell " style="height: 16px;">7</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 41px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 542px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:16px;top:0px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Initialize a sequential model</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">&lt;-</span> ......................</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Add layers to the model</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">%&gt;%</span> </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">    <span class="ace_identifier">layer_dense</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">units</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">8</span>, <span class="ace_identifier">activation</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'relu'</span>, <span class="ace_identifier">input_shape</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_constant ace_numeric">4</span><span class="ace_paren ace_keyword ace_operator">))</span> <span class="ace_keyword ace_operator">%&gt;%</span> </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">    <span class="ace_identifier">layer_dense</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">units</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">3</span>, <span class="ace_identifier">activation</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'softmax'</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 112px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 41px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 542px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div ng-show="isActiveLeftTab(&#39;console&#39;)" class="dcl-console-target dcl-console-mini-target ng-hide"><console class="dcl-console ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 18.075px; top: 0px;"></textarea><div class="ace_gutter" style="display: none;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px;"></div><div class="ace_gutter-active-line" style="display: none;"></div></div><div class="ace_scroller" style="left: 0px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 287px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_operator ace_keyword">&gt; </span><span class="ace_identifier"></span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 18.075px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 0px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 287px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></console></div><div ng-show="isActiveLeftTab(&#39;plots&#39;)" class="dcl-plots-mini-target ng-hide"><plots-container class="dcl-plots-container"><div class="dcl-plot"><img ng-show="plots.length &gt; 0" class="ng-hide"></div><div class="dcl-plot-actions"><button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="removePlot()" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-trash"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="previousPlot()" ng-disabled="plotIndex &lt;= 0" disabled="disabled"><i class="fa fa-chevron-left"></i></button> <span ng-show="plots.length &gt; 0" class="ng-binding ng-hide">1/0</span> <span ng-hide="plots.length &gt; 0">0/0</span> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="nextPlot()" ng-disabled="plotIndex &gt;= (plots.length - 1)" disabled="disabled"><i class="fa fa-chevron-right"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="expand(&#39;plot&#39;)" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-expand"></i></button></div></plots-container></div><div growl="" ng-show="!isActiveLeftTab(&#39;plots&#39;)" inline="true" limit-messages="1" sct-feedback="" class="sct-feedback-container ng-isolate-scope"><div class="growl-container bottom-left" ng-class="wrapperClasses()"><!-- ngRepeat: message in growlMessages.directives[referenceId].messages --></div></div></div></div><div ng-show="!useMiniLayout" class="dcl-right-pane clearfix ng-hide"><a class="dcl-github-link dcl-no-link-style" href="https://github.com/datacamp/datacamp-light" uib-tooltip="View DataCamp Light on Github" tooltip-placement="left" target="_blank"><div class="dcl-github-logo"></div></a><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;console&#39;)}" class="ng-binding dcl-active">R Console</a></li><li><a ng-show="plotTabShown" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div ng-show="isActiveRightTab(&#39;console&#39;)" control="console" class="dcl-console-target dcl-console-full-target"></div><div ng-show="isActiveRightTab(&#39;plots&#39;)" class="dcl-plots-full-target ng-hide"></div></div></div></div><div class="dcl-action-panel clearfix" exercise="exercise"><button ng-show="hasHint()" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showHint()" tooltip-placement="top" uib-tooltip="Get Hint">Hint</button> <button ng-show="solutionButtonShown" class="dcl-btn dcl-btn-secondary dcl-btn-small" href="" ng-click="showSolutionTab()" tooltip-placement="top" uib-tooltip="Show Solution">Solution</button> <button class="dcl-btn dcl-btn-primary dcl-btn-small" href="" ng-click="execute()" submit-disable="" tooltip-placement="top" uib-tooltip="Execute Code">Run</button><span class="dcl-app-status"><i class="fa fa-circle dcl-broken" ng-hide="isLoading" ng-class="{&#39;dcl-busy&#39;: isBusy, &#39;dcl-broken&#39;: isBroken}"></i> <i class="dcl-app-status-spinner fa fa-circle-o-notch fa-spin ng-hide" ng-show="isLoading"></i> <span class="dcl-app-status-text dcl-hide-xxs ng-binding" style="display: none;">Session Inactive</span></span></div></div></div>

<p><strong>Note</strong> how the output layer creates 3 output values, one for each Iris class (versicolor, virginica or setosa). The first layer, which contains 8 hidden notes, on the other hand, has an <code>input_shape</code> of 4. This is because your training data <code>iris.training</code> has 4 columns.</p>

<p>You can further inspect your model with the following functions:</p>

<ul>
	<li>You can use the <code>summary()</code> function to print a summary representation of your model;</li>
	<li><code>get_config()</code> will return a list that contains the configuration of the model;</li>
	<li><code>get_layer()</code> will return the layer configuration.</li>
	<li><code>layers</code> attribute can be used to retrieve a flattened list of the model’s layers;</li>
	<li>To list the input tensors, you can use the <code>inputs</code> attribute; and</li>
	<li>Lastly, to retrieve the output tensors, you can make use of the <code>outputs</code> attribute.</li>
</ul>

<div data-encoded="true" data-height="400" class="datacamp-exercise ng-scope" style="height:400px;"><!--[if lt IE 10]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]--><div ng-controller="NormalExerciseController" class="ng-scope"><div class="dcl-exercise-area" resize-layout=""><div class="dcl-left-pane dcl-mini" ng-class="{&#39;dcl-mini&#39;: useMiniLayout}"><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;usercode&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;usercode&#39;)}" class="ng-binding dcl-active">script.R</a></li><li ng-show="solutionTabShown" class="ng-hide"><a class="dcl-animation--flash ng-binding" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;solution&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;solution&#39;)}">solution.R</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout" ng-click="activateLeftTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;console&#39;)}" class="ng-binding">R Console</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout &amp;&amp; plotTabShown" ng-click="activateLeftTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div code-editor="" control="editor" ng-show="isActiveLeftTab(&#39;usercode&#39;) || isActiveLeftTab(&#39;solution&#39;)" ng-model="userCode" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 52px; top: 0px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 355px; width: 48px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div><div class="ace_gutter-cell " style="height: 16px;">6</div><div class="ace_gutter-cell " style="height: 16px;">7</div><div class="ace_gutter-cell " style="height: 16px;">8</div><div class="ace_gutter-cell " style="height: 16px;">9</div><div class="ace_gutter-cell " style="height: 16px;">10</div><div class="ace_gutter-cell " style="height: 16px;">11</div><div class="ace_gutter-cell " style="height: 16px;">12</div><div class="ace_gutter-cell " style="height: 16px;">13</div><div class="ace_gutter-cell " style="height: 16px;">14</div><div class="ace_gutter-cell " style="height: 16px;">15</div><div class="ace_gutter-cell " style="height: 16px;">16</div><div class="ace_gutter-cell " style="height: 16px;">17</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 48px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 535px; height: 355px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:16px;top:0px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Print a summary of a model</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">summary</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">model</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Get model configuration</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">get_config</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">model</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Get layer configuration</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">get_layer</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">model</span>, <span class="ace_identifier">index</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># List the model's layers</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">model</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">layers</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># List the input tensors</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">model</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">inputs</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># List the output tensors</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">model</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">outputs</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 272px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 48px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 535px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div ng-show="isActiveLeftTab(&#39;console&#39;)" class="dcl-console-target dcl-console-mini-target ng-hide"><console class="dcl-console ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 18.075px; top: 0px;"></textarea><div class="ace_gutter" style="display: none;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px;"></div><div class="ace_gutter-active-line" style="display: none;"></div></div><div class="ace_scroller" style="left: 0px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 287px; height: 355px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_operator ace_keyword">&gt; </span><span class="ace_identifier"></span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 18.075px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 0px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 287px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></console></div><div ng-show="isActiveLeftTab(&#39;plots&#39;)" class="dcl-plots-mini-target ng-hide"><plots-container class="dcl-plots-container"><div class="dcl-plot"><img ng-show="plots.length &gt; 0" class="ng-hide"></div><div class="dcl-plot-actions"><button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="removePlot()" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-trash"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="previousPlot()" ng-disabled="plotIndex &lt;= 0" disabled="disabled"><i class="fa fa-chevron-left"></i></button> <span ng-show="plots.length &gt; 0" class="ng-binding ng-hide">1/0</span> <span ng-hide="plots.length &gt; 0">0/0</span> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="nextPlot()" ng-disabled="plotIndex &gt;= (plots.length - 1)" disabled="disabled"><i class="fa fa-chevron-right"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="expand(&#39;plot&#39;)" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-expand"></i></button></div></plots-container></div><div growl="" ng-show="!isActiveLeftTab(&#39;plots&#39;)" inline="true" limit-messages="1" sct-feedback="" class="sct-feedback-container ng-isolate-scope"><div class="growl-container bottom-left" ng-class="wrapperClasses()"><!-- ngRepeat: message in growlMessages.directives[referenceId].messages --></div></div></div></div><div ng-show="!useMiniLayout" class="dcl-right-pane clearfix ng-hide"><a class="dcl-github-link dcl-no-link-style" href="https://github.com/datacamp/datacamp-light" uib-tooltip="View DataCamp Light on Github" tooltip-placement="left" target="_blank"><div class="dcl-github-logo"></div></a><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;console&#39;)}" class="ng-binding dcl-active">R Console</a></li><li><a ng-show="plotTabShown" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div ng-show="isActiveRightTab(&#39;console&#39;)" control="console" class="dcl-console-target dcl-console-full-target"></div><div ng-show="isActiveRightTab(&#39;plots&#39;)" class="dcl-plots-full-target ng-hide"></div></div></div></div><div class="dcl-action-panel clearfix" exercise="exercise"><button ng-show="hasHint()" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showHint()" tooltip-placement="top" uib-tooltip="Get Hint">Hint</button> <button ng-show="solutionButtonShown" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showSolutionTab()" tooltip-placement="top" uib-tooltip="Show Solution">Solution</button> <button class="dcl-btn dcl-btn-primary dcl-btn-small" href="" ng-click="execute()" submit-disable="" tooltip-placement="top" uib-tooltip="Execute Code">Run</button><span class="dcl-app-status"><i class="fa fa-circle dcl-broken" ng-hide="isLoading" ng-class="{&#39;dcl-busy&#39;: isBusy, &#39;dcl-broken&#39;: isBroken}"></i> <i class="dcl-app-status-spinner fa fa-circle-o-notch fa-spin ng-hide" ng-show="isLoading"></i> <span class="dcl-app-status-text dcl-hide-xxs ng-binding" style="display: none;">Session Inactive</span></span></div></div></div>

<h2 id="compile">Compile And Fit The Model</h2>

<p>Now that you have set up the architecture of your model, it’s time to compile and fit the model to the data. To compile your model, you configure the model with the <code>adam</code> optimizer and the <code>categorical_crossentropy</code> loss function. Additionally, you also monitor the accuracy during the training by passing <code>'accuracy'</code> to the metrics argument.</p>

<div data-encoded="true" data-height="300" class="datacamp-exercise ng-scope" style="height:300px;"><!--[if lt IE 10]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]--><div ng-controller="NormalExerciseController" class="ng-scope"><div class="dcl-exercise-area" resize-layout=""><div class="dcl-left-pane dcl-mini" ng-class="{&#39;dcl-mini&#39;: useMiniLayout}"><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;usercode&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;usercode&#39;)}" class="ng-binding dcl-active">script.R</a></li><li ng-show="solutionTabShown" class="ng-hide"><a class="dcl-animation--flash ng-binding" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;solution&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;solution&#39;)}">solution.R</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout" ng-click="activateLeftTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;console&#39;)}" class="ng-binding">R Console</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout &amp;&amp; plotTabShown" ng-click="activateLeftTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div code-editor="" control="editor" ng-show="isActiveLeftTab(&#39;usercode&#39;) || isActiveLeftTab(&#39;solution&#39;)" ng-model="userCode" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 45px; top: 0px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 255px; width: 41px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div><div class="ace_gutter-cell " style="height: 16px;">6</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 41px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 542px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:16px;top:0px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Compile the model</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">%&gt;%</span> <span class="ace_identifier">compile</span><span class="ace_paren ace_keyword ace_operator">(</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">loss</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'categorical_crossentropy'</span>,</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">optimizer</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'adam'</span>,</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">metrics</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'accuracy'</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"> <span class="ace_paren ace_keyword ace_operator">)</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 96px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 41px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 542px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div ng-show="isActiveLeftTab(&#39;console&#39;)" class="dcl-console-target dcl-console-mini-target ng-hide"><console class="dcl-console ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 18.075px; top: 0px;"></textarea><div class="ace_gutter" style="display: none;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px;"></div><div class="ace_gutter-active-line" style="display: none;"></div></div><div class="ace_scroller" style="left: 0px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 287px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_operator ace_keyword">&gt; </span><span class="ace_identifier"></span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 18.075px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 0px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 287px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></console></div><div ng-show="isActiveLeftTab(&#39;plots&#39;)" class="dcl-plots-mini-target ng-hide"><plots-container class="dcl-plots-container"><div class="dcl-plot"><img ng-show="plots.length &gt; 0" class="ng-hide"></div><div class="dcl-plot-actions"><button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="removePlot()" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-trash"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="previousPlot()" ng-disabled="plotIndex &lt;= 0" disabled="disabled"><i class="fa fa-chevron-left"></i></button> <span ng-show="plots.length &gt; 0" class="ng-binding ng-hide">1/0</span> <span ng-hide="plots.length &gt; 0">0/0</span> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="nextPlot()" ng-disabled="plotIndex &gt;= (plots.length - 1)" disabled="disabled"><i class="fa fa-chevron-right"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="expand(&#39;plot&#39;)" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-expand"></i></button></div></plots-container></div><div growl="" ng-show="!isActiveLeftTab(&#39;plots&#39;)" inline="true" limit-messages="1" sct-feedback="" class="sct-feedback-container ng-isolate-scope"><div class="growl-container bottom-left" ng-class="wrapperClasses()"><!-- ngRepeat: message in growlMessages.directives[referenceId].messages --></div></div></div></div><div ng-show="!useMiniLayout" class="dcl-right-pane clearfix ng-hide"><a class="dcl-github-link dcl-no-link-style" href="https://github.com/datacamp/datacamp-light" uib-tooltip="View DataCamp Light on Github" tooltip-placement="left" target="_blank"><div class="dcl-github-logo"></div></a><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;console&#39;)}" class="ng-binding dcl-active">R Console</a></li><li><a ng-show="plotTabShown" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div ng-show="isActiveRightTab(&#39;console&#39;)" control="console" class="dcl-console-target dcl-console-full-target"></div><div ng-show="isActiveRightTab(&#39;plots&#39;)" class="dcl-plots-full-target ng-hide"></div></div></div></div><div class="dcl-action-panel clearfix" exercise="exercise"><button ng-show="hasHint()" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showHint()" tooltip-placement="top" uib-tooltip="Get Hint">Hint</button> <button ng-show="solutionButtonShown" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showSolutionTab()" tooltip-placement="top" uib-tooltip="Show Solution">Solution</button> <button class="dcl-btn dcl-btn-primary dcl-btn-small" href="" ng-click="execute()" submit-disable="" tooltip-placement="top" uib-tooltip="Execute Code">Run</button><span class="dcl-app-status"><i class="fa fa-circle dcl-broken" ng-hide="isLoading" ng-class="{&#39;dcl-busy&#39;: isBusy, &#39;dcl-broken&#39;: isBroken}"></i> <i class="dcl-app-status-spinner fa fa-circle-o-notch fa-spin ng-hide" ng-show="isLoading"></i> <span class="dcl-app-status-text dcl-hide-xxs ng-binding" style="display: none;">Session Inactive</span></span></div></div></div>

<p>The optimizer and the loss are two arguments that are required if you want to compile the model.</p>

<p>Some of the most popular optimization algorithms used are the Stochastic Gradient Descent (SGD), ADAM and RMSprop. Depending on whichever algorithm you choose, you’ll need to tune certain parameters, such as learning rate or momentum. The choice for a loss function depends on the task that you have at hand: for example, for a regression problem, you’ll usually use the Mean Squared Error (MSE).</p>

<p>As you see in this example, you used <code>categorical_crossentropy</code> loss function for the multi-class classification problem of determining whether an iris is of type versicolor, virginica or setosa. However, note that if you would have had a binary-class classification problem, you should have made use of the <code>binary_crossentropy</code> loss function.</p>

<p>Next, you can also fit the model to your data; In this case, you train the model for 200 epochs or iterations over all the samples in <code>iris.training</code> and <code>iris.trainLabels</code>, in batches of 5 samples.</p>

<div data-encoded="true" data-height="300" class="datacamp-exercise ng-scope" style="height:300px;"><!--[if lt IE 10]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]--><div ng-controller="NormalExerciseController" class="ng-scope"><div class="dcl-exercise-area" resize-layout=""><div class="dcl-left-pane dcl-mini" ng-class="{&#39;dcl-mini&#39;: useMiniLayout}"><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;usercode&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;usercode&#39;)}" class="ng-binding dcl-active">script.R</a></li><li ng-show="solutionTabShown" class="ng-hide"><a class="dcl-animation--flash ng-binding" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;solution&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;solution&#39;)}">solution.R</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout" ng-click="activateLeftTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;console&#39;)}" class="ng-binding">R Console</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout &amp;&amp; plotTabShown" ng-click="activateLeftTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div code-editor="" control="editor" ng-show="isActiveLeftTab(&#39;usercode&#39;) || isActiveLeftTab(&#39;solution&#39;)" ng-model="userCode" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 45px; top: 0px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 255px; width: 41px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div><div class="ace_gutter-cell " style="height: 16px;">6</div><div class="ace_gutter-cell " style="height: 16px;">7</div><div class="ace_gutter-cell " style="height: 16px;">8</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 41px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 542px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:16px;top:0px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Fit the model </span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">%&gt;%</span> <span class="ace_identifier">fit</span><span class="ace_paren ace_keyword ace_operator">(</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">iris.training</span>, </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">iris.trainLabels</span>, </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">epochs</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">200</span>, </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">batch_size</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">5</span>, </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">validation_split</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">0.2</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"> <span class="ace_paren ace_keyword ace_operator">)</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 128px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 41px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 542px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div ng-show="isActiveLeftTab(&#39;console&#39;)" class="dcl-console-target dcl-console-mini-target ng-hide"><console class="dcl-console ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 18.075px; top: 0px;"></textarea><div class="ace_gutter" style="display: none;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px;"></div><div class="ace_gutter-active-line" style="display: none;"></div></div><div class="ace_scroller" style="left: 0px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 287px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_operator ace_keyword">&gt; </span><span class="ace_identifier"></span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 18.075px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 0px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 287px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></console></div><div ng-show="isActiveLeftTab(&#39;plots&#39;)" class="dcl-plots-mini-target ng-hide"><plots-container class="dcl-plots-container"><div class="dcl-plot"><img ng-show="plots.length &gt; 0" class="ng-hide"></div><div class="dcl-plot-actions"><button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="removePlot()" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-trash"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="previousPlot()" ng-disabled="plotIndex &lt;= 0" disabled="disabled"><i class="fa fa-chevron-left"></i></button> <span ng-show="plots.length &gt; 0" class="ng-binding ng-hide">1/0</span> <span ng-hide="plots.length &gt; 0">0/0</span> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="nextPlot()" ng-disabled="plotIndex &gt;= (plots.length - 1)" disabled="disabled"><i class="fa fa-chevron-right"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="expand(&#39;plot&#39;)" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-expand"></i></button></div></plots-container></div><div growl="" ng-show="!isActiveLeftTab(&#39;plots&#39;)" inline="true" limit-messages="1" sct-feedback="" class="sct-feedback-container ng-isolate-scope"><div class="growl-container bottom-left" ng-class="wrapperClasses()"><!-- ngRepeat: message in growlMessages.directives[referenceId].messages --></div></div></div></div><div ng-show="!useMiniLayout" class="dcl-right-pane clearfix ng-hide"><a class="dcl-github-link dcl-no-link-style" href="https://github.com/datacamp/datacamp-light" uib-tooltip="View DataCamp Light on Github" tooltip-placement="left" target="_blank"><div class="dcl-github-logo"></div></a><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;console&#39;)}" class="ng-binding dcl-active">R Console</a></li><li><a ng-show="plotTabShown" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div ng-show="isActiveRightTab(&#39;console&#39;)" control="console" class="dcl-console-target dcl-console-full-target"></div><div ng-show="isActiveRightTab(&#39;plots&#39;)" class="dcl-plots-full-target ng-hide"></div></div></div></div><div class="dcl-action-panel clearfix" exercise="exercise"><button ng-show="hasHint()" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showHint()" tooltip-placement="top" uib-tooltip="Get Hint">Hint</button> <button ng-show="solutionButtonShown" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showSolutionTab()" tooltip-placement="top" uib-tooltip="Show Solution">Solution</button> <button class="dcl-btn dcl-btn-primary dcl-btn-small" href="" ng-click="execute()" submit-disable="" tooltip-placement="top" uib-tooltip="Execute Code">Run</button><span class="dcl-app-status"><i class="fa fa-circle dcl-broken" ng-hide="isLoading" ng-class="{&#39;dcl-busy&#39;: isBusy, &#39;dcl-broken&#39;: isBroken}"></i> <i class="dcl-app-status-spinner fa fa-circle-o-notch fa-spin ng-hide" ng-show="isLoading"></i> <span class="dcl-app-status-text dcl-hide-xxs ng-binding" style="display: none;">Session Inactive</span></span></div></div></div>

<p><strong>Tip</strong> if you want, you can also specify the verbose argument in the <code>fit()</code> function. By setting this argument to <code>1</code>, you indicate that you want to see progress bar logging.</p>

<p>What you do with the code above is training the model for a specified number of epochs or exposures to the training dataset. An epoch is a single pass through the entire training set, followed by testing of the verification set. The batch size that you specify in the code above defines the number of samples that going to be propagated through the network. Also, by doing this, you optimize the efficiency because you make sure that you don’t load too many input patterns into memory at the same time.</p>

<h2 id="viz">Visualize The Model Training History</h2>

<p>Also, it’s good to know that you can also visualize the fitting if you assign the lines of code in the DataCamp Light chunk above to a variable. You can then pass the variable to the <code>plot()</code> function, like you see in this particular code chunk!</p>

<div data-encoded="true" data-height="300" class="datacamp-exercise ng-scope" style="height:300px;"><!--[if lt IE 10]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]--><div ng-controller="NormalExerciseController" class="ng-scope"><div class="dcl-exercise-area" resize-layout=""><div class="dcl-left-pane dcl-mini" ng-class="{&#39;dcl-mini&#39;: useMiniLayout}"><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;usercode&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;usercode&#39;)}" class="ng-binding dcl-active">script.R</a></li><li ng-show="solutionTabShown" class="ng-hide"><a class="dcl-animation--flash ng-binding" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;solution&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;solution&#39;)}">solution.R</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout" ng-click="activateLeftTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;console&#39;)}" class="ng-binding">R Console</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout &amp;&amp; plotTabShown" ng-click="activateLeftTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div code-editor="" control="editor" ng-show="isActiveLeftTab(&#39;usercode&#39;) || isActiveLeftTab(&#39;solution&#39;)" ng-model="userCode" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 52px; top: 0px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 255px; width: 48px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div><div class="ace_gutter-cell " style="height: 16px;">6</div><div class="ace_gutter-cell " style="height: 16px;">7</div><div class="ace_gutter-cell " style="height: 16px;">8</div><div class="ace_gutter-cell " style="height: 16px;">9</div><div class="ace_gutter-cell " style="height: 16px;">10</div><div class="ace_gutter-cell " style="height: 16px;">11</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 48px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 535px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:16px;top:0px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Store the fitting history in `history` </span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">history</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">%&gt;%</span> <span class="ace_identifier">fit</span><span class="ace_paren ace_keyword ace_operator">(</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">iris.training</span>, </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">iris.trainLabels</span>, </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">epochs</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">200</span>,</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">batch_size</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">5</span>, </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">validation_split</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">0.2</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"> <span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Plot the history</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">plot</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">history</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 176px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 48px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 535px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div ng-show="isActiveLeftTab(&#39;console&#39;)" class="dcl-console-target dcl-console-mini-target ng-hide"><console class="dcl-console ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 18.075px; top: 0px;"></textarea><div class="ace_gutter" style="display: none;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px;"></div><div class="ace_gutter-active-line" style="display: none;"></div></div><div class="ace_scroller" style="left: 0px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 287px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_operator ace_keyword">&gt; </span><span class="ace_identifier"></span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 18.075px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 0px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 287px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></console></div><div ng-show="isActiveLeftTab(&#39;plots&#39;)" class="dcl-plots-mini-target ng-hide"><plots-container class="dcl-plots-container"><div class="dcl-plot"><img ng-show="plots.length &gt; 0" class="ng-hide"></div><div class="dcl-plot-actions"><button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="removePlot()" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-trash"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="previousPlot()" ng-disabled="plotIndex &lt;= 0" disabled="disabled"><i class="fa fa-chevron-left"></i></button> <span ng-show="plots.length &gt; 0" class="ng-binding ng-hide">1/0</span> <span ng-hide="plots.length &gt; 0">0/0</span> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="nextPlot()" ng-disabled="plotIndex &gt;= (plots.length - 1)" disabled="disabled"><i class="fa fa-chevron-right"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="expand(&#39;plot&#39;)" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-expand"></i></button></div></plots-container></div><div growl="" ng-show="!isActiveLeftTab(&#39;plots&#39;)" inline="true" limit-messages="1" sct-feedback="" class="sct-feedback-container ng-isolate-scope"><div class="growl-container bottom-left" ng-class="wrapperClasses()"><!-- ngRepeat: message in growlMessages.directives[referenceId].messages --></div></div></div></div><div ng-show="!useMiniLayout" class="dcl-right-pane clearfix ng-hide"><a class="dcl-github-link dcl-no-link-style" href="https://github.com/datacamp/datacamp-light" uib-tooltip="View DataCamp Light on Github" tooltip-placement="left" target="_blank"><div class="dcl-github-logo"></div></a><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;console&#39;)}" class="ng-binding dcl-active">R Console</a></li><li><a ng-show="plotTabShown" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div ng-show="isActiveRightTab(&#39;console&#39;)" control="console" class="dcl-console-target dcl-console-full-target"></div><div ng-show="isActiveRightTab(&#39;plots&#39;)" class="dcl-plots-full-target ng-hide"></div></div></div></div><div class="dcl-action-panel clearfix" exercise="exercise"><button ng-show="hasHint()" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showHint()" tooltip-placement="top" uib-tooltip="Get Hint">Hint</button> <button ng-show="solutionButtonShown" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showSolutionTab()" tooltip-placement="top" uib-tooltip="Show Solution">Solution</button> <button class="dcl-btn dcl-btn-primary dcl-btn-small" href="" ng-click="execute()" submit-disable="" tooltip-placement="top" uib-tooltip="Execute Code">Run</button><span class="dcl-app-status"><i class="fa fa-circle dcl-broken" ng-hide="isLoading" ng-class="{&#39;dcl-busy&#39;: isBusy, &#39;dcl-broken&#39;: isBroken}"></i> <i class="dcl-app-status-spinner fa fa-circle-o-notch fa-spin ng-hide" ng-show="isLoading"></i> <span class="dcl-app-status-text dcl-hide-xxs ng-binding" style="display: none;">Session Inactive</span></span></div></div></div>

<p>Make sure to study the plot in more detail.</p>

<p><img src="./keras_ Deep Learning in R (article) - DataCamp_files/Fitting-Plot.png"></p>

<p>At first sight, it’s no surprise that this all looks a tad messy. You might not entirely know what you’re looking at, right?</p>

<p>One good thing to know is that the <code>loss</code> and <code>acc</code> indicate the loss and accuracy of the model for the training data, while the <code>val_loss</code> and <code>val_acc</code> are the same metrics, loss and accuracy, for the test or validation data.</p>

<p>But, even as you know this, it’s not easy to interpret these two graphs. Let’s try to break this up into pieces that you might understand more easily! You’ll split up these two plots and make two separate ones instead: you’ll make one for the model loss and another one for the model accuracy. Luckily, you can easily make use of the <code>$</code> operator to access the data and plot it step by step.</p>

<p>Check out the DataCamp Light box below to see how you can do this:</p>

<div data-encoded="true" data-height="300" class="datacamp-exercise ng-scope" style="height:300px;"><!--[if lt IE 10]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]--><div ng-controller="NormalExerciseController" class="ng-scope"><div class="dcl-exercise-area" resize-layout=""><div class="dcl-left-pane dcl-mini" ng-class="{&#39;dcl-mini&#39;: useMiniLayout}"><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;usercode&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;usercode&#39;)}" class="ng-binding dcl-active">script.R</a></li><li ng-show="solutionTabShown" class="ng-hide"><a class="dcl-animation--flash ng-binding" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;solution&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;solution&#39;)}">solution.R</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout" ng-click="activateLeftTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;console&#39;)}" class="ng-binding">R Console</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout &amp;&amp; plotTabShown" ng-click="activateLeftTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div code-editor="" control="editor" ng-show="isActiveLeftTab(&#39;usercode&#39;) || isActiveLeftTab(&#39;solution&#39;)" ng-model="userCode" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 45px; top: 0px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 255px; width: 41px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 32px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div><div class="ace_gutter-cell " style="height: 16px;">6</div><div class="ace_gutter-cell " style="height: 16px;">7</div><div class="ace_gutter-cell " style="height: 16px;">8</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 41px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 542px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:16px;top:0px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Plot the model loss of the training data</span></div></div><div class="ace_line_group" style="height:32px"><div class="ace_line" style="height:16px"><span class="ace_identifier">plot</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">history</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">metrics</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">loss</span>, <span class="ace_identifier">main</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"Model Loss"</span>, <span class="ace_identifier">xlab</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">"epoch"</span>, <span class="ace_identifier">ylab</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"loss"</span>, </div><div class="ace_line" style="height:16px"><span class="ace_identifier">col</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"blue"</span>, <span class="ace_identifier">type</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"l"</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Plot the model loss of the test data</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">lines</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">history</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">metrics</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">val_loss</span>, <span class="ace_identifier">col</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"green"</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Add legend</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">legend</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_string">"topright"</span>, <span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_string">"train"</span>,<span class="ace_string">"test"</span><span class="ace_paren ace_keyword ace_operator">)</span>, <span class="ace_identifier">col</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_string">"blue"</span>, <span class="ace_string">"green"</span><span class="ace_paren ace_keyword ace_operator">)</span>, <span class="ace_identifier">lty</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_constant ace_numeric">1</span>,<span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_keyword ace_operator">))</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="width: 22px; bottom: 0px; display: none;"><div class="ace_scrollbar-inner" style="width: 22px; height: 144px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 41px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 234px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div ng-show="isActiveLeftTab(&#39;console&#39;)" class="dcl-console-target dcl-console-mini-target ng-hide"><console class="dcl-console ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 18.075px; top: 0px;"></textarea><div class="ace_gutter" style="display: none;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px;"></div><div class="ace_gutter-active-line" style="display: none;"></div></div><div class="ace_scroller" style="left: 0px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 287px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_operator ace_keyword">&gt; </span><span class="ace_identifier"></span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 18.075px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 0px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 287px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></console></div><div ng-show="isActiveLeftTab(&#39;plots&#39;)" class="dcl-plots-mini-target ng-hide"><plots-container class="dcl-plots-container"><div class="dcl-plot"><img ng-show="plots.length &gt; 0" class="ng-hide"></div><div class="dcl-plot-actions"><button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="removePlot()" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-trash"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="previousPlot()" ng-disabled="plotIndex &lt;= 0" disabled="disabled"><i class="fa fa-chevron-left"></i></button> <span ng-show="plots.length &gt; 0" class="ng-binding ng-hide">1/0</span> <span ng-hide="plots.length &gt; 0">0/0</span> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="nextPlot()" ng-disabled="plotIndex &gt;= (plots.length - 1)" disabled="disabled"><i class="fa fa-chevron-right"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="expand(&#39;plot&#39;)" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-expand"></i></button></div></plots-container></div><div growl="" ng-show="!isActiveLeftTab(&#39;plots&#39;)" inline="true" limit-messages="1" sct-feedback="" class="sct-feedback-container ng-isolate-scope"><div class="growl-container bottom-left" ng-class="wrapperClasses()"><!-- ngRepeat: message in growlMessages.directives[referenceId].messages --></div></div></div></div><div ng-show="!useMiniLayout" class="dcl-right-pane clearfix ng-hide"><a class="dcl-github-link dcl-no-link-style" href="https://github.com/datacamp/datacamp-light" uib-tooltip="View DataCamp Light on Github" tooltip-placement="left" target="_blank"><div class="dcl-github-logo"></div></a><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;console&#39;)}" class="ng-binding dcl-active">R Console</a></li><li><a ng-show="plotTabShown" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div ng-show="isActiveRightTab(&#39;console&#39;)" control="console" class="dcl-console-target dcl-console-full-target"></div><div ng-show="isActiveRightTab(&#39;plots&#39;)" class="dcl-plots-full-target ng-hide"></div></div></div></div><div class="dcl-action-panel clearfix" exercise="exercise"><button ng-show="hasHint()" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showHint()" tooltip-placement="top" uib-tooltip="Get Hint">Hint</button> <button ng-show="solutionButtonShown" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showSolutionTab()" tooltip-placement="top" uib-tooltip="Show Solution">Solution</button> <button class="dcl-btn dcl-btn-primary dcl-btn-small" href="" ng-click="execute()" submit-disable="" tooltip-placement="top" uib-tooltip="Execute Code">Run</button><span class="dcl-app-status"><i class="fa fa-circle dcl-broken" ng-hide="isLoading" ng-class="{&#39;dcl-busy&#39;: isBusy, &#39;dcl-broken&#39;: isBroken}"></i> <i class="dcl-app-status-spinner fa fa-circle-o-notch fa-spin ng-hide" ng-show="isLoading"></i> <span class="dcl-app-status-text dcl-hide-xxs ng-binding" style="display: none;">Session Inactive</span></span></div></div></div>

<p><img src="./keras_ Deep Learning in R (article) - DataCamp_files/Model-Loss.png"></p>

<p>In this first plot, you plotted the loss of the model on the training and test data. Now it’s time to also do the same, but then for the accuracy of the model:</p>

<div data-encoded="true" data-height="300" class="datacamp-exercise ng-scope" style="height:300px;"><!--[if lt IE 10]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]--><div ng-controller="NormalExerciseController" class="ng-scope"><div class="dcl-exercise-area" resize-layout=""><div class="dcl-left-pane dcl-mini" ng-class="{&#39;dcl-mini&#39;: useMiniLayout}"><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;usercode&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;usercode&#39;)}" class="ng-binding dcl-active">script.R</a></li><li ng-show="solutionTabShown" class="ng-hide"><a class="dcl-animation--flash ng-binding" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;solution&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;solution&#39;)}">solution.R</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout" ng-click="activateLeftTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;console&#39;)}" class="ng-binding">R Console</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout &amp;&amp; plotTabShown" ng-click="activateLeftTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div code-editor="" control="editor" ng-show="isActiveLeftTab(&#39;usercode&#39;) || isActiveLeftTab(&#39;solution&#39;)" ng-model="userCode" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 45px; top: 0px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 271px; width: 41px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 32px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div><div class="ace_gutter-cell " style="height: 16px;">6</div><div class="ace_gutter-cell " style="height: 16px;">7</div><div class="ace_gutter-cell " style="height: 32px;">8</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 41px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 542px; height: 271px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:16px;top:0px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Plot the accuracy of the training data </span></div></div><div class="ace_line_group" style="height:32px"><div class="ace_line" style="height:16px"><span class="ace_identifier">plot</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">history</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">metrics</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">acc</span>, <span class="ace_identifier">main</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"Model Accuracy"</span>, <span class="ace_identifier">xlab</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">"epoch"</span>, <span class="ace_identifier">ylab</span></div><div class="ace_line" style="height:16px"><span class="ace_keyword ace_operator">=</span><span class="ace_string">"accuracy"</span>, <span class="ace_identifier">col</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"blue"</span>, <span class="ace_identifier">type</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"l"</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Plot the accuracy of the validation data</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">lines</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">history</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">metrics</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">val_acc</span>, <span class="ace_identifier">col</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"green"</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Add Legend</span></div></div><div class="ace_line_group" style="height:32px"><div class="ace_line" style="height:16px"><span class="ace_identifier">legend</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_string">"bottomright"</span>, <span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_string">"train"</span>,<span class="ace_string">"test"</span><span class="ace_paren ace_keyword ace_operator">)</span>, <span class="ace_identifier">col</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_string">"blue"</span>, <span class="ace_string">"green"</span><span class="ace_paren ace_keyword ace_operator">)</span>, <span class="ace_identifier">lty</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_constant ace_numeric">1</span>,<span class="ace_constant ace_numeric">1</span></div><div class="ace_line" style="height:16px"><span class="ace_paren ace_keyword ace_operator">))</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="width: 22px; bottom: 0px; display: none;"><div class="ace_scrollbar-inner" style="width: 22px; height: 160px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 41px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 234px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div ng-show="isActiveLeftTab(&#39;console&#39;)" class="dcl-console-target dcl-console-mini-target ng-hide"><console class="dcl-console ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 18.075px; top: 0px;"></textarea><div class="ace_gutter" style="display: none;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px;"></div><div class="ace_gutter-active-line" style="display: none;"></div></div><div class="ace_scroller" style="left: 0px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 287px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_operator ace_keyword">&gt; </span><span class="ace_identifier"></span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 18.075px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 0px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 287px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></console></div><div ng-show="isActiveLeftTab(&#39;plots&#39;)" class="dcl-plots-mini-target ng-hide"><plots-container class="dcl-plots-container"><div class="dcl-plot"><img ng-show="plots.length &gt; 0" class="ng-hide"></div><div class="dcl-plot-actions"><button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="removePlot()" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-trash"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="previousPlot()" ng-disabled="plotIndex &lt;= 0" disabled="disabled"><i class="fa fa-chevron-left"></i></button> <span ng-show="plots.length &gt; 0" class="ng-binding ng-hide">1/0</span> <span ng-hide="plots.length &gt; 0">0/0</span> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="nextPlot()" ng-disabled="plotIndex &gt;= (plots.length - 1)" disabled="disabled"><i class="fa fa-chevron-right"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="expand(&#39;plot&#39;)" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-expand"></i></button></div></plots-container></div><div growl="" ng-show="!isActiveLeftTab(&#39;plots&#39;)" inline="true" limit-messages="1" sct-feedback="" class="sct-feedback-container ng-isolate-scope"><div class="growl-container bottom-left" ng-class="wrapperClasses()"><!-- ngRepeat: message in growlMessages.directives[referenceId].messages --></div></div></div></div><div ng-show="!useMiniLayout" class="dcl-right-pane clearfix ng-hide"><a class="dcl-github-link dcl-no-link-style" href="https://github.com/datacamp/datacamp-light" uib-tooltip="View DataCamp Light on Github" tooltip-placement="left" target="_blank"><div class="dcl-github-logo"></div></a><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;console&#39;)}" class="ng-binding dcl-active">R Console</a></li><li><a ng-show="plotTabShown" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div ng-show="isActiveRightTab(&#39;console&#39;)" control="console" class="dcl-console-target dcl-console-full-target"></div><div ng-show="isActiveRightTab(&#39;plots&#39;)" class="dcl-plots-full-target ng-hide"></div></div></div></div><div class="dcl-action-panel clearfix" exercise="exercise"><button ng-show="hasHint()" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showHint()" tooltip-placement="top" uib-tooltip="Get Hint">Hint</button> <button ng-show="solutionButtonShown" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showSolutionTab()" tooltip-placement="top" uib-tooltip="Show Solution">Solution</button> <button class="dcl-btn dcl-btn-primary dcl-btn-small" href="" ng-click="execute()" submit-disable="" tooltip-placement="top" uib-tooltip="Execute Code">Run</button><span class="dcl-app-status"><i class="fa fa-circle dcl-broken" ng-hide="isLoading" ng-class="{&#39;dcl-busy&#39;: isBusy, &#39;dcl-broken&#39;: isBroken}"></i> <i class="dcl-app-status-spinner fa fa-circle-o-notch fa-spin ng-hide" ng-show="isLoading"></i> <span class="dcl-app-status-text dcl-hide-xxs ng-binding" style="display: none;">Session Inactive</span></span></div></div></div>

<p><img src="./keras_ Deep Learning in R (article) - DataCamp_files/Model-Accuracy.png"></p>

<p>Some things to keep in mind here are the following:</p>

<ul>
	<li>If your training data accuracy keeps improving while your validation data accuracy gets worse, you are probably overfitting: your model starts to just memorize the data instead of learning from it.</li>
	<li>If the trend for accuracy on both datasets is still rising for the last few epochs, you can clearly see that the model has not yet over-learned the training dataset.</li>
</ul>

<h2 id="predict">Predict Labels of New Data</h2>

<p>Now that your model is created, compiled and has been fitted to the data, it’s time to actually use your model to predict the labels for your test set <code>iris.test</code>. As you might have expected, you can use the <code>predict()</code> function to do this. After, you can print out the confusion matrix to check out the predictions and the real labels of the <code>iris.test</code> data with the help of the <code>table()</code> function.</p>

<div data-height="300" data-encoded="true" class="datacamp-exercise ng-scope" style="height:300px;"><!--[if lt IE 10]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]--><div ng-controller="NormalExerciseController" class="ng-scope"><div class="dcl-exercise-area" resize-layout=""><div class="dcl-left-pane dcl-mini" ng-class="{&#39;dcl-mini&#39;: useMiniLayout}"><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;usercode&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;usercode&#39;)}" class="ng-binding dcl-active">script.R</a></li><li ng-show="solutionTabShown" class="ng-hide"><a class="dcl-animation--flash ng-binding" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;solution&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;solution&#39;)}">solution.R</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout" ng-click="activateLeftTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;console&#39;)}" class="ng-binding">R Console</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout &amp;&amp; plotTabShown" ng-click="activateLeftTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div code-editor="" control="editor" ng-show="isActiveLeftTab(&#39;usercode&#39;) || isActiveLeftTab(&#39;solution&#39;)" ng-model="userCode" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 45px; top: 0px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 255px; width: 41px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 41px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 542px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:16px;top:0px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Predict the classes for the test data</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">classes</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">%&gt;%</span> <span class="ace_identifier">predict_classes</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">iris.test</span>, <span class="ace_identifier">batch_size</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">128</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Confusion matrix</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">table</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">iris.testtarget</span>, <span class="ace_identifier">classes</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 80px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 41px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 542px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div ng-show="isActiveLeftTab(&#39;console&#39;)" class="dcl-console-target dcl-console-mini-target ng-hide"><console class="dcl-console ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 18.075px; top: 0px;"></textarea><div class="ace_gutter" style="display: none;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px;"></div><div class="ace_gutter-active-line" style="display: none;"></div></div><div class="ace_scroller" style="left: 0px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 287px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_operator ace_keyword">&gt; </span><span class="ace_identifier"></span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 18.075px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 0px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 287px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></console></div><div ng-show="isActiveLeftTab(&#39;plots&#39;)" class="dcl-plots-mini-target ng-hide"><plots-container class="dcl-plots-container"><div class="dcl-plot"><img ng-show="plots.length &gt; 0" class="ng-hide"></div><div class="dcl-plot-actions"><button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="removePlot()" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-trash"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="previousPlot()" ng-disabled="plotIndex &lt;= 0" disabled="disabled"><i class="fa fa-chevron-left"></i></button> <span ng-show="plots.length &gt; 0" class="ng-binding ng-hide">1/0</span> <span ng-hide="plots.length &gt; 0">0/0</span> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="nextPlot()" ng-disabled="plotIndex &gt;= (plots.length - 1)" disabled="disabled"><i class="fa fa-chevron-right"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="expand(&#39;plot&#39;)" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-expand"></i></button></div></plots-container></div><div growl="" ng-show="!isActiveLeftTab(&#39;plots&#39;)" inline="true" limit-messages="1" sct-feedback="" class="sct-feedback-container ng-isolate-scope"><div class="growl-container bottom-left" ng-class="wrapperClasses()"><!-- ngRepeat: message in growlMessages.directives[referenceId].messages --></div></div></div></div><div ng-show="!useMiniLayout" class="dcl-right-pane clearfix ng-hide"><a class="dcl-github-link dcl-no-link-style" href="https://github.com/datacamp/datacamp-light" uib-tooltip="View DataCamp Light on Github" tooltip-placement="left" target="_blank"><div class="dcl-github-logo"></div></a><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;console&#39;)}" class="ng-binding dcl-active">R Console</a></li><li><a ng-show="plotTabShown" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div ng-show="isActiveRightTab(&#39;console&#39;)" control="console" class="dcl-console-target dcl-console-full-target"></div><div ng-show="isActiveRightTab(&#39;plots&#39;)" class="dcl-plots-full-target ng-hide"></div></div></div></div><div class="dcl-action-panel clearfix" exercise="exercise"><button ng-show="hasHint()" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showHint()" tooltip-placement="top" uib-tooltip="Get Hint">Hint</button> <button ng-show="solutionButtonShown" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showSolutionTab()" tooltip-placement="top" uib-tooltip="Show Solution">Solution</button> <button class="dcl-btn dcl-btn-primary dcl-btn-small" href="" ng-click="execute()" submit-disable="" tooltip-placement="top" uib-tooltip="Execute Code">Run</button><span class="dcl-app-status"><i class="fa fa-circle dcl-broken" ng-hide="isLoading" ng-class="{&#39;dcl-busy&#39;: isBusy, &#39;dcl-broken&#39;: isBroken}"></i> <i class="dcl-app-status-spinner fa fa-circle-o-notch fa-spin ng-hide" ng-show="isLoading"></i> <span class="dcl-app-status-text dcl-hide-xxs ng-binding" style="display: none;">Session Inactive</span></span></div></div></div>

<p>What do you think of the results? At first sight, does this model that you have created make the right predictions?</p>

<h2 id="evaluate">Evaluating Your Model</h2>

<p>Even though you already have a slight idea of how your model performed by looking at the predicted labels for <code>iris.test</code>, it’s still important that you take the time to evaluate your model. Use the <code>evaluate()</code> function to do this: pass in the test data <code>iris.test</code>, the test labels <code>iris.testLabels</code> and define the batch size. Store the result in a variable <code>score</code>, like in the code example below:</p>

<div data-encoded="true" data-height="300" class="datacamp-exercise ng-scope" style="height:300px;"><!--[if lt IE 10]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]--><div ng-controller="NormalExerciseController" class="ng-scope"><div class="dcl-exercise-area" resize-layout=""><div class="dcl-left-pane dcl-mini" ng-class="{&#39;dcl-mini&#39;: useMiniLayout}"><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;usercode&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;usercode&#39;)}" class="ng-binding dcl-active">script.R</a></li><li ng-show="solutionTabShown" class="ng-hide"><a class="dcl-animation--flash ng-binding" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;solution&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;solution&#39;)}">solution.R</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout" ng-click="activateLeftTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;console&#39;)}" class="ng-binding">R Console</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout &amp;&amp; plotTabShown" ng-click="activateLeftTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div code-editor="" control="editor" ng-show="isActiveLeftTab(&#39;usercode&#39;) || isActiveLeftTab(&#39;solution&#39;)" ng-model="userCode" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 45px; top: 0px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 255px; width: 41px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 41px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 542px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:16px;top:0px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Evaluate on test data and labels</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">score</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">%&gt;%</span> <span class="ace_identifier">evaluate</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">iris.test</span>, <span class="ace_identifier">iris.testLabels</span>, <span class="ace_identifier">batch_size</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">128</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Print the score</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">print</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">score</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 80px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 41px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 542px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div ng-show="isActiveLeftTab(&#39;console&#39;)" class="dcl-console-target dcl-console-mini-target ng-hide"><console class="dcl-console ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 18.075px; top: 0px;"></textarea><div class="ace_gutter" style="display: none;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px;"></div><div class="ace_gutter-active-line" style="display: none;"></div></div><div class="ace_scroller" style="left: 0px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 287px; height: 255px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_operator ace_keyword">&gt; </span><span class="ace_identifier"></span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 18.075px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 0px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 287px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></console></div><div ng-show="isActiveLeftTab(&#39;plots&#39;)" class="dcl-plots-mini-target ng-hide"><plots-container class="dcl-plots-container"><div class="dcl-plot"><img ng-show="plots.length &gt; 0" class="ng-hide"></div><div class="dcl-plot-actions"><button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="removePlot()" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-trash"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="previousPlot()" ng-disabled="plotIndex &lt;= 0" disabled="disabled"><i class="fa fa-chevron-left"></i></button> <span ng-show="plots.length &gt; 0" class="ng-binding ng-hide">1/0</span> <span ng-hide="plots.length &gt; 0">0/0</span> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="nextPlot()" ng-disabled="plotIndex &gt;= (plots.length - 1)" disabled="disabled"><i class="fa fa-chevron-right"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="expand(&#39;plot&#39;)" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-expand"></i></button></div></plots-container></div><div growl="" ng-show="!isActiveLeftTab(&#39;plots&#39;)" inline="true" limit-messages="1" sct-feedback="" class="sct-feedback-container ng-isolate-scope"><div class="growl-container bottom-left" ng-class="wrapperClasses()"><!-- ngRepeat: message in growlMessages.directives[referenceId].messages --></div></div></div></div><div ng-show="!useMiniLayout" class="dcl-right-pane clearfix ng-hide"><a class="dcl-github-link dcl-no-link-style" href="https://github.com/datacamp/datacamp-light" uib-tooltip="View DataCamp Light on Github" tooltip-placement="left" target="_blank"><div class="dcl-github-logo"></div></a><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;console&#39;)}" class="ng-binding dcl-active">R Console</a></li><li><a ng-show="plotTabShown" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div ng-show="isActiveRightTab(&#39;console&#39;)" control="console" class="dcl-console-target dcl-console-full-target"></div><div ng-show="isActiveRightTab(&#39;plots&#39;)" class="dcl-plots-full-target ng-hide"></div></div></div></div><div class="dcl-action-panel clearfix" exercise="exercise"><button ng-show="hasHint()" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showHint()" tooltip-placement="top" uib-tooltip="Get Hint">Hint</button> <button ng-show="solutionButtonShown" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showSolutionTab()" tooltip-placement="top" uib-tooltip="Show Solution">Solution</button> <button class="dcl-btn dcl-btn-primary dcl-btn-small" href="" ng-click="execute()" submit-disable="" tooltip-placement="top" uib-tooltip="Execute Code">Run</button><span class="dcl-app-status"><i class="fa fa-circle dcl-broken" ng-hide="isLoading" ng-class="{&#39;dcl-busy&#39;: isBusy, &#39;dcl-broken&#39;: isBroken}"></i> <i class="dcl-app-status-spinner fa fa-circle-o-notch fa-spin ng-hide" ng-show="isLoading"></i> <span class="dcl-app-status-text dcl-hide-xxs ng-binding" style="display: none;">Session Inactive</span></span></div></div></div>

<p>By printing <code>score</code>, you’ll get back the loss value and the metric value (in this case <code>'accuracy'</code>) back.</p>

<h2 id="finetune">Fine-tuning Your Model</h2>

<p>Fine-tuning your model is probably something that you’ll be doing a lot, especially in the beginning, because not all classification and regression problems are as straightforward as the one that you saw in the first part of this tutorial. As you read above, there are already two key decisions that you’ll probably want to adjust: how many layers you’re going to use and how many “hidden units” you will chose for each layer.</p>

<p>In the beginning, this will really be quite a journey.</p>

<p>Besides playing around with the number of epochs or the batch size, there are other ways in which you can tweak your model in the hopes that it will perform better: by adding layers, by increasing the number of hidden units and by passing your own optimization parameters to the <code>compile()</code> function. This section will go over these three options.</p>

<div class="section level3" id="adding-layers">
<h3>Adding Layers</h3>

<p>What would happen if you add another layer to your model? What if it would look like this?</p>

<div data-encoded="true" data-height="600" class="datacamp-exercise ng-scope" style="height:600px;"><!--[if lt IE 10]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]--><div ng-controller="NormalExerciseController" class="ng-scope"><div class="dcl-exercise-area" resize-layout=""><div class="dcl-left-pane dcl-mini" ng-class="{&#39;dcl-mini&#39;: useMiniLayout}"><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;usercode&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;usercode&#39;)}" class="ng-binding dcl-active">script.R</a></li><li ng-show="solutionTabShown" class="ng-hide"><a class="dcl-animation--flash ng-binding" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;solution&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;solution&#39;)}">solution.R</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout" ng-click="activateLeftTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;console&#39;)}" class="ng-binding">R Console</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout &amp;&amp; plotTabShown" ng-click="activateLeftTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div code-editor="" control="editor" ng-show="isActiveLeftTab(&#39;usercode&#39;) || isActiveLeftTab(&#39;solution&#39;)" ng-model="userCode" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 52px; top: 0px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 555px; width: 48px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div><div class="ace_gutter-cell " style="height: 16px;">6</div><div class="ace_gutter-cell " style="height: 16px;">7</div><div class="ace_gutter-cell " style="height: 16px;">8</div><div class="ace_gutter-cell " style="height: 16px;">9</div><div class="ace_gutter-cell " style="height: 16px;">10</div><div class="ace_gutter-cell " style="height: 16px;">11</div><div class="ace_gutter-cell " style="height: 16px;">12</div><div class="ace_gutter-cell " style="height: 16px;">13</div><div class="ace_gutter-cell " style="height: 16px;">14</div><div class="ace_gutter-cell " style="height: 16px;">15</div><div class="ace_gutter-cell " style="height: 16px;">16</div><div class="ace_gutter-cell " style="height: 16px;">17</div><div class="ace_gutter-cell " style="height: 16px;">18</div><div class="ace_gutter-cell " style="height: 16px;">19</div><div class="ace_gutter-cell " style="height: 16px;">20</div><div class="ace_gutter-cell " style="height: 16px;">21</div><div class="ace_gutter-cell " style="height: 16px;">22</div><div class="ace_gutter-cell " style="height: 16px;">23</div><div class="ace_gutter-cell " style="height: 16px;">24</div><div class="ace_gutter-cell " style="height: 16px;">25</div><div class="ace_gutter-cell " style="height: 16px;">26</div><div class="ace_gutter-cell " style="height: 16px;">27</div><div class="ace_gutter-cell " style="height: 16px;">28</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 48px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 535px; height: 555px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:16px;top:0px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Initialize the sequential model</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">keras_model_sequential</span><span class="ace_paren ace_keyword ace_operator">()</span> </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Add layers to model</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">%&gt;%</span> </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">    <span class="ace_identifier">layer_dense</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">units</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">8</span>, <span class="ace_identifier">activation</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'relu'</span>, <span class="ace_identifier">input_shape</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_constant ace_numeric">4</span><span class="ace_paren ace_keyword ace_operator">))</span> <span class="ace_keyword ace_operator">%&gt;%</span> </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">    <span class="ace_identifier">layer_dense</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">units</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">5</span>, <span class="ace_identifier">activation</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'relu'</span><span class="ace_paren ace_keyword ace_operator">)</span> <span class="ace_keyword ace_operator">%&gt;%</span> </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">    <span class="ace_identifier">layer_dense</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">units</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">3</span>, <span class="ace_identifier">activation</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'softmax'</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Compile the model</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">%&gt;%</span> <span class="ace_identifier">compile</span><span class="ace_paren ace_keyword ace_operator">(</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">loss</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'categorical_crossentropy'</span>,</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">optimizer</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'adam'</span>,</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">metrics</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'accuracy'</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"> <span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Fit the model to the data</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">%&gt;%</span> <span class="ace_identifier">fit</span><span class="ace_paren ace_keyword ace_operator">(</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">iris.training</span>, <span class="ace_identifier">iris.trainLabels</span>, </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">epochs</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">200</span>, <span class="ace_identifier">batch_size</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">5</span>, </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">validation_split</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">0.2</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"> <span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Evaluate the model</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">score</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">%&gt;%</span> <span class="ace_identifier">evaluate</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">iris.test</span>, <span class="ace_identifier">iris.testLabels</span>, <span class="ace_identifier">batch_size</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">128</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Print the score</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">print</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">score</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="width: 22px; bottom: 0px; display: none;"><div class="ace_scrollbar-inner" style="width: 22px; height: 448px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 48px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 234px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div ng-show="isActiveLeftTab(&#39;console&#39;)" class="dcl-console-target dcl-console-mini-target ng-hide"><console class="dcl-console ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 18.075px; top: 0px;"></textarea><div class="ace_gutter" style="display: none;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px;"></div><div class="ace_gutter-active-line" style="display: none;"></div></div><div class="ace_scroller" style="left: 0px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 287px; height: 555px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_operator ace_keyword">&gt; </span><span class="ace_identifier"></span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 18.075px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 0px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 287px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></console></div><div ng-show="isActiveLeftTab(&#39;plots&#39;)" class="dcl-plots-mini-target ng-hide"><plots-container class="dcl-plots-container"><div class="dcl-plot"><img ng-show="plots.length &gt; 0" class="ng-hide"></div><div class="dcl-plot-actions"><button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="removePlot()" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-trash"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="previousPlot()" ng-disabled="plotIndex &lt;= 0" disabled="disabled"><i class="fa fa-chevron-left"></i></button> <span ng-show="plots.length &gt; 0" class="ng-binding ng-hide">1/0</span> <span ng-hide="plots.length &gt; 0">0/0</span> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="nextPlot()" ng-disabled="plotIndex &gt;= (plots.length - 1)" disabled="disabled"><i class="fa fa-chevron-right"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="expand(&#39;plot&#39;)" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-expand"></i></button></div></plots-container></div><div growl="" ng-show="!isActiveLeftTab(&#39;plots&#39;)" inline="true" limit-messages="1" sct-feedback="" class="sct-feedback-container ng-isolate-scope"><div class="growl-container bottom-left" ng-class="wrapperClasses()"><!-- ngRepeat: message in growlMessages.directives[referenceId].messages --></div></div></div></div><div ng-show="!useMiniLayout" class="dcl-right-pane clearfix ng-hide"><a class="dcl-github-link dcl-no-link-style" href="https://github.com/datacamp/datacamp-light" uib-tooltip="View DataCamp Light on Github" tooltip-placement="left" target="_blank"><div class="dcl-github-logo"></div></a><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;console&#39;)}" class="ng-binding dcl-active">R Console</a></li><li><a ng-show="plotTabShown" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div ng-show="isActiveRightTab(&#39;console&#39;)" control="console" class="dcl-console-target dcl-console-full-target"></div><div ng-show="isActiveRightTab(&#39;plots&#39;)" class="dcl-plots-full-target ng-hide"></div></div></div></div><div class="dcl-action-panel clearfix" exercise="exercise"><button ng-show="hasHint()" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showHint()" tooltip-placement="top" uib-tooltip="Get Hint">Hint</button> <button ng-show="solutionButtonShown" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showSolutionTab()" tooltip-placement="top" uib-tooltip="Show Solution">Solution</button> <button class="dcl-btn dcl-btn-primary dcl-btn-small" href="" ng-click="execute()" submit-disable="" tooltip-placement="top" uib-tooltip="Execute Code">Run</button><span class="dcl-app-status"><i class="fa fa-circle dcl-broken" ng-hide="isLoading" ng-class="{&#39;dcl-busy&#39;: isBusy, &#39;dcl-broken&#39;: isBroken}"></i> <i class="dcl-app-status-spinner fa fa-circle-o-notch fa-spin ng-hide" ng-show="isLoading"></i> <span class="dcl-app-status-text dcl-hide-xxs ng-binding" style="display: none;">Session Inactive</span></span></div></div></div>

<p><strong>Note</strong> that you can also visualize the loss and accuracy metrics of this new model! Try this out in the DataCamp Light chunk below:</p>

<div data-encoded="true" data-height="800" class="datacamp-exercise ng-scope" style="height:800px;"><!--[if lt IE 10]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]--><div ng-controller="NormalExerciseController" class="ng-scope"><div class="dcl-exercise-area" resize-layout=""><div class="dcl-left-pane dcl-mini" ng-class="{&#39;dcl-mini&#39;: useMiniLayout}"><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;usercode&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;usercode&#39;)}" class="ng-binding dcl-active">script.R</a></li><li ng-show="solutionTabShown" class="ng-hide"><a class="dcl-animation--flash ng-binding" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;solution&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;solution&#39;)}">solution.R</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout" ng-click="activateLeftTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;console&#39;)}" class="ng-binding">R Console</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout &amp;&amp; plotTabShown" ng-click="activateLeftTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div code-editor="" control="editor" ng-show="isActiveLeftTab(&#39;usercode&#39;) || isActiveLeftTab(&#39;solution&#39;)" ng-model="userCode" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 52px; top: 0px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 771px; width: 48px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div><div class="ace_gutter-cell " style="height: 16px;">6</div><div class="ace_gutter-cell " style="height: 16px;">7</div><div class="ace_gutter-cell " style="height: 16px;">8</div><div class="ace_gutter-cell " style="height: 16px;">9</div><div class="ace_gutter-cell " style="height: 16px;">10</div><div class="ace_gutter-cell " style="height: 16px;">11</div><div class="ace_gutter-cell " style="height: 16px;">12</div><div class="ace_gutter-cell " style="height: 16px;">13</div><div class="ace_gutter-cell " style="height: 16px;">14</div><div class="ace_gutter-cell " style="height: 16px;">15</div><div class="ace_gutter-cell " style="height: 16px;">16</div><div class="ace_gutter-cell " style="height: 16px;">17</div><div class="ace_gutter-cell " style="height: 16px;">18</div><div class="ace_gutter-cell " style="height: 16px;">19</div><div class="ace_gutter-cell " style="height: 16px;">20</div><div class="ace_gutter-cell " style="height: 16px;">21</div><div class="ace_gutter-cell " style="height: 16px;">22</div><div class="ace_gutter-cell " style="height: 16px;">23</div><div class="ace_gutter-cell " style="height: 16px;">24</div><div class="ace_gutter-cell " style="height: 32px;">25</div><div class="ace_gutter-cell " style="height: 16px;">26</div><div class="ace_gutter-cell " style="height: 16px;">27</div><div class="ace_gutter-cell " style="height: 16px;">28</div><div class="ace_gutter-cell " style="height: 16px;">29</div><div class="ace_gutter-cell " style="height: 32px;">30</div><div class="ace_gutter-cell " style="height: 16px;">31</div><div class="ace_gutter-cell " style="height: 32px;">32</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 48px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 535px; height: 771px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:16px;top:0px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Initialize a sequential model</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">keras_model_sequential</span><span class="ace_paren ace_keyword ace_operator">()</span> </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Add layers to the model</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">%&gt;%</span> </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">    <span class="ace_identifier">layer_dense</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">units</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">8</span>, <span class="ace_identifier">activation</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'relu'</span>, <span class="ace_identifier">input_shape</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_constant ace_numeric">4</span><span class="ace_paren ace_keyword ace_operator">))</span> <span class="ace_keyword ace_operator">%&gt;%</span> </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">    <span class="ace_identifier">layer_dense</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">units</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">5</span>, <span class="ace_identifier">activation</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'relu'</span><span class="ace_paren ace_keyword ace_operator">)</span> <span class="ace_keyword ace_operator">%&gt;%</span> </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">    <span class="ace_identifier">layer_dense</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">units</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">3</span>, <span class="ace_identifier">activation</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'softmax'</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Compile the model</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">%&gt;%</span> <span class="ace_identifier">compile</span><span class="ace_paren ace_keyword ace_operator">(</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">loss</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'categorical_crossentropy'</span>,</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">optimizer</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'adam'</span>,</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">metrics</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'accuracy'</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"> <span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Save the training history in history</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">history</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">%&gt;%</span> <span class="ace_identifier">fit</span><span class="ace_paren ace_keyword ace_operator">(</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">  <span class="ace_identifier">iris.training</span>, <span class="ace_identifier">iris.trainLabels</span>, </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">  <span class="ace_identifier">epochs</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">200</span>, <span class="ace_identifier">batch_size</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">5</span>,</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">  <span class="ace_identifier">validation_split</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">0.2</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"> <span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Plot the model loss</span></div></div><div class="ace_line_group" style="height:32px"><div class="ace_line" style="height:16px"><span class="ace_identifier">plot</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">history</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">metrics</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">loss</span>, <span class="ace_identifier">main</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"Model Loss"</span>, <span class="ace_identifier">xlab</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">"epoch"</span>, <span class="ace_identifier">ylab</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"loss"</span>, </div><div class="ace_line" style="height:16px"><span class="ace_identifier">col</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"blue"</span>, <span class="ace_identifier">type</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"l"</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">lines</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">history</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">metrics</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">val_loss</span>, <span class="ace_identifier">col</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"green"</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">legend</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_string">"topright"</span>, <span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_string">"train"</span>,<span class="ace_string">"test"</span><span class="ace_paren ace_keyword ace_operator">)</span>, <span class="ace_identifier">col</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_string">"blue"</span>, <span class="ace_string">"green"</span><span class="ace_paren ace_keyword ace_operator">)</span>, <span class="ace_identifier">lty</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_constant ace_numeric">1</span>,<span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_keyword ace_operator">))</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Plot the model accuracy</span></div></div><div class="ace_line_group" style="height:32px"><div class="ace_line" style="height:16px"><span class="ace_identifier">plot</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">history</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">metrics</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">acc</span>, <span class="ace_identifier">main</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"Model Accuracy"</span>, <span class="ace_identifier">xlab</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">"epoch"</span>, <span class="ace_identifier">ylab</span></div><div class="ace_line" style="height:16px"><span class="ace_keyword ace_operator">=</span><span class="ace_string">"accuracy"</span>, <span class="ace_identifier">col</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"blue"</span>, <span class="ace_identifier">type</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"l"</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">lines</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">history</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">metrics</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">val_acc</span>, <span class="ace_identifier">col</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"green"</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:32px"><div class="ace_line" style="height:16px"><span class="ace_identifier">legend</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_string">"bottomright"</span>, <span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_string">"train"</span>,<span class="ace_string">"test"</span><span class="ace_paren ace_keyword ace_operator">)</span>, <span class="ace_identifier">col</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_string">"blue"</span>, <span class="ace_string">"green"</span><span class="ace_paren ace_keyword ace_operator">)</span>, <span class="ace_identifier">lty</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_constant ace_numeric">1</span>,<span class="ace_constant ace_numeric">1</span></div><div class="ace_line" style="height:16px"><span class="ace_paren ace_keyword ace_operator">))</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="width: 22px; bottom: 0px; display: none;"><div class="ace_scrollbar-inner" style="width: 22px; height: 560px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 48px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 234px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div ng-show="isActiveLeftTab(&#39;console&#39;)" class="dcl-console-target dcl-console-mini-target ng-hide"><console class="dcl-console ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 18.075px; top: 0px;"></textarea><div class="ace_gutter" style="display: none;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px;"></div><div class="ace_gutter-active-line" style="display: none;"></div></div><div class="ace_scroller" style="left: 0px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 287px; height: 755px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_operator ace_keyword">&gt; </span><span class="ace_identifier"></span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 18.075px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 0px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 287px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></console></div><div ng-show="isActiveLeftTab(&#39;plots&#39;)" class="dcl-plots-mini-target ng-hide"><plots-container class="dcl-plots-container"><div class="dcl-plot"><img ng-show="plots.length &gt; 0" class="ng-hide"></div><div class="dcl-plot-actions"><button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="removePlot()" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-trash"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="previousPlot()" ng-disabled="plotIndex &lt;= 0" disabled="disabled"><i class="fa fa-chevron-left"></i></button> <span ng-show="plots.length &gt; 0" class="ng-binding ng-hide">1/0</span> <span ng-hide="plots.length &gt; 0">0/0</span> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="nextPlot()" ng-disabled="plotIndex &gt;= (plots.length - 1)" disabled="disabled"><i class="fa fa-chevron-right"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="expand(&#39;plot&#39;)" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-expand"></i></button></div></plots-container></div><div growl="" ng-show="!isActiveLeftTab(&#39;plots&#39;)" inline="true" limit-messages="1" sct-feedback="" class="sct-feedback-container ng-isolate-scope"><div class="growl-container bottom-left" ng-class="wrapperClasses()"><!-- ngRepeat: message in growlMessages.directives[referenceId].messages --></div></div></div></div><div ng-show="!useMiniLayout" class="dcl-right-pane clearfix ng-hide"><a class="dcl-github-link dcl-no-link-style" href="https://github.com/datacamp/datacamp-light" uib-tooltip="View DataCamp Light on Github" tooltip-placement="left" target="_blank"><div class="dcl-github-logo"></div></a><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;console&#39;)}" class="ng-binding dcl-active">R Console</a></li><li><a ng-show="plotTabShown" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div ng-show="isActiveRightTab(&#39;console&#39;)" control="console" class="dcl-console-target dcl-console-full-target"></div><div ng-show="isActiveRightTab(&#39;plots&#39;)" class="dcl-plots-full-target ng-hide"></div></div></div></div><div class="dcl-action-panel clearfix" exercise="exercise"><button ng-show="hasHint()" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showHint()" tooltip-placement="top" uib-tooltip="Get Hint">Hint</button> <button ng-show="solutionButtonShown" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showSolutionTab()" tooltip-placement="top" uib-tooltip="Show Solution">Solution</button> <button class="dcl-btn dcl-btn-primary dcl-btn-small" href="" ng-click="execute()" submit-disable="" tooltip-placement="top" uib-tooltip="Execute Code">Run</button><span class="dcl-app-status"><i class="fa fa-circle dcl-broken" ng-hide="isLoading" ng-class="{&#39;dcl-busy&#39;: isBusy, &#39;dcl-broken&#39;: isBroken}"></i> <i class="dcl-app-status-spinner fa fa-circle-o-notch fa-spin ng-hide" ng-show="isLoading"></i> <span class="dcl-app-status-text dcl-hide-xxs ng-binding" style="display: none;">Session Inactive</span></span></div></div></div>

<table align="center" border="0" cellpadding="1" cellspacing="1" style="width: 800px;">
	<tbody>
		<tr>
			<td align="center">
			<p><img alt="deep learning model layers" src="./keras_ Deep Learning in R (article) - DataCamp_files/Modelfinetune-1a.png" style="width: 430px; height: 304px;"></p>
			</td>
			<td align="center">
			<p><img alt="Keras Layers model" src="./keras_ Deep Learning in R (article) - DataCamp_files/Modelfinetune-1b.png" style="width: 430px; height: 304px;"></p>
			</td>
		</tr>
	</tbody>
</table>
</div>

<div class="section level3" id="hidden-units">
<h3>Hidden Units</h3>

<p>Also try out the effect of adding more hidden units to your model’s architecture and study the effect on the evaluation, just like this:</p>

<div data-encoded="true" data-height="600" class="datacamp-exercise ng-scope" style="height:600px;"><!--[if lt IE 10]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]--><div ng-controller="NormalExerciseController" class="ng-scope"><div class="dcl-exercise-area" resize-layout=""><div class="dcl-left-pane dcl-mini" ng-class="{&#39;dcl-mini&#39;: useMiniLayout}"><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;usercode&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;usercode&#39;)}" class="ng-binding dcl-active">script.R</a></li><li ng-show="solutionTabShown" class="ng-hide"><a class="dcl-animation--flash ng-binding" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;solution&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;solution&#39;)}">solution.R</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout" ng-click="activateLeftTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;console&#39;)}" class="ng-binding">R Console</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout &amp;&amp; plotTabShown" ng-click="activateLeftTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div code-editor="" control="editor" ng-show="isActiveLeftTab(&#39;usercode&#39;) || isActiveLeftTab(&#39;solution&#39;)" ng-model="userCode" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 52px; top: 0px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 555px; width: 48px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div><div class="ace_gutter-cell " style="height: 16px;">6</div><div class="ace_gutter-cell " style="height: 16px;">7</div><div class="ace_gutter-cell " style="height: 16px;">8</div><div class="ace_gutter-cell " style="height: 16px;">9</div><div class="ace_gutter-cell " style="height: 16px;">10</div><div class="ace_gutter-cell " style="height: 16px;">11</div><div class="ace_gutter-cell " style="height: 16px;">12</div><div class="ace_gutter-cell " style="height: 16px;">13</div><div class="ace_gutter-cell " style="height: 16px;">14</div><div class="ace_gutter-cell " style="height: 16px;">15</div><div class="ace_gutter-cell " style="height: 16px;">16</div><div class="ace_gutter-cell " style="height: 16px;">17</div><div class="ace_gutter-cell " style="height: 16px;">18</div><div class="ace_gutter-cell " style="height: 16px;">19</div><div class="ace_gutter-cell " style="height: 16px;">20</div><div class="ace_gutter-cell " style="height: 16px;">21</div><div class="ace_gutter-cell " style="height: 16px;">22</div><div class="ace_gutter-cell " style="height: 16px;">23</div><div class="ace_gutter-cell " style="height: 16px;">24</div><div class="ace_gutter-cell " style="height: 16px;">25</div><div class="ace_gutter-cell " style="height: 16px;">26</div><div class="ace_gutter-cell " style="height: 16px;">27</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 48px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 535px; height: 555px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:16px;top:0px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Initialize a sequential model</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">keras_model_sequential</span><span class="ace_paren ace_keyword ace_operator">()</span> </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Add layers to the model</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">%&gt;%</span> </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">    <span class="ace_identifier">layer_dense</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">units</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">28</span>, <span class="ace_identifier">activation</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'relu'</span>, <span class="ace_identifier">input_shape</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_constant ace_numeric">4</span><span class="ace_paren ace_keyword ace_operator">))</span> <span class="ace_keyword ace_operator">%&gt;%</span> </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">    <span class="ace_identifier">layer_dense</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">units</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">3</span>, <span class="ace_identifier">activation</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'softmax'</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Compile the model</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">%&gt;%</span> <span class="ace_identifier">compile</span><span class="ace_paren ace_keyword ace_operator">(</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">loss</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'categorical_crossentropy'</span>,</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">optimizer</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'adam'</span>,</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">metrics</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'accuracy'</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"> <span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Fit the model to the data</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">%&gt;%</span> <span class="ace_identifier">fit</span><span class="ace_paren ace_keyword ace_operator">(</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">iris.training</span>, <span class="ace_identifier">iris.trainLabels</span>, </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">epochs</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">200</span>, <span class="ace_identifier">batch_size</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">5</span>, </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">validation_split</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">0.2</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"> <span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Evaluate the model</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">score</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">%&gt;%</span> <span class="ace_identifier">evaluate</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">iris.test</span>, <span class="ace_identifier">iris.testLabels</span>, <span class="ace_identifier">batch_size</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">128</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Print the score</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">print</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">score</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="width: 22px; bottom: 0px; display: none;"><div class="ace_scrollbar-inner" style="width: 22px; height: 432px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 48px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 234px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div ng-show="isActiveLeftTab(&#39;console&#39;)" class="dcl-console-target dcl-console-mini-target ng-hide"><console class="dcl-console ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 18.075px; top: 0px;"></textarea><div class="ace_gutter" style="display: none;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px;"></div><div class="ace_gutter-active-line" style="display: none;"></div></div><div class="ace_scroller" style="left: 0px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 287px; height: 555px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_operator ace_keyword">&gt; </span><span class="ace_identifier"></span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 18.075px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 0px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 287px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></console></div><div ng-show="isActiveLeftTab(&#39;plots&#39;)" class="dcl-plots-mini-target ng-hide"><plots-container class="dcl-plots-container"><div class="dcl-plot"><img ng-show="plots.length &gt; 0" class="ng-hide"></div><div class="dcl-plot-actions"><button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="removePlot()" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-trash"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="previousPlot()" ng-disabled="plotIndex &lt;= 0" disabled="disabled"><i class="fa fa-chevron-left"></i></button> <span ng-show="plots.length &gt; 0" class="ng-binding ng-hide">1/0</span> <span ng-hide="plots.length &gt; 0">0/0</span> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="nextPlot()" ng-disabled="plotIndex &gt;= (plots.length - 1)" disabled="disabled"><i class="fa fa-chevron-right"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="expand(&#39;plot&#39;)" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-expand"></i></button></div></plots-container></div><div growl="" ng-show="!isActiveLeftTab(&#39;plots&#39;)" inline="true" limit-messages="1" sct-feedback="" class="sct-feedback-container ng-isolate-scope"><div class="growl-container bottom-left" ng-class="wrapperClasses()"><!-- ngRepeat: message in growlMessages.directives[referenceId].messages --></div></div></div></div><div ng-show="!useMiniLayout" class="dcl-right-pane clearfix ng-hide"><a class="dcl-github-link dcl-no-link-style" href="https://github.com/datacamp/datacamp-light" uib-tooltip="View DataCamp Light on Github" tooltip-placement="left" target="_blank"><div class="dcl-github-logo"></div></a><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;console&#39;)}" class="ng-binding dcl-active">R Console</a></li><li><a ng-show="plotTabShown" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div ng-show="isActiveRightTab(&#39;console&#39;)" control="console" class="dcl-console-target dcl-console-full-target"></div><div ng-show="isActiveRightTab(&#39;plots&#39;)" class="dcl-plots-full-target ng-hide"></div></div></div></div><div class="dcl-action-panel clearfix" exercise="exercise"><button ng-show="hasHint()" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showHint()" tooltip-placement="top" uib-tooltip="Get Hint">Hint</button> <button ng-show="solutionButtonShown" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showSolutionTab()" tooltip-placement="top" uib-tooltip="Show Solution">Solution</button> <button class="dcl-btn dcl-btn-primary dcl-btn-small" href="" ng-click="execute()" submit-disable="" tooltip-placement="top" uib-tooltip="Execute Code">Run</button><span class="dcl-app-status"><i class="fa fa-circle dcl-broken" ng-hide="isLoading" ng-class="{&#39;dcl-busy&#39;: isBusy, &#39;dcl-broken&#39;: isBroken}"></i> <i class="dcl-app-status-spinner fa fa-circle-o-notch fa-spin ng-hide" ng-show="isLoading"></i> <span class="dcl-app-status-text dcl-hide-xxs ng-binding" style="display: none;">Session Inactive</span></span></div></div></div>

<p>Note that, in general, this is not always the best optimilization because, if you don’t have a ton of data, the overfitting can and will be worse. That’s why you should try use a small network with small datasets as this one.</p>

<p>Why don’t you try visualizing the effect of the addition of the hidden nodes in your model? Try it out below:</p>

<div data-encoded="true" data-height="800" class="datacamp-exercise ng-scope" style="height:800px;"><!--[if lt IE 10]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]--><div ng-controller="NormalExerciseController" class="ng-scope"><div class="dcl-exercise-area" resize-layout=""><div class="dcl-left-pane dcl-mini" ng-class="{&#39;dcl-mini&#39;: useMiniLayout}"><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;usercode&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;usercode&#39;)}" class="ng-binding dcl-active">script.R</a></li><li ng-show="solutionTabShown" class="ng-hide"><a class="dcl-animation--flash ng-binding" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;solution&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;solution&#39;)}">solution.R</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout" ng-click="activateLeftTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;console&#39;)}" class="ng-binding">R Console</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout &amp;&amp; plotTabShown" ng-click="activateLeftTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div code-editor="" control="editor" ng-show="isActiveLeftTab(&#39;usercode&#39;) || isActiveLeftTab(&#39;solution&#39;)" ng-model="userCode" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 52px; top: 0px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 771px; width: 48px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div><div class="ace_gutter-cell " style="height: 16px;">6</div><div class="ace_gutter-cell " style="height: 16px;">7</div><div class="ace_gutter-cell " style="height: 16px;">8</div><div class="ace_gutter-cell " style="height: 16px;">9</div><div class="ace_gutter-cell " style="height: 16px;">10</div><div class="ace_gutter-cell " style="height: 16px;">11</div><div class="ace_gutter-cell " style="height: 16px;">12</div><div class="ace_gutter-cell " style="height: 16px;">13</div><div class="ace_gutter-cell " style="height: 16px;">14</div><div class="ace_gutter-cell " style="height: 16px;">15</div><div class="ace_gutter-cell " style="height: 16px;">16</div><div class="ace_gutter-cell " style="height: 16px;">17</div><div class="ace_gutter-cell " style="height: 16px;">18</div><div class="ace_gutter-cell " style="height: 16px;">19</div><div class="ace_gutter-cell " style="height: 16px;">20</div><div class="ace_gutter-cell " style="height: 16px;">21</div><div class="ace_gutter-cell " style="height: 16px;">22</div><div class="ace_gutter-cell " style="height: 16px;">23</div><div class="ace_gutter-cell " style="height: 32px;">24</div><div class="ace_gutter-cell " style="height: 16px;">25</div><div class="ace_gutter-cell " style="height: 16px;">26</div><div class="ace_gutter-cell " style="height: 16px;">27</div><div class="ace_gutter-cell " style="height: 16px;">28</div><div class="ace_gutter-cell " style="height: 32px;">29</div><div class="ace_gutter-cell " style="height: 16px;">30</div><div class="ace_gutter-cell " style="height: 32px;">31</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 48px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 535px; height: 771px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:16px;top:0px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Initialize the sequential model</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">keras_model_sequential</span><span class="ace_paren ace_keyword ace_operator">()</span> </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Add layers to the model</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">%&gt;%</span> </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">    <span class="ace_identifier">layer_dense</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">units</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">28</span>, <span class="ace_identifier">activation</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'relu'</span>, <span class="ace_identifier">input_shape</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_constant ace_numeric">4</span><span class="ace_paren ace_keyword ace_operator">))</span> <span class="ace_keyword ace_operator">%&gt;%</span> </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">    <span class="ace_identifier">layer_dense</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">units</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">3</span>, <span class="ace_identifier">activation</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'softmax'</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Compile the model</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">%&gt;%</span> <span class="ace_identifier">compile</span><span class="ace_paren ace_keyword ace_operator">(</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">loss</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'categorical_crossentropy'</span>,</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">optimizer</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'adam'</span>,</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">metrics</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'accuracy'</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"> <span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Save the training history in the history variable</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">history</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">%&gt;%</span> <span class="ace_identifier">fit</span><span class="ace_paren ace_keyword ace_operator">(</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">  <span class="ace_identifier">iris.training</span>, <span class="ace_identifier">iris.trainLabels</span>, </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">  <span class="ace_identifier">epochs</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">200</span>, <span class="ace_identifier">batch_size</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">5</span>, </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">  <span class="ace_identifier">validation_split</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">0.2</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"> <span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Plot the model loss</span></div></div><div class="ace_line_group" style="height:32px"><div class="ace_line" style="height:16px"><span class="ace_identifier">plot</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">history</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">metrics</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">loss</span>, <span class="ace_identifier">main</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"Model Loss"</span>, <span class="ace_identifier">xlab</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">"epoch"</span>, <span class="ace_identifier">ylab</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"loss"</span>, </div><div class="ace_line" style="height:16px"><span class="ace_identifier">col</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"blue"</span>, <span class="ace_identifier">type</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"l"</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">lines</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">history</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">metrics</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">val_loss</span>, <span class="ace_identifier">col</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"green"</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">legend</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_string">"topright"</span>, <span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_string">"train"</span>,<span class="ace_string">"test"</span><span class="ace_paren ace_keyword ace_operator">)</span>, <span class="ace_identifier">col</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_string">"blue"</span>, <span class="ace_string">"green"</span><span class="ace_paren ace_keyword ace_operator">)</span>, <span class="ace_identifier">lty</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_constant ace_numeric">1</span>,<span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_keyword ace_operator">))</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Plot the model accuracy</span></div></div><div class="ace_line_group" style="height:32px"><div class="ace_line" style="height:16px"><span class="ace_identifier">plot</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">history</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">metrics</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">acc</span>, <span class="ace_identifier">main</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"Model Accuracy"</span>, <span class="ace_identifier">xlab</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">"epoch"</span>, <span class="ace_identifier">ylab</span></div><div class="ace_line" style="height:16px"><span class="ace_keyword ace_operator">=</span><span class="ace_string">"accuracy"</span>, <span class="ace_identifier">col</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"blue"</span>, <span class="ace_identifier">type</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"l"</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">lines</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">history</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">metrics</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">val_acc</span>, <span class="ace_identifier">col</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"green"</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:32px"><div class="ace_line" style="height:16px"><span class="ace_identifier">legend</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_string">"bottomright"</span>, <span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_string">"train"</span>,<span class="ace_string">"test"</span><span class="ace_paren ace_keyword ace_operator">)</span>, <span class="ace_identifier">col</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_string">"blue"</span>, <span class="ace_string">"green"</span><span class="ace_paren ace_keyword ace_operator">)</span>, <span class="ace_identifier">lty</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_constant ace_numeric">1</span>,<span class="ace_constant ace_numeric">1</span></div><div class="ace_line" style="height:16px"><span class="ace_paren ace_keyword ace_operator">))</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="width: 22px; bottom: 0px; display: none;"><div class="ace_scrollbar-inner" style="width: 22px; height: 544px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 48px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 234px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div ng-show="isActiveLeftTab(&#39;console&#39;)" class="dcl-console-target dcl-console-mini-target ng-hide"><console class="dcl-console ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 18.075px; top: 0px;"></textarea><div class="ace_gutter" style="display: none;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px;"></div><div class="ace_gutter-active-line" style="display: none;"></div></div><div class="ace_scroller" style="left: 0px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 287px; height: 755px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_operator ace_keyword">&gt; </span><span class="ace_identifier"></span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 18.075px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 0px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 287px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></console></div><div ng-show="isActiveLeftTab(&#39;plots&#39;)" class="dcl-plots-mini-target ng-hide"><plots-container class="dcl-plots-container"><div class="dcl-plot"><img ng-show="plots.length &gt; 0" class="ng-hide"></div><div class="dcl-plot-actions"><button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="removePlot()" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-trash"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="previousPlot()" ng-disabled="plotIndex &lt;= 0" disabled="disabled"><i class="fa fa-chevron-left"></i></button> <span ng-show="plots.length &gt; 0" class="ng-binding ng-hide">1/0</span> <span ng-hide="plots.length &gt; 0">0/0</span> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="nextPlot()" ng-disabled="plotIndex &gt;= (plots.length - 1)" disabled="disabled"><i class="fa fa-chevron-right"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="expand(&#39;plot&#39;)" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-expand"></i></button></div></plots-container></div><div growl="" ng-show="!isActiveLeftTab(&#39;plots&#39;)" inline="true" limit-messages="1" sct-feedback="" class="sct-feedback-container ng-isolate-scope"><div class="growl-container bottom-left" ng-class="wrapperClasses()"><!-- ngRepeat: message in growlMessages.directives[referenceId].messages --></div></div></div></div><div ng-show="!useMiniLayout" class="dcl-right-pane clearfix ng-hide"><a class="dcl-github-link dcl-no-link-style" href="https://github.com/datacamp/datacamp-light" uib-tooltip="View DataCamp Light on Github" tooltip-placement="left" target="_blank"><div class="dcl-github-logo"></div></a><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;console&#39;)}" class="ng-binding dcl-active">R Console</a></li><li><a ng-show="plotTabShown" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div ng-show="isActiveRightTab(&#39;console&#39;)" control="console" class="dcl-console-target dcl-console-full-target"></div><div ng-show="isActiveRightTab(&#39;plots&#39;)" class="dcl-plots-full-target ng-hide"></div></div></div></div><div class="dcl-action-panel clearfix" exercise="exercise"><button ng-show="hasHint()" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showHint()" tooltip-placement="top" uib-tooltip="Get Hint">Hint</button> <button ng-show="solutionButtonShown" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showSolutionTab()" tooltip-placement="top" uib-tooltip="Show Solution">Solution</button> <button class="dcl-btn dcl-btn-primary dcl-btn-small" href="" ng-click="execute()" submit-disable="" tooltip-placement="top" uib-tooltip="Execute Code">Run</button><span class="dcl-app-status"><i class="fa fa-circle dcl-broken" ng-hide="isLoading" ng-class="{&#39;dcl-busy&#39;: isBusy, &#39;dcl-broken&#39;: isBroken}"></i> <i class="dcl-app-status-spinner fa fa-circle-o-notch fa-spin ng-hide" ng-show="isLoading"></i> <span class="dcl-app-status-text dcl-hide-xxs ng-binding" style="display: none;">Session Inactive</span></span></div></div></div>

<table align="center" border="0" cellpadding="1" cellspacing="1" style="width: 800px;">
	<tbody>
		<tr>
			<td align="center">
			<p><img alt="neural network model" src="./keras_ Deep Learning in R (article) - DataCamp_files/Modelfinetune-2a.png" style="width: 430px; height: 304px;"></p>
			</td>
			<td align="center">
			<p><img alt="hidden units ann" src="./keras_ Deep Learning in R (article) - DataCamp_files/Modelfinetune-2b.png" style="width: 430px; height: 304px;"></p>
			</td>
		</tr>
	</tbody>
</table>
</div>

<div class="section level3" id="optimization-parameters">
<h3>Optimization Parameters</h3>

<p>Besides adding layers and playing around with the hidden units, you can also try to adjust (some of) the parameters of the optimization algorithm that you give to the <code>compile()</code> function. Up until now, you have always passed a vector with a string, <code>adam</code>, to the <code>optimizer</code> argument.</p>

<p>But that doesn’t always need to be like this!</p>

<p>Also, try out experimenting with other optimization algorithms, like the Stochastic Gradient Descent (SGD). Try, for example, using the <code>optimizer_sgd()</code> function to adjust the learning rate <code>lr</code>. Do you notice an effect?</p>

<div data-encoded="true" data-height="600" class="datacamp-exercise ng-scope" style="height:600px;"><!--[if lt IE 10]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]--><div ng-controller="NormalExerciseController" class="ng-scope"><div class="dcl-exercise-area" resize-layout=""><div class="dcl-left-pane dcl-mini" ng-class="{&#39;dcl-mini&#39;: useMiniLayout}"><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;usercode&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;usercode&#39;)}" class="ng-binding dcl-active">script.R</a></li><li ng-show="solutionTabShown" class="ng-hide"><a class="dcl-animation--flash ng-binding" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;solution&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;solution&#39;)}">solution.R</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout" ng-click="activateLeftTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;console&#39;)}" class="ng-binding">R Console</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout &amp;&amp; plotTabShown" ng-click="activateLeftTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div code-editor="" control="editor" ng-show="isActiveLeftTab(&#39;usercode&#39;) || isActiveLeftTab(&#39;solution&#39;)" ng-model="userCode" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 52px; top: 0px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 555px; width: 48px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div><div class="ace_gutter-cell " style="height: 16px;">6</div><div class="ace_gutter-cell " style="height: 16px;">7</div><div class="ace_gutter-cell " style="height: 16px;">8</div><div class="ace_gutter-cell " style="height: 16px;">9</div><div class="ace_gutter-cell " style="height: 16px;">10</div><div class="ace_gutter-cell " style="height: 16px;">11</div><div class="ace_gutter-cell " style="height: 16px;">12</div><div class="ace_gutter-cell " style="height: 16px;">13</div><div class="ace_gutter-cell " style="height: 16px;">14</div><div class="ace_gutter-cell " style="height: 16px;">15</div><div class="ace_gutter-cell " style="height: 16px;">16</div><div class="ace_gutter-cell " style="height: 16px;">17</div><div class="ace_gutter-cell " style="height: 16px;">18</div><div class="ace_gutter-cell " style="height: 16px;">19</div><div class="ace_gutter-cell " style="height: 16px;">20</div><div class="ace_gutter-cell " style="height: 16px;">21</div><div class="ace_gutter-cell " style="height: 16px;">22</div><div class="ace_gutter-cell " style="height: 16px;">23</div><div class="ace_gutter-cell " style="height: 16px;">24</div><div class="ace_gutter-cell " style="height: 16px;">25</div><div class="ace_gutter-cell " style="height: 16px;">26</div><div class="ace_gutter-cell " style="height: 16px;">27</div><div class="ace_gutter-cell " style="height: 16px;">28</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 48px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 535px; height: 555px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:16px;top:0px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Initialize a sequential model</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">keras_model_sequential</span><span class="ace_paren ace_keyword ace_operator">()</span> </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Build up your model by adding layers to it</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">%&gt;%</span> </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">    <span class="ace_identifier">layer_dense</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">units</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">8</span>, <span class="ace_identifier">activation</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'relu'</span>, <span class="ace_identifier">input_shape</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_constant ace_numeric">4</span><span class="ace_paren ace_keyword ace_operator">))</span> <span class="ace_keyword ace_operator">%&gt;%</span> </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">    <span class="ace_identifier">layer_dense</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">units</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">3</span>, <span class="ace_identifier">activation</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'softmax'</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Define an optimizer</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">sgd</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">optimizer_sgd</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">lr</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">0.01</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Use the optimizer to compile the model</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">%&gt;%</span> <span class="ace_identifier">compile</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">optimizer</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">sgd</span>, </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  <span class="ace_identifier">loss</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">'categorical_crossentropy'</span>, </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  <span class="ace_identifier">metrics</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">'accuracy'</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Fit the model to the training data</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">%&gt;%</span> <span class="ace_identifier">fit</span><span class="ace_paren ace_keyword ace_operator">(</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">iris.training</span>, <span class="ace_identifier">iris.trainLabels</span>, </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">epochs</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">200</span>, <span class="ace_identifier">batch_size</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">5</span>, </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span> <span class="ace_identifier">validation_split</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">0.2</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"> <span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Evaluate the model</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">score</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">%&gt;%</span> <span class="ace_identifier">evaluate</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">iris.test</span>, <span class="ace_identifier">iris.testLabels</span>, <span class="ace_identifier">batch_size</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">128</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Print the loss and accuracy metrics</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">print</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">score</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="width: 22px; bottom: 0px; display: none;"><div class="ace_scrollbar-inner" style="width: 22px; height: 448px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 48px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 234px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div ng-show="isActiveLeftTab(&#39;console&#39;)" class="dcl-console-target dcl-console-mini-target ng-hide"><console class="dcl-console ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 18.075px; top: 0px;"></textarea><div class="ace_gutter" style="display: none;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px;"></div><div class="ace_gutter-active-line" style="display: none;"></div></div><div class="ace_scroller" style="left: 0px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 287px; height: 555px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_operator ace_keyword">&gt; </span><span class="ace_identifier"></span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 18.075px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 0px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 287px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></console></div><div ng-show="isActiveLeftTab(&#39;plots&#39;)" class="dcl-plots-mini-target ng-hide"><plots-container class="dcl-plots-container"><div class="dcl-plot"><img ng-show="plots.length &gt; 0" class="ng-hide"></div><div class="dcl-plot-actions"><button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="removePlot()" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-trash"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="previousPlot()" ng-disabled="plotIndex &lt;= 0" disabled="disabled"><i class="fa fa-chevron-left"></i></button> <span ng-show="plots.length &gt; 0" class="ng-binding ng-hide">1/0</span> <span ng-hide="plots.length &gt; 0">0/0</span> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="nextPlot()" ng-disabled="plotIndex &gt;= (plots.length - 1)" disabled="disabled"><i class="fa fa-chevron-right"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="expand(&#39;plot&#39;)" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-expand"></i></button></div></plots-container></div><div growl="" ng-show="!isActiveLeftTab(&#39;plots&#39;)" inline="true" limit-messages="1" sct-feedback="" class="sct-feedback-container ng-isolate-scope"><div class="growl-container bottom-left" ng-class="wrapperClasses()"><!-- ngRepeat: message in growlMessages.directives[referenceId].messages --></div></div></div></div><div ng-show="!useMiniLayout" class="dcl-right-pane clearfix ng-hide"><a class="dcl-github-link dcl-no-link-style" href="https://github.com/datacamp/datacamp-light" uib-tooltip="View DataCamp Light on Github" tooltip-placement="left" target="_blank"><div class="dcl-github-logo"></div></a><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;console&#39;)}" class="ng-binding dcl-active">R Console</a></li><li><a ng-show="plotTabShown" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div ng-show="isActiveRightTab(&#39;console&#39;)" control="console" class="dcl-console-target dcl-console-full-target"></div><div ng-show="isActiveRightTab(&#39;plots&#39;)" class="dcl-plots-full-target ng-hide"></div></div></div></div><div class="dcl-action-panel clearfix" exercise="exercise"><button ng-show="hasHint()" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showHint()" tooltip-placement="top" uib-tooltip="Get Hint">Hint</button> <button ng-show="solutionButtonShown" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showSolutionTab()" tooltip-placement="top" uib-tooltip="Show Solution">Solution</button> <button class="dcl-btn dcl-btn-primary dcl-btn-small" href="" ng-click="execute()" submit-disable="" tooltip-placement="top" uib-tooltip="Execute Code">Run</button><span class="dcl-app-status"><i class="fa fa-circle dcl-broken" ng-hide="isLoading" ng-class="{&#39;dcl-busy&#39;: isBusy, &#39;dcl-broken&#39;: isBroken}"></i> <i class="dcl-app-status-spinner fa fa-circle-o-notch fa-spin ng-hide" ng-show="isLoading"></i> <span class="dcl-app-status-text dcl-hide-xxs ng-binding" style="display: none;">Session Inactive</span></span></div></div></div>

<p>Besides using another optimizer, you can also try using a smaller learning rate to train your network. This is one of the most common fine-tuning techniques; A common practice is to make the initial learning rate 10 times smaller than the one that you used to train the model before.</p>

<p>Let’s visualize the training history one more time to see the effect of this small adjustment:</p>

<div data-encoded="true" data-height="700" class="datacamp-exercise ng-scope" style="height:700px;"><!--[if lt IE 10]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]--><div ng-controller="NormalExerciseController" class="ng-scope"><div class="dcl-exercise-area" resize-layout=""><div class="dcl-left-pane dcl-mini" ng-class="{&#39;dcl-mini&#39;: useMiniLayout}"><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;usercode&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;usercode&#39;)}" class="ng-binding dcl-active">script.R</a></li><li ng-show="solutionTabShown" class="ng-hide"><a class="dcl-animation--flash ng-binding" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateLeftTab(&#39;solution&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;solution&#39;)}">solution.R</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout" ng-click="activateLeftTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;console&#39;)}" class="ng-binding">R Console</a></li><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-show="useMiniLayout &amp;&amp; plotTabShown" ng-click="activateLeftTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveLeftTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div code-editor="" control="editor" ng-show="isActiveLeftTab(&#39;usercode&#39;) || isActiveLeftTab(&#39;solution&#39;)" ng-model="userCode" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 52px; top: 0px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 671px; width: 48px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div><div class="ace_gutter-cell " style="height: 16px;">6</div><div class="ace_gutter-cell " style="height: 16px;">7</div><div class="ace_gutter-cell " style="height: 16px;">8</div><div class="ace_gutter-cell " style="height: 16px;">9</div><div class="ace_gutter-cell " style="height: 16px;">10</div><div class="ace_gutter-cell " style="height: 16px;">11</div><div class="ace_gutter-cell " style="height: 16px;">12</div><div class="ace_gutter-cell " style="height: 16px;">13</div><div class="ace_gutter-cell " style="height: 16px;">14</div><div class="ace_gutter-cell " style="height: 16px;">15</div><div class="ace_gutter-cell " style="height: 16px;">16</div><div class="ace_gutter-cell " style="height: 32px;">17</div><div class="ace_gutter-cell " style="height: 16px;">18</div><div class="ace_gutter-cell " style="height: 16px;">19</div><div class="ace_gutter-cell " style="height: 16px;">20</div><div class="ace_gutter-cell " style="height: 16px;">21</div><div class="ace_gutter-cell " style="height: 32px;">22</div><div class="ace_gutter-cell " style="height: 16px;">23</div><div class="ace_gutter-cell " style="height: 32px;">24</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 48px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 535px; height: 671px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:16px;top:0px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Define an optimizer</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">sgd</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">optimizer_sgd</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">lr</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">0.01</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Compile the model</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">%&gt;%</span> <span class="ace_identifier">compile</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">optimizer</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">sgd</span>, </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  <span class="ace_identifier">loss</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">'categorical_crossentropy'</span>, </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  <span class="ace_identifier">metrics</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">'accuracy'</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Fit the model to the training data</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">history</span> <span class="ace_keyword ace_operator">&lt;-</span> <span class="ace_identifier">model</span> <span class="ace_keyword ace_operator">%&gt;%</span> <span class="ace_identifier">fit</span><span class="ace_paren ace_keyword ace_operator">(</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">  <span class="ace_identifier">iris.training</span>, <span class="ace_identifier">iris.trainLabels</span>, </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">  <span class="ace_identifier">epochs</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">200</span>, <span class="ace_identifier">batch_size</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">5</span>, </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">  <span class="ace_identifier">validation_split</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">0.2</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"> <span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Plot the model loss</span></div></div><div class="ace_line_group" style="height:32px"><div class="ace_line" style="height:16px"><span class="ace_identifier">plot</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">history</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">metrics</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">loss</span>, <span class="ace_identifier">main</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"Model Loss"</span>, <span class="ace_identifier">xlab</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">"epoch"</span>, <span class="ace_identifier">ylab</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"loss"</span>, </div><div class="ace_line" style="height:16px"><span class="ace_identifier">col</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"blue"</span>, <span class="ace_identifier">type</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"l"</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">lines</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">history</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">metrics</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">val_loss</span>, <span class="ace_identifier">col</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"green"</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">legend</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_string">"topright"</span>, <span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_string">"train"</span>,<span class="ace_string">"test"</span><span class="ace_paren ace_keyword ace_operator">)</span>, <span class="ace_identifier">col</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_string">"blue"</span>, <span class="ace_string">"green"</span><span class="ace_paren ace_keyword ace_operator">)</span>, <span class="ace_identifier">lty</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_constant ace_numeric">1</span>,<span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_keyword ace_operator">))</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_comment"># Plot the model accuracy</span></div></div><div class="ace_line_group" style="height:32px"><div class="ace_line" style="height:16px"><span class="ace_identifier">plot</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">history</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">metrics</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">acc</span>, <span class="ace_identifier">main</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"Model Accuracy"</span>, <span class="ace_identifier">xlab</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_string">"epoch"</span>, <span class="ace_identifier">ylab</span></div><div class="ace_line" style="height:16px"><span class="ace_keyword ace_operator">=</span><span class="ace_string">"accuracy"</span>, <span class="ace_identifier">col</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"blue"</span>, <span class="ace_identifier">type</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"l"</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_identifier">lines</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_identifier">history</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">metrics</span><span class="ace_keyword ace_operator">$</span><span class="ace_identifier">val_acc</span>, <span class="ace_identifier">col</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">"green"</span><span class="ace_paren ace_keyword ace_operator">)</span></div></div><div class="ace_line_group" style="height:32px"><div class="ace_line" style="height:16px"><span class="ace_identifier">legend</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_string">"bottomright"</span>, <span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_string">"train"</span>,<span class="ace_string">"test"</span><span class="ace_paren ace_keyword ace_operator">)</span>, <span class="ace_identifier">col</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_string">"blue"</span>, <span class="ace_string">"green"</span><span class="ace_paren ace_keyword ace_operator">)</span>, <span class="ace_identifier">lty</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">c</span><span class="ace_paren ace_keyword ace_operator">(</span><span class="ace_constant ace_numeric">1</span>,<span class="ace_constant ace_numeric">1</span></div><div class="ace_line" style="height:16px"><span class="ace_paren ace_keyword ace_operator">))</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="width: 22px; bottom: 0px; display: none;"><div class="ace_scrollbar-inner" style="width: 22px; height: 432px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 48px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 234px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div ng-show="isActiveLeftTab(&#39;console&#39;)" class="dcl-console-target dcl-console-mini-target ng-hide"><console class="dcl-console ng-isolate-scope ace_editor ace-crimson-editor" style="font-size: 12.8px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 16px; width: 7.0375px; left: 18.075px; top: 0px;"></textarea><div class="ace_gutter" style="display: none;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px;"></div><div class="ace_gutter-active-line" style="display: none;"></div></div><div class="ace_scroller" style="left: 0px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 287px; height: 655px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 567px; visibility: hidden;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"><span class="ace_operator ace_keyword">&gt; </span><span class="ace_identifier"></span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 18.075px; top: 0px; width: 7.0375px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 0px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 287px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></console></div><div ng-show="isActiveLeftTab(&#39;plots&#39;)" class="dcl-plots-mini-target ng-hide"><plots-container class="dcl-plots-container"><div class="dcl-plot"><img ng-show="plots.length &gt; 0" class="ng-hide"></div><div class="dcl-plot-actions"><button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="removePlot()" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-trash"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="previousPlot()" ng-disabled="plotIndex &lt;= 0" disabled="disabled"><i class="fa fa-chevron-left"></i></button> <span ng-show="plots.length &gt; 0" class="ng-binding ng-hide">1/0</span> <span ng-hide="plots.length &gt; 0">0/0</span> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="nextPlot()" ng-disabled="plotIndex &gt;= (plots.length - 1)" disabled="disabled"><i class="fa fa-chevron-right"></i></button> <button class="dcl-btn dcl-btn-small dcl-plot-btn" ng-click="expand(&#39;plot&#39;)" ng-disabled="plots.length === 0" disabled="disabled"><i class="fa fa-expand"></i></button></div></plots-container></div><div growl="" ng-show="!isActiveLeftTab(&#39;plots&#39;)" inline="true" limit-messages="1" sct-feedback="" class="sct-feedback-container ng-isolate-scope"><div class="growl-container bottom-left" ng-class="wrapperClasses()"><!-- ngRepeat: message in growlMessages.directives[referenceId].messages --></div></div></div></div><div ng-show="!useMiniLayout" class="dcl-right-pane clearfix ng-hide"><a class="dcl-github-link dcl-no-link-style" href="https://github.com/datacamp/datacamp-light" uib-tooltip="View DataCamp Light on Github" tooltip-placement="left" target="_blank"><div class="dcl-github-logo"></div></a><ul class="dcl-content--tab"><li><a href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;console&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;console&#39;)}" class="ng-binding dcl-active">R Console</a></li><li><a ng-show="plotTabShown" href="https://www.datacamp.com/community/tutorials/keras-r-deep-learning" ng-click="activateRightTab(&#39;plots&#39;)" ng-class="{&#39;dcl-active&#39;: isActiveRightTab(&#39;plots&#39;)}" class="ng-hide">Plots</a></li></ul><div class="dcl-content--tab-body"><div ng-show="isActiveRightTab(&#39;console&#39;)" control="console" class="dcl-console-target dcl-console-full-target"></div><div ng-show="isActiveRightTab(&#39;plots&#39;)" class="dcl-plots-full-target ng-hide"></div></div></div></div><div class="dcl-action-panel clearfix" exercise="exercise"><button ng-show="hasHint()" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showHint()" tooltip-placement="top" uib-tooltip="Get Hint">Hint</button> <button ng-show="solutionButtonShown" class="dcl-btn dcl-btn-secondary dcl-btn-small ng-hide" href="" ng-click="showSolutionTab()" tooltip-placement="top" uib-tooltip="Show Solution">Solution</button> <button class="dcl-btn dcl-btn-primary dcl-btn-small" href="" ng-click="execute()" submit-disable="" tooltip-placement="top" uib-tooltip="Execute Code">Run</button><span class="dcl-app-status"><i class="fa fa-circle dcl-broken" ng-hide="isLoading" ng-class="{&#39;dcl-busy&#39;: isBusy, &#39;dcl-broken&#39;: isBroken}"></i> <i class="dcl-app-status-spinner fa fa-circle-o-notch fa-spin ng-hide" ng-show="isLoading"></i> <span class="dcl-app-status-text dcl-hide-xxs ng-binding" style="display: none;">Session Inactive</span></span></div></div></div>

<table align="center" border="0" cellpadding="1" cellspacing="1" style="width: 800px;">
	<tbody>
		<tr>
			<td align="center">
			<p><img alt="neural network model" src="./keras_ Deep Learning in R (article) - DataCamp_files/Modelfinetune-3a.png" style="width: 430px; height: 304px;"></p>
			</td>
			<td align="center">
			<p><img alt="hidden units ann" src="./keras_ Deep Learning in R (article) - DataCamp_files/Modelfinetune-3b.png" style="width: 430px; height: 304px;"></p>
			</td>
		</tr>
	</tbody>
</table>
</div>

<h2 id="save">Saving, Loading or Exporting Your Model</h2>

<p>There is one last thing that remains in your journey with the <code>keras</code> package and that is saving or exporting your model so that you can load it back in at another moment.</p>

<ul>
	<li>Firstly, you can easily make use of the <code>save_model_hdf5()</code> and <code>load_model_hdf5()</code> functions to save and load your model into your workspace:</li>
</ul>

<pre><code>save_model_hdf5(model, "my_model.h5")
model &lt;- load_model_hdf5("my_model.h5")</code></pre>

<ul>
	<li>Additionally, you can also save and load the model weights with the <code>save_model_weights_hdf5()</code> and <code>load_model_weights_hdf5()</code> functions:</li>
</ul>

<pre><code>save_model_weights_hdf5("my_model_weights.h5")
model %&gt;% load_model_weights_hdf5("my_model_weights.h5")</code></pre>

<ul>
	<li>Lastly, it’s good to know that you can also export your model configuration to JSON or YAML. Here, the functions <code>model_to_json()</code> and <code>model_to_yaml()</code> will help you out. To load the configurations back into your workspace, you can just use the <code>model_from_json()</code> and <code>model_from yaml()</code> functions:</li>
</ul>

<pre><code>json_string &lt;- model_to_json(model)
model &lt;- model_from_json(json_string)

yaml_string &lt;- model_to_yaml(model)
model &lt;- model_from_yaml(yaml_string)</code></pre>

<p><a href="https://www.datacamp.com/courses/" target="_blank"><img alt="Learn Python for Data Science With DataCamp" src="./keras_ Deep Learning in R (article) - DataCamp_files/content_blog_banner.png"></a></p>

<div class="section level2" id="deep-learning-with-keras">
<h2>Deep Learning With Keras</h2>

<p>Congrats! You’ve made it through this deep learning tutorial in R with <code>keras</code>. This tutorial was just one small step in your deep learning journey with R; There’s much more to cover! If you haven’t taken DataCamp’s <a href="https://www.datacamp.com/courses/deep-learning-in-python">Deep Learning in Python</a> course, you might consider doing so.</p>

<p>In the meantime, also make sure to check out the <a href="https://keras.io/">Keras documentation</a> and the RStudio <a href="https://rstudio.github.io/keras/"><code>keras</code> documentation</a> if you haven’t done so already. You’ll find more examples and information on all functions, arguments, more layers, etc… Also check out François Chollet’s book <a href="https://www.manning.com/books/deep-learning-with-python">“Deep Learning with Python”</a>. All these resources will undoubtedly be indispensable in learning how to work with neural networks in R!</p>
</div>
</div><link href="./keras_ Deep Learning in R (article) - DataCamp_files/solarized-dark.min.css" rel="stylesheet" data-reactid="173"><link href="./keras_ Deep Learning in R (article) - DataCamp_files/css" rel="stylesheet" data-reactid="174"><link href="./keras_ Deep Learning in R (article) - DataCamp_files/css(1)" rel="stylesheet" data-reactid="175"><!-- react-empty: 176 --></div><div class="social__bottom mobileOnly" data-jsx-ext="2343812706" data-reactid="177"><div class="voteAndSocial" data-jsx-ext="2343812706" data-reactid="178"><div class="Upvote" data-jsx-ext="22323102667" data-reactid="179"><div data-jsx-ext="22323102667" data-reactid="180"><div class="normal" data-jsx-ext="22323102667" data-reactid="181"><span class="icon" data-jsx-ext="22323102667" data-reactid="182">▲</span><span class="count" data-jsx-ext="22323102667" data-reactid="183">16</span></div><div class="voted" data-jsx-ext="22323102667" data-reactid="184"><span class="icon" data-jsx-ext="22323102667" data-reactid="185">▲</span><span class="count" data-jsx-ext="22323102667" data-reactid="186">16</span></div></div><!-- react-empty: 187 --></div><div class="Social" data-jsx-ext="21337150270" data-reactid="188"><div class="icons" data-jsx-ext="21337150270" data-reactid="189"><a href="https://www.facebook.com/sharer.php?u=http://www.datacamp.com/community/tutorials/keras-r-deep-learning" class="icon" target="_blank" rel="noopener noreferrer" data-jsx-ext="21337150270" data-reactid="190"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 11.73 22.58" height="12" data-reactid="191"><path d="M7.61 22.58v-10.3h3.46l.52-4h-4V5.7c0-1.16.32-2 2-2h2.13V.16A28.47 28.47 0 0 0 8.63 0C5.56 0 3.47 1.87 3.47 5.31v3H0v4h3.47v10.3h4.14z" data-reactid="192"></path></svg></a><a href="https://twitter.com/intent/tweet?url=http://www.datacamp.com/community/tutorials/keras-r-deep-learning" class="icon centerIcon" target="_blank" rel="noopener noreferrer" data-jsx-ext="21337150270" data-reactid="193"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20.42 16.67" height="10" data-reactid="194"><path d="M10 5.18c0-.28-.06-.53-.07-.78a4 4 0 0 1 .73-2.57A4.08 4.08 0 0 1 13.93 0 4 4 0 0 1 17 1.15a.43.43 0 0 0 .46.12 8.68 8.68 0 0 0 2.2-.84l.2-.1a4.36 4.36 0 0 1-1.75 2.28A9 9 0 0 0 20.42 2l-.21.3a3.83 3.83 0 0 1-.23.3A8.45 8.45 0 0 1 18.5 4a.28.28 0 0 0-.13.27A12 12 0 0 1 17 10.18a11.8 11.8 0 0 1-3.37 4.11 11.17 11.17 0 0 1-4.39 2.06 12.53 12.53 0 0 1-4.44.22 11.87 11.87 0 0 1-4.74-1.73L0 14.79a8.6 8.6 0 0 0 6.16-1.74 4.28 4.28 0 0 1-3.91-2.91h.95a6.18 6.18 0 0 0 .89-.12A4.2 4.2 0 0 1 .8 5.88a4 4 0 0 0 1.81.49 4.23 4.23 0 0 1-1.78-3A4.07 4.07 0 0 1 1.38.79 12.06 12.06 0 0 0 10 5.18z" id="iOjKBC.tif" data-reactid="195"></path></svg></a><a href="https://www.linkedin.com/cws/share?url=http://www.datacamp.com/community/tutorials/keras-r-deep-learning" class="icon" target="_blank" rel="noopener noreferrer" data-jsx-ext="21337150270" data-reactid="196"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16.99 17" height="10" data-reactid="197"><path d="M3.85 17H.34V5.67h3.51zM2.07 4.18a2.09 2.09 0 1 1 2.08-2.09 2.08 2.08 0 0 1-2.08 2.09zM17 17h-3.5v-5.95c0-1.63-.62-2.54-1.91-2.54s-2.14.95-2.14 2.54V17H6.09V5.67h3.36v1.52a4 4 0 0 1 3.42-1.87c2.4 0 4.12 1.47 4.12 4.5V17z" data-reactid="198"></path></svg></a></div><!-- react-empty: 199 --></div></div></div></div></div><!-- react-empty: 200 --></main><div class="SidebarSocial " data-jsx-ext="22564400772" data-reactid="201"><div class="rss" data-jsx-ext="22564400772" data-reactid="202"><a href="https://www.datacamp.com/community/rss.xml" data-jsx-ext="22564400772" data-reactid="203"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" height="13" data-reactid="204"><circle cx="3.08" cy="14.92" r="3.08" data-reactid="205"></circle><path d="M16.46 18a1.54 1.54 0 0 1-1.54-1.54c0-8.25-5.13-13.38-13.38-13.38A1.59 1.59 0 0 1 .46 1.15 1.72 1.72 0 0 1 1.54 0a16.45 16.45 0 0 1 12 4.51c3 2.95 4.51 7.08 4.51 12A1.54 1.54 0 0 1 16.46 18z" data-reactid="206"></path><path d="M10.63 18a1.54 1.54 0 0 1-1.54-1.54c0-5-2.54-7.54-7.54-7.54a1.54 1.54 0 0 1 0-3.08c6.75 0 10.63 3.87 10.63 10.62A1.54 1.54 0 0 1 10.63 18z" data-reactid="207"></path></svg><!-- react-text: 208 -->Subscribe to RSS<!-- /react-text --></a></div><div class="icons" data-jsx-ext="22564400772" data-reactid="209"><a href="https://www.facebook.com/pages/DataCamp/726282547396228" class="icon" target="_blank" rel="noopener noreferrer" data-jsx-ext="22564400772" data-reactid="210"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 11.73 22.58" height="16" data-reactid="211"><path d="M7.61 22.58v-10.3h3.46l.52-4h-4V5.7c0-1.16.32-2 2-2h2.13V.16A28.47 28.47 0 0 0 8.63 0C5.56 0 3.47 1.87 3.47 5.31v3H0v4h3.47v10.3h4.14z" data-reactid="212"></path></svg></a><a href="https://twitter.com/datacamp" class="icon" target="_blank" rel="noopener noreferrer" data-jsx-ext="22564400772" data-reactid="213"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20.42 16.67" height="13" data-reactid="214"><path d="M10 5.18c0-.28-.06-.53-.07-.78a4 4 0 0 1 .73-2.57A4.08 4.08 0 0 1 13.93 0 4 4 0 0 1 17 1.15a.43.43 0 0 0 .46.12 8.68 8.68 0 0 0 2.2-.84l.2-.1a4.36 4.36 0 0 1-1.75 2.28A9 9 0 0 0 20.42 2l-.21.3a3.83 3.83 0 0 1-.23.3A8.45 8.45 0 0 1 18.5 4a.28.28 0 0 0-.13.27A12 12 0 0 1 17 10.18a11.8 11.8 0 0 1-3.37 4.11 11.17 11.17 0 0 1-4.39 2.06 12.53 12.53 0 0 1-4.44.22 11.87 11.87 0 0 1-4.74-1.73L0 14.79a8.6 8.6 0 0 0 6.16-1.74 4.28 4.28 0 0 1-3.91-2.91h.95a6.18 6.18 0 0 0 .89-.12A4.2 4.2 0 0 1 .8 5.88a4 4 0 0 0 1.81.49 4.23 4.23 0 0 1-1.78-3A4.07 4.07 0 0 1 1.38.79 12.06 12.06 0 0 0 10 5.18z" id="iOjKBC.tif" data-reactid="215"></path></svg></a><a href="https://www.linkedin.com/company/datamind-org" class="icon" target="_blank" rel="noopener noreferrer" data-jsx-ext="22564400772" data-reactid="216"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16.99 17" height="12" data-reactid="217"><path d="M3.85 17H.34V5.67h3.51zM2.07 4.18a2.09 2.09 0 1 1 2.08-2.09 2.08 2.08 0 0 1-2.08 2.09zM17 17h-3.5v-5.95c0-1.63-.62-2.54-1.91-2.54s-2.14.95-2.14 2.54V17H6.09V5.67h3.36v1.52a4 4 0 0 1 3.42-1.87c2.4 0 4.12 1.47 4.12 4.5V17z" data-reactid="218"></path></svg></a><a href="https://www.youtube.com/channel/UC79Gv3mYp6zKiSwYemEik9A" class="icon" target="_blank" rel="noopener noreferrer" data-jsx-ext="22564400772" data-reactid="219"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25.19 17.73" height="12" data-reactid="220"><path d="M24.21 1.52C23.3.44 21.62 0 18.42 0H6.78C3.5 0 1.79.47.88 1.62S0 4.4 0 6.68V11c0 4.43 1 6.68 6.78 6.68h11.64c2.78 0 4.32-.39 5.32-1.34S25.2 13.76 25.2 11V6.68c-.01-2.41-.08-4.07-.99-5.16zm-8 7.94l-5.29 2.76a.81.81 0 0 1-1.19-.72V6a.81.81 0 0 1 1.19-.72L16.17 8a.81.81 0 0 1 0 1.44z" data-reactid="221"></path></svg></a></div><div class="menu" data-jsx-ext="22564400772" data-reactid="222"><a href="https://www.datacamp.com/about" class="menuItem" data-jsx-ext="22564400772" data-reactid="223">About</a><a href="https://www.datacamp.com/terms-of-use" class="menuItem" data-jsx-ext="22564400772" data-reactid="224">Terms</a><a href="https://www.datacamp.com/privacy-policy" class="menuItem" data-jsx-ext="22564400772" data-reactid="225">Privacy</a></div><!-- react-empty: 226 --></div><!-- react-empty: 227 --></div><!-- react-empty: 228 --><!-- react-empty: 229 --><!-- react-empty: 230 --><!-- react-empty: 231 --><link href="./keras_ Deep Learning in R (article) - DataCamp_files/css(2)" rel="stylesheet" data-reactid="232"><div class="Analytics" data-reactid="233"><!-- react-empty: 234 --><script src="./keras_ Deep Learning in R (article) - DataCamp_files/datacamp-analytics-1.1.7.min.js.téléchargement" data-reactid="235"></script><script data-reactid="236">
      DC = window.DC || {}
      DC.analytics = new DCAnalytics({"api_domain": "https://www.datacamp.com", "collection": "community", "autotrack_utm": true, "autotrack_data_attr": true });
    </script><script src="./keras_ Deep Learning in R (article) - DataCamp_files/track-js-v1.0.3.min.js.téléchargement" async="" data-reactid="237"></script><script data-reactid="238">dataLayer = [];</script><script src="./keras_ Deep Learning in R (article) - DataCamp_files/lodash.min.js.téléchargement" data-reactid="239"></script><script data-reactid="240">
      function trackGoogleTagEvent(eventName, properties){
        function formatProps(){
          if (_.isEmpty(properties))
            return {};
          else {
            if(_.isObject(properties)){
              return { 'ga-label': JSON.stringify(properties) };
            }
            else{
              return { 'ga-label': properties };
            }
          }
        }
        dataLayer.push(_.merge({ 'event': 'dc.' + eventName }, formatProps(), dataLayer[0]));
      }
    </script><script data-reactid="241">trackGoogleTagEvent('Community Visit Tutorial Page', { nonInteraction: 1 })</script><script data-reactid="242">DC.analytics.track_event_from("community-tutorial", 'Community Visit Tutorial Page', "visit", { nonInteraction: 1 })</script><script data-reactid="243">trackGoogleTagEvent('Community Visit keras: Deep Learning in R', { nonInteraction: 1 })</script><script data-reactid="244">DC.analytics.track_event_from("community-tutorial", 'Community Visit keras: Deep Learning in R', "visit", { nonInteraction: 1 })</script><script data-cfasync="false" data-reactid="245">(function(W,i,s,e,P,o,p){W['WisePopsObject']=P;W[P]=W[P]||function(){
      (W[P].q=W[P].q||[]).push(arguments)},W[P].l=1*new Date();o=i.createElement(s),
      p=i.getElementsByTagName(s)[0];o.async=1;o.src=e;p.parentNode.insertBefore(o,p)
    })(window,document,'script','//loader.wisepops.com/get-loader.js?v=1&site=VswVJn7o4J','wisepops');</script></div></div></div></div><div id="__next-error"></div></div>
<script type="text/javascript" id="">!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","286618111707433");fbq("track","PageView");</script>
<noscript>&lt;img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=286618111707433&amp;amp;ev=PageView&amp;amp;noscript=1"&gt;</noscript>


<script type="text/javascript" id="">window._fs_debug=!1;window._fs_host="fullstory.com";window._fs_org="9HWCZ";window._fs_namespace="FS";
(function(e,f,k,l,g,c,b,h){k in e?e.console&&e.console.log&&e.console.log('FullStory namespace conflict. Please set window["_fs_namespace"].'):(b=e[k]=function(d,a){b.q?b.q.push([d,a]):b._api(d,a)},b.q=[],c=f.createElement(l),c.async=1,c.src="https://"+_fs_host+"/s/fs.js",h=f.getElementsByTagName(l)[0],h.parentNode.insertBefore(c,h),b.identify=function(d,a){b(g,{uid:d});a&&b(g,a)},b.setUserVars=function(d){b(g,d)},b.identifyAccount=function(d,a){c="account";a=a||{};a.acctId=d;b(c,a)},b.clearUserCookie=
function(b,a,c){if(!b||document.cookie.match("fs_uid\x3d[`;`]*`[`;`]*`[`;`]*`"))for(a=f.domain;;){f.cookie="fs_uid\x3d;domain\x3d"+a+";path\x3d/;expires\x3d"+(new Date(0)).toUTCString();c=a.indexOf(".");if(0>c)break;a=a.slice(c+1)}})})(window,document,window._fs_namespace,"script","user");</script>

<script type="text/javascript" id="">!function(d,e,f,a,b,c){d.qp||(a=d.qp=function(){a.qp?a.qp.apply(a,arguments):a.queue.push(arguments)},a.queue=[],b=document.createElement(e),b.async=!0,b.src=f,c=document.getElementsByTagName(e)[0],c.parentNode.insertBefore(b,c))}(window,"script","https://a.quora.com/qevents.js");qp("init","22bfea26b11042efa6e75ebd5c7e82b4");qp("track","ViewContent");</script>
<noscript>&lt;img height="1" width="1" style="display:none" src="https://q.quora.com/_/ad/22bfea26b11042efa6e75ebd5c7e82b4/pixel?tag=ViewContent&amp;amp;noscript=1"&gt;</noscript>
<div><script>
          __NEXT_DATA__ = {"props":{"isServer":true,"store":{},"initialState":{"adminContent":{"isFetching":false,"isFetched":false,"statusMessage":"","content":{},"form":{"isSaving":false,"isSucceeded":false,"statusMessage":"","isAdminFormModalOpen":false,"previewSlug":""},"delete":{"isDeleting":false,"isSucceeded":false,"statusMessage":"","isDeleteAdminContentModalOpen":false},"unSpam":{"isUnSpamming":false,"isSucceeded":false,"statusMessage":"","isUnSpamModalOpen":false},"update":{"isApprovingArticle":false,"isSucceeded":false,"statusMessage":"","isApproveArticleModalOpen":false}},"adminList":{"isFetched":false,"isFetching":false,"statusMessage":""},"auth":{"isAuthModalOpen":false,"isLogin":false,"isAuthorized":false,"user":{},"loginTitle":"","signUpTitle":""},"clientConfig":{"isDevelopment":false,"absoluteUrl":"http://www.datacamp.com","ALGOLIA_APP_ID":"7H5IORUQLD","ALGOLIA_API_KEY":"ae6cc3c278ce31c9e334adc652020c2a","ALGOLIA_API_INDEX":"community_prod","DC_COMMUNITY_AUTHOR_APP_URL":"http://datacamp-community-author.us-east-1.elasticbeanstalk.com/","ANALYTICS_GOOGLE_TAG_MANAGER":"GTM-TGGWB2P","ANALYTICS_DC_API_DOMAIN":"https://www.datacamp.com","COUNTDOWN_BANNER_TITLE":"Commit to learning data science in 2018 now and save $151 on DataCamp!","COUNTDOWN_BANNER_TEXT":"Offer ends in","COUNTDOWN_BANNER_START_DATE":"2018-01-02T10:00:00Z","COUNTDOWN_BANNER_END_DATE":"2018-01-10T04:59:59Z","COUNTDOWN_BANNER_LINK":"https://www.datacamp.com/promo/new-year","WISEPOPS":"VswVJn7o4J"},"content":{"content":{"id":362,"externalId":null,"type":"Tutorial","status":"published","authorId":"karlijn","title":"keras: Deep Learning in R","slug":"keras-r-deep-learning","previewSlug":null,"description":"In this tutorial to deep learning in R with RStudio's keras package, you'll learn how to build a Multi-Layer Perceptron (MLP).","articles":null,"courses":null,"redirectSlug":null,"contentHtml":"\u003cscript src=\"https://cdn.datacamp.com/datacamp-light-latest.min.js\"\u003e\u003c/script\u003e\r\n\u003cp\u003eAs you know by now, machine learning is a subfield in Computer Science (CS). Deep learning, then, is a subfield of machine learning that is a set of algorithms that is inspired by the structure and function of the brain and which is usually called Artificial Neural Networks (ANN). Deep learning is one of the hottest trends in machine learning at the moment, and there are many problems where deep learning shines, such as robotics, image recognition and Artificial Intelligence (AI).\u003c/p\u003e\r\n\r\n\u003cp\u003eToday\u0026rsquo;s tutorial will give you a short introduction to deep learning in R with Keras with the \u003ccode\u003ekeras\u003c/code\u003e package:\u003c/p\u003e\r\n\r\n\u003cnav\u003e\r\n\u003cul\u003e\r\n\t\u003cli\u003eYou\u0026rsquo;ll start with a short overview of the \u003ca href=\"#overview\"\u003edeep learning packages in R\u003c/a\u003e, and\u003c/li\u003e\r\n\t\u003cli\u003eYou\u0026rsquo;ll read more about the \u003ca href=\"#differences\"\u003edifferences between the Keras, \u003ccode\u003ekerasR\u003c/code\u003e and \u003ccode\u003ekeras\u003c/code\u003e\u003c/a\u003e packages and what it means when a package is an interface to another package;\u003c/li\u003e\r\n\t\u003cli\u003eThen, you\u0026rsquo;ll really get started with RStudio\u0026rsquo;s \u003ccode\u003ekeras\u003c/code\u003e package: you\u0026rsquo;ll learn how to first \u003ca href=\"prep\"\u003eprepare your workspace\u003c/a\u003e and \u003ca href=\"#data\"\u003eload in\u003c/a\u003e built-in datasets, dummy data, and data from CSVs;\u003c/li\u003e\r\n\t\u003cli\u003eNext, you\u0026rsquo;ll see how you can \u003ca href=\"#explore\"\u003eexplore\u003c/a\u003e and \u003ca href=\"#prep\"\u003epreprocess the data\u003c/a\u003e that you loaded in from a CSV file: you\u0026rsquo;ll normalize and split the data into training and test sets.\u003c/li\u003e\r\n\t\u003cli\u003eAfter this, you\u0026rsquo;re ready to \u003ca href=\"#model\"\u003econstruct your deep learning model\u003c/a\u003e; In this case, you\u0026rsquo;ll build a Multi-Layer Perceptron (MLP) for multi-class classification.\u003c/li\u003e\r\n\t\u003cli\u003eYou\u0026rsquo;ll learn how you can \u003ca href=\"#compile\"\u003ecompile and fit\u003c/a\u003e the model to your data, how you can \u003ca href=\"viz\"\u003evisualize the training history\u003c/a\u003e, and\u003c/li\u003e\r\n\t\u003cli\u003eyou\u0026rsquo;ll \u003ca href=\"#predict\"\u003epredict target values\u003c/a\u003e based on test data;\u003c/li\u003e\r\n\t\u003cli\u003eLastly, you\u0026rsquo;ll \u003ca href=\"#evaluate\"\u003eevaluate your model\u003c/a\u003e, interpret the results and \u003ca href=\"#finetune\"\u003efinetune your model\u003c/a\u003e so that it performs better: you\u0026rsquo;ll learn how to add layers and hidden layers and you\u0026rsquo;ll see how you can adjust the optimization parameters to accomplish better results.\u003c/li\u003e\r\n\t\u003cli\u003eAdditionally, you might want to \u003ca href=\"#save\"\u003esave your (optimized) model or load it back in\u003c/a\u003e another time. You\u0026#39;ll see how this is done in the last section of this tutorial!\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003c/nav\u003e\r\n\r\n\u003cdiv id=\"scoped-content\"\u003e\r\n\u003cstyle type=\"text/css\"\u003e:target:before { content:\"\"; display:block; height:150px; margin:-150px 0 0; } h3 {font-weight:normal; margin-top:.5em} h4 { font-weight:lighter }\r\n\u003c/style\u003e\r\n\u003cp\u003e\u0026nbsp;\u003c/p\u003e\r\n\r\n\u003cp\u003eDo you want to know more about the original Keras or key concepts in deep learning such as perceptrons and Multi-Layer Perceptrons (MLPs)? Consider or taking DataCamp\u0026rsquo;s \u003ca href=\"https://www.datacamp.com/courses/deep-learning-in-python\"\u003eDeep Learning in Python\u003c/a\u003e course or doing the \u003ca href=\"https://www.datacamp.com/community/tutorials/deep-learning-python\"\u003eKeras Tutorial: Deep Learning in Python\u003c/a\u003e.\u003c/p\u003e\r\n\r\n\u003cp\u003e\u003cstrong\u003eTip\u003c/strong\u003e: find our Keras cheat sheet \u003ca href=\"https://www.datacamp.com/community/blog/keras-cheat-sheet\"\u003ehere\u003c/a\u003e.\u003c/p\u003e\r\n\r\n\u003ch2 id=\"overview\"\u003eDeep Learning in R: Short Overview of Packages\u003c/h2\u003e\r\n\r\n\u003cp\u003eWith the rise in popularity of deep learning, CRAN has been enriched with more R deep learning packages; Below you can see an overview of these packages, taken from the \u003ca href=\"https://CRAN.R-project.org/view=MachineLearning\"\u003eMachine Learning and Statistical Learning CRAN task view\u003c/a\u003e. The \u0026ldquo;Percentile\u0026rdquo; column indicates the percentile as found on \u003ca href=\"www.rdocumentation.org\"\u003eRDocumentation\u003c/a\u003e:\u003c/p\u003e\r\n\r\n\u003ctable\u003e\r\n\t\u003ccolgroup\u003e\r\n\t\t\u003ccol width=\"9%\" /\u003e\r\n\t\t\u003ccol width=\"10%\" /\u003e\r\n\t\t\u003ccol width=\"80%\" /\u003e\r\n\t\u003c/colgroup\u003e\r\n\t\u003cthead\u003e\r\n\t\t\u003ctr class=\"header\"\u003e\r\n\t\t\t\u003cth\u003eR Package\u003c/th\u003e\r\n\t\t\t\u003cth\u003ePercentile\u003c/th\u003e\r\n\t\t\t\u003cth\u003eDescription\u003c/th\u003e\r\n\t\t\u003c/tr\u003e\r\n\t\u003c/thead\u003e\r\n\t\u003ctbody\u003e\r\n\t\t\u003ctr class=\"odd\"\u003e\r\n\t\t\t\u003ctd\u003e\u003ccode\u003ennet\u003c/code\u003e\u003c/td\u003e\r\n\t\t\t\u003ctd\u003e96th\u003c/td\u003e\r\n\t\t\t\u003ctd\u003eSoftware for feed-forward neural networks with a single hidden layer, and for multinomial log-linear models.\u003c/td\u003e\r\n\t\t\u003c/tr\u003e\r\n\t\t\u003ctr class=\"even\"\u003e\r\n\t\t\t\u003ctd\u003e\u003ccode\u003eneuralnet\u003c/code\u003e\u003c/td\u003e\r\n\t\t\t\u003ctd\u003e96th\u003c/td\u003e\r\n\t\t\t\u003ctd\u003eTraining of neural networks using backpropagation\u003c/td\u003e\r\n\t\t\u003c/tr\u003e\r\n\t\t\u003ctr class=\"odd\"\u003e\r\n\t\t\t\u003ctd\u003e\u003ccode\u003eh2o\u003c/code\u003e\u003c/td\u003e\r\n\t\t\t\u003ctd\u003e95th\u003c/td\u003e\r\n\t\t\t\u003ctd\u003eR scripting functionality for H2O\u003c/td\u003e\r\n\t\t\u003c/tr\u003e\r\n\t\t\u003ctr class=\"even\"\u003e\r\n\t\t\t\u003ctd\u003e\u003ccode\u003eRSNNS\u003c/code\u003e\u003c/td\u003e\r\n\t\t\t\u003ctd\u003e88th\u003c/td\u003e\r\n\t\t\t\u003ctd\u003eInterface to the Stuttgart Neural Network Simulator (SNNS)\u003c/td\u003e\r\n\t\t\u003c/tr\u003e\r\n\t\t\u003ctr class=\"odd\"\u003e\r\n\t\t\t\u003ctd\u003e\u003ccode\u003etensorflow\u003c/code\u003e\u003c/td\u003e\r\n\t\t\t\u003ctd\u003e88th\u003c/td\u003e\r\n\t\t\t\u003ctd\u003eInterface to TensorFlow\u003c/td\u003e\r\n\t\t\u003c/tr\u003e\r\n\t\t\u003ctr class=\"even\"\u003e\r\n\t\t\t\u003ctd\u003e\u003ccode\u003edeepnet\u003c/code\u003e\u003c/td\u003e\r\n\t\t\t\u003ctd\u003e84th\u003c/td\u003e\r\n\t\t\t\u003ctd\u003eDeep learning toolkit in R\u003c/td\u003e\r\n\t\t\u003c/tr\u003e\r\n\t\t\u003ctr class=\"odd\"\u003e\r\n\t\t\t\u003ctd\u003e\u003ccode\u003edarch\u003c/code\u003e\u003c/td\u003e\r\n\t\t\t\u003ctd\u003e79th\u003c/td\u003e\r\n\t\t\t\u003ctd\u003ePackage for Deep Architectures and Restricted Boltzmann Machines\u003c/td\u003e\r\n\t\t\u003c/tr\u003e\r\n\t\t\u003ctr class=\"even\"\u003e\r\n\t\t\t\u003ctd\u003e\u003ccode\u003ernn\u003c/code\u003e\u003c/td\u003e\r\n\t\t\t\u003ctd\u003e73rd\u003c/td\u003e\r\n\t\t\t\u003ctd\u003ePackage to implement Recurrent Neural Networks (RRNs)\u003c/td\u003e\r\n\t\t\u003c/tr\u003e\r\n\t\t\u003ctr class=\"odd\"\u003e\r\n\t\t\t\u003ctd\u003e\u003ccode\u003eFCNN4R\u003c/code\u003e\u003c/td\u003e\r\n\t\t\t\u003ctd\u003e52nd\u003c/td\u003e\r\n\t\t\t\u003ctd\u003eInterface to the FCNN library that allows user-extensible ANNs\u003c/td\u003e\r\n\t\t\u003c/tr\u003e\r\n\t\t\u003ctr class=\"even\"\u003e\r\n\t\t\t\u003ctd\u003e\u003ccode\u003ercppDL\u003c/code\u003e\u003c/td\u003e\r\n\t\t\t\u003ctd\u003e7th\u003c/td\u003e\r\n\t\t\t\u003ctd\u003eImplementation of basic machine learning methods with many layers (deep learning), including dA (Denoising Autoencoder), SdA (Stacked Denoising Autoencoder), RBM (Restricted Boltzmann machine) and DBN (Deep Belief Nets)\u003c/td\u003e\r\n\t\t\u003c/tr\u003e\r\n\t\t\u003ctr class=\"odd\"\u003e\r\n\t\t\t\u003ctd\u003e\u003ccode\u003edeepr\u003c/code\u003e\u003c/td\u003e\r\n\t\t\t\u003ctd\u003e??*\u003c/td\u003e\r\n\t\t\t\u003ctd\u003ePackage to streamline the training, fine-tuning and predicting processes for deep learning based on \u003ccode\u003edarch\u003c/code\u003e and \u003ccode\u003edeepnet\u003c/code\u003e\u003c/td\u003e\r\n\t\t\u003c/tr\u003e\r\n\t\t\u003ctr class=\"even\"\u003e\r\n\t\t\t\u003ctd\u003e\u003ccode\u003eMXNetR\u003c/code\u003e\u003c/td\u003e\r\n\t\t\t\u003ctd\u003e??*\u003c/td\u003e\r\n\t\t\t\u003ctd\u003ePackage that brings flexible and efficient GPU computing and state-of-art deep learning to R\u003c/td\u003e\r\n\t\t\u003c/tr\u003e\r\n\t\u003c/tbody\u003e\r\n\u003c/table\u003e\r\n\r\n\u003cp\u003e\u003cstrong\u003eTip\u003c/strong\u003e: for a comparison of deep learning packages in R, read \u003ca href=\"http://www.rblog.uni-freiburg.de/2017/02/07/deep-learning-in-r/\"\u003ethis blog post\u003c/a\u003e. For more information on ranking and score in RDocumentation, check out \u003ca href=\"https://www.datacamp.com/community/blog/rdocumentation-ranking-scoring\"\u003ethis blog post\u003c/a\u003e.\u003c/p\u003e\r\n\r\n\u003cp\u003e\u003csmall\u003eThe \u003ccode\u003edeepr\u003c/code\u003e and \u003ccode\u003eMXNetR\u003c/code\u003e were not found on RDocumentation.org, so the percentile is unknown for these two packages.\u003c/small\u003e\u003c/p\u003e\r\n\r\n\u003ch2 id=\"differences\"\u003eKeras, \u003ccode\u003ekeras\u003c/code\u003e and \u003ccode\u003ekerasR\u003c/code\u003e\u003c/h2\u003e\r\n\r\n\u003cp\u003eRecently, two new packages found their way to the R community: the \u003ca href=\"https://github.com/statsmaths/kerasR\"\u003e\u003ccode\u003ekerasR\u003c/code\u003e package\u003c/a\u003e, which was authored and created by Taylor Arnold, and \u003ca href=\"https://github.com/rstudio/keras\"\u003eRStudio\u0026rsquo;s \u003ccode\u003ekeras\u003c/code\u003e package\u003c/a\u003e.\u003c/p\u003e\r\n\r\n\u003cp\u003eBoth packages provide an R interface to the Python deep learning package Keras, of which you might have already heard or maybe you have even worked with it! For those of you who don\u0026rsquo;t know what the Keras package has to offer to Python users, it\u0026rsquo;s \u0026ldquo;a high-level neural networks API, written in Python and capable of running on top of either TensorFlow, Microsoft Cognitive Toolkit (CNTK) or Theano\u0026rdquo;.\u003c/p\u003e\r\n\r\n\u003cdiv class=\"section level3\" id=\"interfaces\"\u003e\r\n\u003ch3\u003eInterfaces?\u003c/h3\u003e\r\n\r\n\u003cp\u003eYou see, getting started with Keras is one of the easiest ways to get familiar with deep learning in Python and that also explains why the \u003ccode\u003ekerasR\u003c/code\u003e and \u003ccode\u003ekeras\u003c/code\u003e packages provide an interface for this fantastic package for R users.\u003c/p\u003e\r\n\r\n\u003cp\u003eIn this case, it\u0026rsquo;s good for you to understand what it exactly means when a package, such as the R \u003ccode\u003ekeras\u003c/code\u003e, is \u0026ldquo;an interface\u0026rdquo; to another package, the Python Keras. In simple terms, this means that the \u003ccode\u003ekeras\u003c/code\u003e R package with the interface allows you to enjoy the benefit of R programming while having access to the capabilities of the Python Keras package.\u003c/p\u003e\r\n\r\n\u003cp\u003e\u003cstrong\u003eNote\u003c/strong\u003e that this is not an uncommon practice: for example, also the \u003ccode\u003eh2o\u003c/code\u003e package provides an interface, but in this case -and as the name kind of already suggests- to H2O, an open source math engine for big data that you can use to compute parallel distributed machine learning algorithms. Other packages that you might know that provide interfaces are \u003ccode\u003eRWeka\u003c/code\u003e (R interface to Weka), \u003ccode\u003etensorflow\u003c/code\u003e (R interface to TensorFlow), \u003ccode\u003eopenml-r\u003c/code\u003e (R interface to OpenML), \u0026hellip; You can keep on going on and on!\u003c/p\u003e\r\n\u003c/div\u003e\r\n\r\n\u003cdiv class=\"section level3\" id=\"whats-the-difference-between-keras-keras-and-kerasr\"\u003e\r\n\u003ch3\u003eWhat\u0026rsquo;s the difference between Keras, \u003ccode\u003ekeras\u003c/code\u003e and \u003ccode\u003ekerasR\u003c/code\u003e?\u003c/h3\u003e\r\n\r\n\u003cp\u003eNow that you know all of this, you might ask yourself the following question first: how would you compare the original Python package with the R packages?\u003c/p\u003e\r\n\r\n\u003cp\u003eIn essence, you won\u0026rsquo;t find too many differences between the R packages and the original Python package, mostly because the function names are almost all the same; The only differences that you notice are mostly in the programming languages themselves (variable assignment, library loading, \u0026hellip;), but the most important thing to notice lies in the fact of how much of the original functionality has been incorporated in the R package.\u003c/p\u003e\r\n\r\n\u003cp\u003e\u003cstrong\u003eNote\u003c/strong\u003e that this remark isn\u0026rsquo;t only valid for the \u003ccode\u003ekeras\u003c/code\u003e library, but also for the \u003ccode\u003etensorflow\u003c/code\u003e, \u003ccode\u003eopenml-r\u003c/code\u003e, \u0026hellip; and other interface packages that were mentioned above!\u003c/p\u003e\r\n\r\n\u003cp\u003eSecondly, you might also wonder what then the difference is between these two R packages. Well, if you want to consider how the two differ, you might want to consider the following points:\u003c/p\u003e\r\n\r\n\u003cul\u003e\r\n\t\u003cli\u003e\r\n\t\u003cp\u003eThe \u003ccode\u003ekeras\u003c/code\u003e package uses the pipe operator (\u003ccode\u003e%\u0026gt;%\u003c/code\u003e) to connect functions or operations together, while you won\u0026rsquo;t find this in \u003ccode\u003ekerasR\u003c/code\u003e: for example, to make your model with \u003ccode\u003ekerasR\u003c/code\u003e, you\u0026rsquo;ll find that you need to make use of the \u003ccode\u003e$\u003c/code\u003e operator. The usage of the pipe operator generally improves the readability of your code and you\u0026rsquo;ll have definitely seen this operator already if you\u0026rsquo;ve worked with \u003ca href=\"http://tidyverse.org/\"\u003eTidyverse packages\u003c/a\u003e before.\u003c/p\u003e\r\n\t\u003c/li\u003e\r\n\t\u003cli\u003e\r\n\t\u003cp\u003eYou\u0026rsquo;ll see that \u003ccode\u003ekerasR\u003c/code\u003e contains functions that are named in a similar, but not in completely the same way as the original Keras package. For example, the original (Python) \u003ccode\u003ecompile()\u003c/code\u003e function is called \u003ccode\u003ekeras_compile()\u003c/code\u003e; The same holds for other functions, such as for example \u003ccode\u003efit()\u003c/code\u003e, which becomes \u003ccode\u003ekeras_fit()\u003c/code\u003e, or \u003ccode\u003epredict()\u003c/code\u003e, which is \u003ccode\u003ekeras_predict\u003c/code\u003e when you make use of the \u003ccode\u003ekerasR\u003c/code\u003e package. These are all custom wrappers.\u003c/p\u003e\r\n\t\u003c/li\u003e\r\n\t\u003cli\u003e\r\n\t\u003cp\u003eYou can argue that the installation of RStudio\u0026rsquo;s \u003ccode\u003ekeras\u003c/code\u003e package is easier than the installation of the \u003ccode\u003ekerasR\u003c/code\u003e package; To get the latter installed, you need to first make sure that you configure which Python version to use and this can get tricky if you\u0026rsquo;re working on a pc that has multiple environments or Python versions installed. But I\u0026rsquo;ll leave you to decide on this :)\u003c/p\u003e\r\n\t\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\r\n\u003cp\u003e\u003ca href=\"https://www.datacamp.com/courses/\" target=\"_blank\"\u003e\u003cimg alt=\"Learn Python for Data Science With DataCamp\" src=\"http://community.datacamp.com.s3.amazonaws.com/community/production/ckeditor_assets/pictures/293/content_blog_banner.png\" /\u003e\u003c/a\u003e\u003c/p\u003e\r\n\r\n\u003cp\u003e\u0026nbsp;\u003c/p\u003e\r\n\u003c/div\u003e\r\n\r\n\u003cp\u003eNow that you have gathered some background, it\u0026rsquo;s time to get started with Keras in R for real. As you will have read in the introduction of this tutorial, you\u0026rsquo;ll first go over the setup of you workspace. Then, you\u0026rsquo;ll load in some data and after a short data exploration and preprocessing step, you will be able to start constructing your MLP!\u003c/p\u003e\r\n\r\n\u003cp\u003eLet\u0026rsquo;s get on with it!\u003c/p\u003e\r\n\r\n\u003ch2\u003eInstalling The \u003ccode\u003ekeras\u003c/code\u003e Package\u003c/h2\u003e\r\n\r\n\u003cp\u003eAs always, the first step to getting started with any package is to set up your workspace: install and load in the library into RStudio or whichever environment you\u0026rsquo;re working in.\u003c/p\u003e\r\n\r\n\u003cp\u003eNo worries, for this tutorial, the package will be loaded in for you!\u003c/p\u003e\r\n\r\n\u003cp\u003eFirst, make sure that you install the \u003ccode\u003ekeras\u003c/code\u003e: you can easily do this by running \u003ccode\u003edevtools::install_github(\u0026quot;rstudio/keras\u0026quot;)\u003c/code\u003e in your console. Next, you can load in the package and install TensorFlow:\u003c/p\u003e\r\n\r\n\u003cpre\u003e\r\n\u003ccode\u003e# Load in the keras package\r\nlibrary(keras)\r\n\r\n# Install TensorFlow\r\ninstall_tensorflow()\u003c/code\u003e\u003c/pre\u003e\r\n\r\n\u003cp\u003eWhen you have done this, you\u0026rsquo;re good to go! That\u0026rsquo;s fast, right?\u003c/p\u003e\r\n\r\n\u003cp\u003e\u003cstrong\u003eTip\u003c/strong\u003e: for more information on the installation process, check out the \u003ca href=\"https://rstudio.github.io/keras/\"\u003epackage website\u003c/a\u003e.\u003c/p\u003e\r\n\u003c/div\u003e\r\n\r\n\u003ch2 id=\"data\"\u003eLoading The Data\u003c/h2\u003e\r\n\r\n\u003cp\u003eNow that the installation process is clear and your workspace is ready, you can start loading in your data! At this point, you have three big options when it comes to your data: you can pick to use one of the built-in datasets that comes with the \u003ccode\u003ekeras\u003c/code\u003e package, you can load your own dataset from, for example, CSV files, or you can make some dummy data.\u003c/p\u003e\r\n\r\n\u003cp\u003eWhichever situation you\u0026rsquo;re in, you\u0026rsquo;ll see that you\u0026rsquo;ll be able to quickly get started with the package. This section will quickly go over the three options and explain how you can load (or create) in the data that you need to get started!\u003c/p\u003e\r\n\r\n\u003cdiv class=\"section level4\" id=\"built-in-datasets\"\u003e\r\n\u003ch3\u003eBuilt-in Datasets\u003c/h3\u003e\r\n\r\n\u003cp\u003eIf you have some previous experience with the Keras package in Python, you probably will have already accessed the \u003ca href=\"https://github.com/fchollet/keras/tree/master/keras/datasets\"\u003eKeras built-in datasets\u003c/a\u003e with functions such as \u003ccode\u003emnist.load_data()\u003c/code\u003e, \u003ccode\u003ecifar10.load_data()\u003c/code\u003e, or \u003ccode\u003eimdb.load_data()\u003c/code\u003e.\u003c/p\u003e\r\n\r\n\u003cp\u003eHere are some examples where you load in the MNIST, CIFAR10 and IMDB data with the \u003ccode\u003ekeras\u003c/code\u003e package:\u003c/p\u003e\r\n\r\n\u003cpre\u003e\r\n\u003ccode\u003e# Read in MNIST data\r\nmnist \u0026lt;- dataset_mnist()\r\n\r\n# Read in CIFAR10 data\r\ncifar10 \u0026lt;- dataset_cifar10()\r\n\r\n# Read in IMDB data\r\nimdb \u0026lt;- dataset_imdb()\u003c/code\u003e\u003c/pre\u003e\r\n\r\n\u003cp\u003e\u003cstrong\u003eNote\u003c/strong\u003e that all functions to load in built-in data sets with \u003ccode\u003ekeras\u003c/code\u003e follow the same pattern; For MNIST data, you\u0026rsquo;ll use the \u003ccode\u003edataset_mnist()\u003c/code\u003e function to load in your data.\u003c/p\u003e\r\n\u003c/div\u003e\r\n\r\n\u003cdiv class=\"section level4\" id=\"dummy-data\"\u003e\r\n\u003ch3\u003eDummy Data\u003c/h3\u003e\r\n\r\n\u003cp\u003eAlternatively, you can also quickly make some dummy data to get started. You can easily use the \u003ccode\u003ematrix()\u003c/code\u003e function to accomplish this:\u003c/p\u003e\r\n\r\n\u003cdiv data-datacamp-exercise=\"\" data-encoded=\"true\" data-height=\"300\"\u003eeyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiIjIE1ha2UgeW91ciBkdW1teSBkYXRhXG5kYXRhIDwtIG1hdHJpeChyZXhwKDEwMDAqNzg0KSwgbnJvdyA9IDEwMDAsIG5jb2wgPSA3ODQpXG5cbiMgTWFrZSBkdW1teSB0YXJnZXQgdmFsdWVzIGZvciB5b3VyIGR1bW15IGRhdGFcbmxhYmVscyA8LSBtYXRyaXgocm91bmQocnVuaWYoMTAwMCoxMCwgbWluID0gMCwgbWF4ID0gOSkpLCBucm93ID0gMTAwMCwgbmNvbCA9IDEwKSJ9\u003c/div\u003e\r\n\r\n\u003cp\u003e\u003cstrong\u003eNote\u003c/strong\u003e that it\u0026rsquo;s definitely a good idea to check out the data structure of your data; It\u0026rsquo;s very important to already be aware of what data you\u0026rsquo;re working with because it will be important for the later steps that you\u0026rsquo;ll need to take. You\u0026rsquo;ll learn more about this later on in the tutorial!\u003c/p\u003e\r\n\u003c/div\u003e\r\n\r\n\u003cdiv class=\"section level4\" id=\"reading-data-from-files\"\u003e\r\n\u003ch3\u003eReading Data From Files\u003c/h3\u003e\r\n\r\n\u003cp\u003eBesides the built-in datasets, you can also load in data from files. For this tutorial, you\u0026rsquo;ll focus on loading in data from CSV files, but if you want to know more about importing files in R, consider DataCamp\u0026rsquo;s \u003ca href=\"https://www.datacamp.com/community/tutorials/r-data-import-tutorial\"\u003eR Data Import Tutorial\u003c/a\u003e.\u003c/p\u003e\r\n\r\n\u003cp\u003eLet\u0026rsquo;s use the \u003ccode\u003eread.csv()\u003c/code\u003e function from the \u003ccode\u003eread.table\u003c/code\u003e package to load in a data set from the \u003ca href=\"http://archive.ics.uci.edu/ml/index.php\"\u003eUCI Machine Learning Repository\u003c/a\u003e:\u003c/p\u003e\r\n\r\n\u003cdiv data-datacamp-exercise=\"\" data-encoded=\"true\" data-height=\"300\"\u003eeyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiIjIFJlYWQgaW4gYGlyaXNgIGRhdGFcbmlyaXMgPC0gcmVhZC5jc3YodXJsKFwiaHR0cDovL2FyY2hpdmUuaWNzLnVjaS5lZHUvbWwvbWFjaGluZS1sZWFybmluZy1kYXRhYmFzZXMvaXJpcy9pcmlzLmRhdGFcIiksIGhlYWRlciA9IEZBTFNFKSBcblxuIyBSZXR1cm4gdGhlIGZpcnN0IHBhcnQgb2YgYGlyaXNgXG5oZWFkKC4uLi4pXG5cbiMgSW5zcGVjdCB0aGUgc3RydWN0dXJlXG5zdHIoLi4uLilcblxuIyBPYnRhaW4gdGhlIGRpbWVuc2lvbnNcbmRpbSguLi4uKSIsInNvbHV0aW9uIjoiIyBSZWFkIGluIGBpcmlzYCBkYXRhXG5pcmlzIDwtIHJlYWQuY3N2KHVybChcImh0dHA6Ly9hcmNoaXZlLmljcy51Y2kuZWR1L21sL21hY2hpbmUtbGVhcm5pbmctZGF0YWJhc2VzL2lyaXMvaXJpcy5kYXRhXCIpLCBoZWFkZXIgPSBGQUxTRSkgXG5cbiMgUmV0dXJuIHRoZSBmaXJzdCBwYXJ0IG9mIGBpcmlzYFxuaGVhZChpcmlzKVxuXG4jIEluc3BlY3QgdGhlIHN0cnVjdHVyZVxuc3RyKGlyaXMpXG5cbiMgT2J0YWluIHRoZSBkaW1lbnNpb25zXG5kaW0oaXJpcykiLCJzY3QiOiJtc2dfdW5kZWZpbmVkIDwtIFwiRGlkIHlvdSBsb2FkIGluIHRoZSBpcmlzIGRhdGEgY29ycmVjdGx5P1wiXG5leCgpICU+JSBjaGVja19vYmplY3QoJ2lyaXMnLCBtc2dfdW5kZWZpbmVkKSAlPiUgY2hlY2tfZXF1YWwobXNnX3VuZGVmaW5lZClcbmV4KCkgJT4lIGNoZWNrX2Z1bmN0aW9uKFwiaGVhZFwiKSAlPiUgY2hlY2tfcmVzdWx0KCkgJT4lIGNoZWNrX2VxdWFsKClcbmV4KCkgJT4lIGNoZWNrX2Z1bmN0aW9uKFwic3RyXCIpICU+JSBjaGVja19yZXN1bHQoKSAlPiUgY2hlY2tfZXF1YWwoKVxuZXgoKSAlPiUgY2hlY2tfZnVuY3Rpb24oXCJkaW1cIikgJT4lIGNoZWNrX3Jlc3VsdCgpICU+JSBjaGVja19lcXVhbCgpXG5zdWNjZXNzX21zZyhcIkdyZWF0IGpvYiEgTm93LCBkb2VzIHRoaXMgcmVzdWx0IGNvbmZpcm0geW91ciBpbml0aWFsIGh5cG90aGVzaXMgb2YgYSBwb3NpdGl2ZSBpbmRpY2F0aW9uIGJldHdlZW4gdGhlc2UgdHdvIGF0dHJpYnV0ZXM/XCIpIn0=\u003c/div\u003e\r\n\r\n\u003cp\u003eIt\u0026rsquo;s always a good idea to check out whether your data import was successful. You usually use functions such as \u003ccode\u003ehead()\u003c/code\u003e, \u003ccode\u003estr()\u003c/code\u003e and \u003ccode\u003edim()\u003c/code\u003e like in the DataCamp Light chunk above to quickly do this.\u003c/p\u003e\r\n\r\n\u003cp\u003eThe results of these three functions do not immediately point out anything out of the ordinary; By looking at the output of the \u003ccode\u003estr()\u003c/code\u003e function, you see that the strings of the \u003ccode\u003eSpecies\u003c/code\u003e column are read in as factors. This is no problem, but it\u0026rsquo;s definitely good to know for the next steps, where you\u0026rsquo;re going to explore and preprocess the data.\u003c/p\u003e\r\n\u003c/div\u003e\r\n\r\n\u003ch2 id=\"explore\"\u003eData Exploration\u003c/h2\u003e\r\n\r\n\u003cp\u003eFor this tutorial, you\u0026rsquo;ll continue to work with the famous \u003ccode\u003eiris\u003c/code\u003e dataset that you imported with the \u003ccode\u003eread.csv()\u003c/code\u003e function.\u003c/p\u003e\r\n\r\n\u003cp\u003eFor those of you who don\u0026rsquo;t have the biology knowledge that is needed to work with this data, here\u0026rsquo;s some background information: all flowers contain a sepal and a petal. The sepal encloses the petals and is typically green and leaf-like, while the petals are typically colored leaves. For the iris flowers, this is just a little bit different, as you can see in the following picture:\u003c/p\u003e\r\n\r\n\u003cp\u003e\u003cimg alt=\"deep learning Python\" src=\"https://s3.amazonaws.com/assets.datacamp.com/blog_assets/iris-machinelearning.png\" /\u003e\u003c/p\u003e\r\n\r\n\u003cp\u003eYou might have already seen in the previous seciton that the \u003ccode\u003eiris\u003c/code\u003e data frame didn\u0026rsquo;t have any column names after the import. Now, for the remainder of the tutorial, that\u0026rsquo;s not too important: even though the \u003ccode\u003eread.csv()\u003c/code\u003e function returns the data in a \u003ccode\u003edata.frame\u003c/code\u003e to you, the data that you\u0026rsquo;ll need to pass to the \u003ccode\u003efit()\u003c/code\u003e function needs to be a matrix or array.\u003c/p\u003e\r\n\r\n\u003cp\u003eSome things to keep in mind about these two data structures that were just mentioned: - Matrices and arrays don\u0026rsquo;t have column names; - Matrices are two-dimensional objects of a single data type; - Arrays are multi-dimensional objects of a single data type;\u003c/p\u003e\r\n\r\n\u003cp\u003e\u003cstrong\u003eTip\u003c/strong\u003e: Check out \u003ca href=\"https://vimeo.com/130411487\"\u003ethis video\u003c/a\u003e if you want a recap of the data structures in R!\u003c/p\u003e\r\n\r\n\u003cp\u003e\u003cstrong\u003eNote\u003c/strong\u003e that the data frame, on the other hand, is a special kind of named list where all elements have the same length. It\u0026rsquo;s a multi-dimensional object that can contain multiple data types. You already saw that this is true when you checked out the structure of the \u003ccode\u003eiris\u003c/code\u003e data frame in the previous section. Knowing this and taking into account that you\u0026rsquo;ll need to work towards a two- or multi-dimensional object of a \u003cem\u003esingle\u003c/em\u003e data type, you should already prepare to do some preprocessing before you start building your neural network!\u003c/p\u003e\r\n\r\n\u003cp\u003eFor now, column names can be handy for exploring purposes and they will most definitely facilitate your understanding of the data, so let\u0026rsquo;s just add some column names with the help of the \u003ccode\u003enames()\u003c/code\u003e function. Next, you can immediately use the \u003ccode\u003eiris\u003c/code\u003e variable in your data exploration! Plot, for example, how the petal length and the petal width correlate with the \u003ccode\u003eplot()\u003c/code\u003e function.\u003c/p\u003e\r\n\r\n\u003cdiv data-datacamp-exercise=\"\" data-encoded=\"true\" data-height=\"300\"\u003eeyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImlyaXMgPC0gcmVhZC5jc3YodXJsKFwiaHR0cDovL2FyY2hpdmUuaWNzLnVjaS5lZHUvbWwvbWFjaGluZS1sZWFybmluZy1kYXRhYmFzZXMvaXJpcy9pcmlzLmRhdGFcIiksIGhlYWRlciA9IEZBTFNFKSAiLCJzYW1wbGUiOiJuYW1lcyhpcmlzKSA8LSBjKFwiU2VwYWwuTGVuZ3RoXCIsIFwiU2VwYWwuV2lkdGhcIiwgXCJQZXRhbC5MZW5ndGhcIiwgXCJQZXRhbC5XaWR0aFwiLCBcIlNwZWNpZXNcIilcblxucGxvdChpcmlzJFBldGFsLkxlbmd0aCwgXG4gICAgIGlyaXMkUGV0YWwuV2lkdGgsIFxuICAgICBwY2g9MjEsIGJnPWMoXCJyZWRcIixcImdyZWVuM1wiLFwiYmx1ZVwiKVt1bmNsYXNzKGlyaXMkU3BlY2llcyldLCBcbiAgICAgeGxhYj1cIlBldGFsIExlbmd0aFwiLCBcbiAgICAgeWxhYj1cIlBldGFsIFdpZHRoXCIpIn0=\u003c/div\u003e\r\n\r\n\u003cp\u003e\u003cstrong\u003eNote\u003c/strong\u003e that you use the \u003ccode\u003eunclass()\u003c/code\u003e function to convert the names of the species, that is, \u0026ldquo;setosa, versicolor\u0026rdquo;, and \u0026ldquo;virginica\u0026rdquo;, to the numeric 1, 2, and 3.\u003c/p\u003e\r\n\r\n\u003cp\u003eNow take a closer look at the result of the plotting function:\u003c/p\u003e\r\n\r\n\u003cp\u003e\u003cimg src=\"https://s3.amazonaws.com/assets.datacamp.com/blog_assets/Correlation+Iris.png\" /\u003e\u003c/p\u003e\r\n\r\n\u003cp\u003eThe graph indicates a positive correlation between the \u003ccode\u003ePetal.Length\u003c/code\u003e and the \u003ccode\u003ePetal.Width\u003c/code\u003e for the different species of the iris flowers. However, this is something that you probably want to test with the \u003ccode\u003ecor()\u003c/code\u003e function, which will give you the overall correlation between all attributes that are included in the data set:\u003c/p\u003e\r\n\r\n\u003cdiv data-datacamp-exercise=\"\" data-encoded=\"true\" data-height=\"300\"\u003eeyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImlyaXMgPC0gcmVhZC5jc3YodXJsKFwiaHR0cDovL2FyY2hpdmUuaWNzLnVjaS5lZHUvbWwvbWFjaGluZS1sZWFybmluZy1kYXRhYmFzZXMvaXJpcy9pcmlzLmRhdGFcIiksIGhlYWRlciA9IEZBTFNFKSBcbm5hbWVzKGlyaXMpIDwtIGMoXCJTZXBhbC5MZW5ndGhcIiwgXCJTZXBhbC5XaWR0aFwiLCBcIlBldGFsLkxlbmd0aFwiLCBcIlBldGFsLldpZHRoXCIsIFwiU3BlY2llc1wiKSIsInNhbXBsZSI6IiMgT3ZlcmFsbCBjb3JyZWxhdGlvbiBiZXR3ZWVuIGBQZXRhbC5MZW5ndGhgIGFuZCBgUGV0YWwuV2lkdGhgIFxuY29yKC4uLi4uLi4uLi4uLi4uLi4uLCBpcmlzJFBldGFsLldpZHRoKSIsInNvbHV0aW9uIjoiIyBPdmVyYWxsIGNvcnJlbGF0aW9uIGJldHdlZW4gYFBldGFsLkxlbmd0aGAgYW5kIGBQZXRhbC5XaWR0aGAgXG5jb3IoaXJpcyRQZXRhbC5MZW5ndGgsIGlyaXMkUGV0YWwuV2lkdGgpIiwic2N0IjoiZXgoKSAlPiUgY2hlY2tfZnVuY3Rpb24oXCJjb3JcIikgJT4lIGNoZWNrX3Jlc3VsdCgpICU+JSBjaGVja19lcXVhbCgpXG5zdWNjZXNzX21zZyhcIkdyZWF0IGpvYiEgTm93LCBkb2VzIHRoaXMgcmVzdWx0IGNvbmZpcm0geW91ciBpbml0aWFsIGh5cG90aGVzaXMgb2YgYSBwb3NpdGl2ZSBpbmRpY2F0aW9uIGJldHdlZW4gdGhlc2UgdHdvIGF0dHJpYnV0ZXM/XCIpIn0=\u003c/div\u003e\r\n\r\n\u003cp\u003eAdditionally, you can use the \u003ccode\u003ecorrplot\u003c/code\u003e package in combination with the \u003ccode\u003ecor()\u003c/code\u003e function to plot the correlations between your data\u0026rsquo;s attributes; In this case, you calculate the overall correlation for all attributes of the \u003ccode\u003eiris\u003c/code\u003e data frame. You store the result of this calculation in a variable \u003ccode\u003eM\u003c/code\u003e and pass it to the \u003ccode\u003ecorrplot()\u003c/code\u003e function.\u003c/p\u003e\r\n\r\n\u003cp\u003eAlso, don\u0026rsquo;t forget to specify a \u003ccode\u003emethod\u003c/code\u003e argument to indicate how you want the data to be plotted!\u003c/p\u003e\r\n\r\n\u003cp\u003eYou can further experiment with the visualization method in the DataCamp Light chunk below:\u003c/p\u003e\r\n\r\n\u003cdiv data-datacamp-exercise=\"\" data-encoded=\"true\" data-height=\"300\"\u003eeyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImxpYnJhcnkoY29ycnBsb3QpXG5pcmlzIDwtIHJlYWQuY3N2KHVybChcImh0dHA6Ly9hcmNoaXZlLmljcy51Y2kuZWR1L21sL21hY2hpbmUtbGVhcm5pbmctZGF0YWJhc2VzL2lyaXMvaXJpcy5kYXRhXCIpLCBoZWFkZXIgPSBGQUxTRSkgXG5uYW1lcyhpcmlzKSA8LSBjKFwiU2VwYWwuTGVuZ3RoXCIsIFwiU2VwYWwuV2lkdGhcIiwgXCJQZXRhbC5MZW5ndGhcIiwgXCJQZXRhbC5XaWR0aFwiLCBcIlNwZWNpZXNcIikiLCJzYW1wbGUiOiIjIFN0b3JlIHRoZSBvdmVyYWxsIGNvcnJlbGF0aW9uIGluIGBNYFxuTSA8LSBjb3IoaXJpc1ssMTo0XSlcblxuIyBQbG90IHRoZSBjb3JyZWxhdGlvbiBwbG90IHdpdGggYE1gXG5jb3JycGxvdChNLCBtZXRob2Q9XCJjaXJjbGVcIikifQ==\u003c/div\u003e\r\n\r\n\u003cp\u003e\u003cimg src=\"https://s3.amazonaws.com/assets.datacamp.com/blog_assets/Correlation+Plot.png\" /\u003e\u003c/p\u003e\r\n\r\n\u003cp\u003eMake use of the R console to explore your data further.\u003c/p\u003e\r\n\r\n\u003cp\u003eIf you want to make plots for this data with the \u003ccode\u003eggvis\u003c/code\u003e package, which is the interactive grammar of graphics, take a look at DataCamp\u0026rsquo;s \u003ca href=\"https://www.datacamp.com/community/tutorials/machine-learning-in-r\"\u003eMachine Learning in R For Beginners\u003c/a\u003e tutorial or take DataCamp\u0026rsquo;s \u003ca href=\"https://www.datacamp.com/courses/ggvis-data-visualization-r-tutorial/\"\u003eggvis course\u003c/a\u003e.\u003c/p\u003e\r\n\r\n\u003ch2 id=\"prep\"\u003eData Preprocessing\u003c/h2\u003e\r\n\r\n\u003cp\u003eBefore you can build your model, you also need to make sure that your data is cleaned, normalized (if applicable) and divided into training and test sets. Since the dataset comes from the UCI Machine Learning Repository, you can expect it to already be somewhat clean, but let\u0026rsquo;s double check the quality of your data anyway.\u003c/p\u003e\r\n\r\n\u003cp\u003eAt first sight, when you inspected the data with \u003ccode\u003ehead()\u003c/code\u003e, you didn\u0026rsquo;t really see anything out of the ordinary, right? Let\u0026rsquo;s make use of \u003ccode\u003esummary()\u003c/code\u003e and \u003ccode\u003estr()\u003c/code\u003e to briefly recap what you learned when you checked whether the import of your data was successful:\u003c/p\u003e\r\n\r\n\u003cdiv data-datacamp-exercise=\"\" data-encoded=\"true\" data-height=\"300\"\u003eeyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImlyaXMgPC0gcmVhZC5jc3YodXJsKFwiaHR0cDovL2FyY2hpdmUuaWNzLnVjaS5lZHUvbWwvbWFjaGluZS1sZWFybmluZy1kYXRhYmFzZXMvaXJpcy9pcmlzLmRhdGFcIiksIGhlYWRlciA9IEZBTFNFKSBcbm5hbWVzKGlyaXMpIDwtIGMoXCJTZXBhbC5MZW5ndGhcIiwgXCJTZXBhbC5XaWR0aFwiLCBcIlBldGFsLkxlbmd0aFwiLCBcIlBldGFsLldpZHRoXCIsIFwiU3BlY2llc1wiKSIsInNhbXBsZSI6IiMgUHVsbCB1cCBhIHN1bW1hcnkgb2YgYGlyaXNgXG5zdW1tYXJ5KC4uLi4pXG5cbiMgSW5zcGVjdCB0aGUgc3RydWN0dXJlIG9mIGBpcmlzYFxuc3RyKC4uLi4pIiwic29sdXRpb24iOiIjIFB1bGwgdXAgYSBzdW1tYXJ5IG9mIGBpcmlzYFxuc3VtbWFyeShpcmlzKVxuXG4jIEluc3BlY3QgdGhlIHN0cnVjdHVyZSBvZiBgaXJpc2BcbnN0cihpcmlzKSIsInNjdCI6ImV4KCkgJT4lIGNoZWNrX2Z1bmN0aW9uKFwic3VtbWFyeVwiKSAlPiUgY2hlY2tfcmVzdWx0KCkgJT4lIGNoZWNrX2VxdWFsKClcbmV4KCkgJT4lIGNoZWNrX2Z1bmN0aW9uKFwic3RyXCIpICU+JSBjaGVja19yZXN1bHQoKSAlPiUgY2hlY2tfZXF1YWwoKVxuc3VjY2Vzc19tc2coXCJHb29kIGpvYiEgTm93LCB3aGF0IGRvIHlvdSBsZWFybiBmcm9tIHRoZSBvdXRwdXQgb2YgdGhlc2UgbGluZXMgb2YgY29kZT9cIikifQ==\u003c/div\u003e\r\n\r\n\u003cp\u003eNow that you\u0026rsquo;re sure that the data is clean enough, you can start by checking if the normalization is necessary for any of the data with which you\u0026rsquo;re working for this tutorial.\u003c/p\u003e\r\n\r\n\u003cdiv class=\"section level3\" id=\"normalizing-your-data-with-a-user-defined-function-udf\"\u003e\r\n\u003ch3\u003eNormalizing Your Data With A User Defined Function (UDF)\u003c/h3\u003e\r\n\r\n\u003cp\u003eFrom the result of the \u003ccode\u003esummary()\u003c/code\u003e function in the DataCamp Light chunk above, you see that the Iris data set doesn\u0026rsquo;t need to be normalized: the \u003ccode\u003eSepal.Length\u003c/code\u003e attribute has values that go from \u003ccode\u003e4.3\u003c/code\u003e to \u003ccode\u003e7.9\u003c/code\u003e and \u003ccode\u003eSepal.Width\u003c/code\u003e contains values from \u003ccode\u003e2\u003c/code\u003e to \u003ccode\u003e4.4\u003c/code\u003e, while \u003ccode\u003ePetal.Length\u003c/code\u003e\u0026rsquo;s values range from \u003ccode\u003e1\u003c/code\u003e to \u003ccode\u003e6.9\u003c/code\u003e and \u003ccode\u003ePetal.Width\u003c/code\u003e goes from \u003ccode\u003e0.1\u003c/code\u003e to \u003ccode\u003e2.5\u003c/code\u003e. In other words, all values of all the attributes of the Iris data set are contained within the range of \u003ccode\u003e0.1\u003c/code\u003e and \u003ccode\u003e7.9\u003c/code\u003e, which you can consider acceptable.\u003c/p\u003e\r\n\r\n\u003cp\u003eHowever, it can still be a good idea to study the effect of normalization on your data; You can even go as far as passing the normalized data to your model to see if there is any effect. This is outside the scope of this tutorial, but feel free to try it out on your own! The code is all here in this tutorial :)\u003c/p\u003e\r\n\r\n\u003cp\u003eYou can make your own function to normalize the iris data; In this case, it\u0026rsquo;s a min-max normalization function, which linearly transforms your data to the function \u003cem\u003e(x-min)/(max-min)\u003c/em\u003e. From that perspective, translating this formula to R is pretty simple: you make a function to which you pass \u003ccode\u003ex\u003c/code\u003e or some data. You\u0026rsquo;ll then calculate the result of the first subtraction \u003cem\u003ex-min\u003c/em\u003e and store the result in \u003ccode\u003enum\u003c/code\u003e. Next, you also calculate \u003cem\u003emax-min\u003c/em\u003e and store the result in \u003ccode\u003edenom\u003c/code\u003e. The result of your \u003ccode\u003enormalize()\u003c/code\u003e function should return the division of \u003ccode\u003enum\u003c/code\u003e by \u003ccode\u003emax\u003c/code\u003e.\u003c/p\u003e\r\n\r\n\u003cp\u003eTo apply this user-defined function on your \u003ccode\u003eiris\u003c/code\u003e data (target values excluded), you need to not only use \u003ccode\u003enormalize\u003c/code\u003e, but also the \u003ccode\u003elapply()\u003c/code\u003e function to normalize the data, just like here below:\u003c/p\u003e\r\n\r\n\u003cdiv data-datacamp-exercise=\"\" data-encoded=\"true\" data-height=\"300\"\u003eeyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImlyaXMgPC0gcmVhZC5jc3YodXJsKFwiaHR0cDovL2FyY2hpdmUuaWNzLnVjaS5lZHUvbWwvbWFjaGluZS1sZWFybmluZy1kYXRhYmFzZXMvaXJpcy9pcmlzLmRhdGFcIiksIGhlYWRlciA9IEZBTFNFKSBcbm5hbWVzKGlyaXMpIDwtIGMoXCJTZXBhbC5MZW5ndGhcIiwgXCJTZXBhbC5XaWR0aFwiLCBcIlBldGFsLkxlbmd0aFwiLCBcIlBldGFsLldpZHRoXCIsIFwiU3BlY2llc1wiKSIsInNhbXBsZSI6IiMgQnVpbGQgeW91ciBvd24gYG5vcm1hbGl6ZSgpYCBmdW5jdGlvblxubm9ybWFsaXplIDwtIGZ1bmN0aW9uKHgpIHtcbiAgbnVtIDwtIHggLSBtaW4oeClcbiAgZGVub20gPC0gbWF4KHgpIC0gbWluKHgpXG4gIHJldHVybiAobnVtL2Rlbm9tKVxufVxuXG4jIE5vcm1hbGl6ZSB0aGUgYGlyaXNgIGRhdGFcbmlyaXNfbm9ybSA8LSBhcy5kYXRhLmZyYW1lKGxhcHBseShpcmlzWzE6NF0sIC4uLi4uLi4uLikpXG5cbiMgUmV0dXJuIHRoZSBmaXJzdCBwYXJ0IG9mIGBpcmlzYCBcbmhlYWQoLi4uLikiLCJzb2x1dGlvbiI6IiMgQnVpbGQgeW91ciBvd24gYG5vcm1hbGl6ZSgpYCBmdW5jdGlvblxubm9ybWFsaXplIDwtIGZ1bmN0aW9uKHgpIHtcbiAgbnVtIDwtIHggLSBtaW4oeClcbiAgZGVub20gPC0gbWF4KHgpIC0gbWluKHgpXG4gIHJldHVybiAobnVtL2Rlbm9tKVxufVxuXG4jIE5vcm1hbGl6ZSB0aGUgYGlyaXNgIGRhdGFcbmlyaXNfbm9ybSA8LSBhcy5kYXRhLmZyYW1lKGxhcHBseShpcmlzWzE6NF0sIG5vcm1hbGl6ZSkpXG5cbiMgUmV0dXJuIHRoZSBmaXJzdCBwYXJ0IG9mIGBpcmlzYCBcbmhlYWQoaXJpcykiLCJzY3QiOiJtc2dfdW5kZWZpbmVkIDwtIFwiTWFrZSBzdXJlIHRvIGRlZmluZSBhIHZhcmlhYmxlIGBpcmlzX25vcm1gLlwiXG5tc2dfaW5jb3JyZWN0IDwtIFwiTWFrZSBzdXJlIHRoYXQgeW91IGFzc2lnbiB0aGUgY29ycmVjdCB2YWx1ZSB0byBgaXJpc19ub3JtYC5cIlxuXG5mdW5fZGVmIDwtIGV4KCkgJT4lIGNoZWNrX2Z1bl9kZWYoXCJub3JtYWxpemVcIilcbmZ1bl9kZWYgJT4lIGNoZWNrX2JvZHkoKVxuZXgoKSAlPiUgY2hlY2tfb2JqZWN0KCdpcmlzX25vcm0nLCBtc2dfdW5kZWZpbmVkKSAlPiUgY2hlY2tfZXF1YWwobXNnX2luY29ycmVjdClcbmV4KCkgJT4lIGNoZWNrX2Z1bmN0aW9uKFwiaGVhZFwiKSAlPiUgY2hlY2tfcmVzdWx0KCkgJT4lIGNoZWNrX2VxdWFsKClcbnN1Y2Nlc3NfbXNnKFwiV2VsbCBkb25lISBOb3cgeW91IGNhbiBtb3ZlIG9uIHRvIHNlZSBob3cgeW91IGNhbiBub3JtYWxpemUgeW91ciBkYXRhIHdpdGgga2VyYXMhXCIpIn0=\u003c/div\u003e\r\n\r\n\u003cp\u003e\u003cstrong\u003eTip\u003c/strong\u003e use the \u003ccode\u003ehist()\u003c/code\u003e function in the R console to to study the distribution of the Iris data before (\u003ccode\u003eiris\u003c/code\u003e) and after the normalization (\u003ccode\u003eiris_norm\u003c/code\u003e).\u003c/p\u003e\r\n\u003c/div\u003e\r\n\r\n\u003cdiv class=\"section level3\" id=\"normalize-your-data-with-keras\"\u003e\r\n\u003ch3\u003eNormalize Your Data With \u003ccode\u003ekeras\u003c/code\u003e\u003c/h3\u003e\r\n\r\n\u003cp\u003eTo use the \u003ccode\u003enormalize()\u003c/code\u003e function from the \u003ccode\u003ekeras\u003c/code\u003e package, you first need to make sure that you\u0026rsquo;re working with a matrix. As you probably remember from earlier, the characteristic of matrices is that the matrix data elements are of the same basic type; In this case, you have target values that are of type factor, while the rest is all numeric.\u003c/p\u003e\r\n\r\n\u003cp\u003eThis needs to change first.\u003c/p\u003e\r\n\r\n\u003cp\u003eYou can use the \u003ccode\u003eas.numeric()\u003c/code\u003e function to convert the data to numbers:\u003c/p\u003e\r\n\r\n\u003cdiv data-datacamp-exercise=\"\" data-encoded=\"true\" data-height=\"300\"\u003eeyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImlyaXMgPC0gcmVhZC5jc3YodXJsKFwiaHR0cDovL2FyY2hpdmUuaWNzLnVjaS5lZHUvbWwvbWFjaGluZS1sZWFybmluZy1kYXRhYmFzZXMvaXJpcy9pcmlzLmRhdGFcIiksIGhlYWRlciA9IEZBTFNFKSBcbm5hbWVzKGlyaXMpIDwtIGMoXCJTZXBhbC5MZW5ndGhcIiwgXCJTZXBhbC5XaWR0aFwiLCBcIlBldGFsLkxlbmd0aFwiLCBcIlBldGFsLldpZHRoXCIsIFwiU3BlY2llc1wiKSIsInNhbXBsZSI6ImlyaXNbLDVdIDwtIC4uLi4uLi4uLi4uKGlyaXNbLDVdKSAtMVxuXG4jIFR1cm4gYGlyaXNgIGludG8gYSBtYXRyaXhcbmlyaXMgPC0gYXMubWF0cml4KGlyaXMpXG5cbiMgU2V0IGBpcmlzYCBgZGltbmFtZXNgIHRvIGBOVUxMYFxuZGltbmFtZXMoLi4uLikgPC0gTlVMTCIsInNvbHV0aW9uIjoiaXJpc1ssNV0gPC0gYXMubnVtZXJpYyhpcmlzWyw1XSkgLTFcblxuIyBUdXJuIGBpcmlzYCBpbnRvIGEgbWF0cml4XG5pcmlzIDwtIGFzLm1hdHJpeChpcmlzKVxuXG4jIFNldCBpcmlzIGBkaW1uYW1lc2AgdG8gYE5VTExgXG5kaW1uYW1lcyhpcmlzKSA8LSBOVUxMIiwic2N0IjoibXNnX3VuZGVmaW5lZCA8LSBcIkRpZCB5b3UgdXNlIGBhcy5udW1lcmljKClgIHRvIGNvbnZlcnQgYGlyaXNbLDVdYCB0byBudW1lcmljP1wiXG5leCgpICU+JSBjaGVja19vYmplY3QoJ2lyaXMnLCBtc2dfdW5kZWZpbmVkKSAlPiUgY2hlY2tfZXF1YWwobXNnX3VuZGVmaW5lZClcbm1zZ191bmRlZmluZWQyIDwtIFwiRGlkIHlvdSB1c2UgYGFzLm1hdHJpeGAgdG8gY29udmVydCBgaXJpc2AgdG8gYSBtYXRyaXg/XCJcbmV4KCkgJT4lIGNoZWNrX29iamVjdCgnaXJpcycsIG1zZ191bmRlZmluZWQyKSAlPiUgY2hlY2tfZXF1YWwobXNnX3VuZGVmaW5lZDIpXG5leCgpICU+JSBjaGVja19mdW5jdGlvbihcImRpbW5hbWVzXCIpICU+JSBjaGVja19yZXN1bHQoKSAlPiUgY2hlY2tfZXF1YWwoKVxuc3VjY2Vzc19tc2coXCJBd2Vzb21lIVwiKSJ9\u003c/div\u003e\r\n\r\n\u003cp\u003eA numerical data frame is alright, but you\u0026rsquo;ll need to convert the data to an array or a matrix if you want to make use of the \u003ccode\u003ekeras\u003c/code\u003e package. You can easily do this with the \u003ccode\u003eas.matrix()\u003c/code\u003e function; Don\u0026rsquo;t forget here to set the \u003ccode\u003edimnames\u003c/code\u003e to \u003ccode\u003eNULL\u003c/code\u003e.\u003c/p\u003e\r\n\r\n\u003cp\u003eAs you might have read in the section above, normalizing the Iris data is not necessary. Nevertheless, it\u0026rsquo;s still a good idea to study normalization and its effect, and to see how this can not only be done with a UDF but also with the \u003ccode\u003ekeras\u003c/code\u003e built-in \u003ccode\u003enormalize()\u003c/code\u003e function.\u003c/p\u003e\r\n\r\n\u003cp\u003eWith your data converted to a matrix, you can indeed also use the \u003ccode\u003ekeras\u003c/code\u003e package to study the effect of a possible normalization on your data:\u003c/p\u003e\r\n\r\n\u003cdiv data-datacamp-exercise=\"\" data-encoded=\"true\" data-height=\"300\"\u003eeyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImxpYnJhcnkoa2VyYXMpXG5pcmlzIDwtIHJlYWQuY3N2KHVybChcImh0dHA6Ly9hcmNoaXZlLmljcy51Y2kuZWR1L21sL21hY2hpbmUtbGVhcm5pbmctZGF0YWJhc2VzL2lyaXMvaXJpcy5kYXRhXCIpLCBoZWFkZXIgPSBGQUxTRSkgXG5uYW1lcyhpcmlzKSA8LSBjKFwiU2VwYWwuTGVuZ3RoXCIsIFwiU2VwYWwuV2lkdGhcIiwgXCJQZXRhbC5MZW5ndGhcIiwgXCJQZXRhbC5XaWR0aFwiLCBcIlNwZWNpZXNcIilcbmlyaXNbLDVdIDwtIGFzLm51bWVyaWMoaXJpc1ssNV0pIC0xXG5pcmlzIDwtIGFzLm1hdHJpeChpcmlzKVxuZGltbmFtZXMoaXJpcykgPC0gTlVMTCIsInNhbXBsZSI6IiMgTm9ybWFsaXplIHRoZSBgaXJpc2AgZGF0YVxuaXJpcyA8LSBub3JtYWxpemUoLi4uLlssMTo0XSlcblxuIyBSZXR1cm4gdGhlIHN1bW1hcnkgb2YgYGlyaXNgXG5zdW1tYXJ5KC4uLi4pIiwic29sdXRpb24iOiIjIE5vcm1hbGl6ZSB0aGUgYGlyaXNgIGRhdGFcbmlyaXMgPC0gbm9ybWFsaXplKGlyaXNbLDE6NF0pXG5cbiMgUmV0dXJuIHRoZSBzdW1tYXJ5IG9mIGBpcmlzYFxuc3VtbWFyeShpcmlzKSIsInNjdCI6Im1zZ191bmRlZmluZWQgPC0gXCJEaWQgeW91IG5vcm1hbGl6ZSB0aGUgYGlyaXNgIGRhdGE/XCJcbmV4KCkgJT4lIGNoZWNrX29iamVjdChcImlyaXNcIiwgbXNnX3VuZGVmaW5lZCkgJT4lIGNoZWNrX2VxdWFsKG1zZ191bmRlZmluZWQpXG5leCgpICU+JSBjaGVja19mdW5jdGlvbihcInN1bW1hcnlcIikgJT4lIGNoZWNrX3Jlc3VsdCgpICU+JSBjaGVja19lcXVhbCgpXG5zdWNjZXNzX21zZyhcIkF3ZXNvbWUhIE5vdywgaG93IGRvZXMgdGhpcyBzdW1tYXJ5IGNvbXBhcmUgdG8gdGhlIHByZXZpb3VzIHN1bW1hcnkgdGhhdCB5b3UgcmV0cmlldmVkIGluIHRoZSBEYXRhQ2FtcCBMaWdodCBjaHVuayBhYm92ZT9cIikifQ==\u003c/div\u003e\r\n\r\n\u003cp\u003e\u003cstrong\u003eNote\u003c/strong\u003e that here, you use \u003ccode\u003edimnames()\u003c/code\u003e to set the dimnames of \u003ccode\u003eiris\u003c/code\u003e to \u003ccode\u003eNULL\u003c/code\u003e. This ensures that there are no column names in your data.\u003c/p\u003e\r\n\u003c/div\u003e\r\n\r\n\u003cdiv class=\"section level3\" id=\"training-and-test-sets\"\u003e\r\n\u003ch3\u003eTraining And Test Sets\u003c/h3\u003e\r\n\r\n\u003cp\u003eNow that you have checked the quality of your data and you know that it\u0026rsquo;s not necessary to normalize your data, you can continue to work with the original data and split it into training and test sets so that you\u0026rsquo;re finally ready to start building your model. By doing this, you ensure that you can make honest assessments of the performance of your predicte model afterwards.\u003c/p\u003e\r\n\r\n\u003cp\u003eBefore you split your data into training and test sets, you best first set a seed. You can easily do this with \u003ccode\u003eset.seed()\u003c/code\u003e: use this exact function and just pass a random integer to it. A seed is a number of R\u0026rsquo;s random number generator. The major advantage of setting a seed is that you can get the same sequence of random numbers whenever you supply the same seed in the random number generator.\u003c/p\u003e\r\n\r\n\u003cp\u003eThis is great for the reproducibility of your code!\u003c/p\u003e\r\n\r\n\u003cp\u003eYou use the \u003ccode\u003esample()\u003c/code\u003e function to take a sample with a size that is set as the number of rows of the Iris data set, or 150. You sample with replacement: you choose from a vector of 2 elements and assign either 1 or 2 to the 150 rows of the Iris data set. The assignment of the elements is subject to probability weights of \u003ccode\u003e0.67\u003c/code\u003e and \u003ccode\u003e0.33\u003c/code\u003e.\u003c/p\u003e\r\n\r\n\u003cdiv data-datacamp-exercise=\"\" data-encoded=\"true\" data-height=\"300\"\u003eeyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6InNldC5zZWVkKDEyMzQpXG5saWJyYXJ5KGtlcmFzKVxuaXJpcyA8LSByZWFkLmNzdih1cmwoXCJodHRwOi8vYXJjaGl2ZS5pY3MudWNpLmVkdS9tbC9tYWNoaW5lLWxlYXJuaW5nLWRhdGFiYXNlcy9pcmlzL2lyaXMuZGF0YVwiKSwgaGVhZGVyID0gRkFMU0UpIFxubmFtZXMoaXJpcykgPC0gYyhcIlNlcGFsLkxlbmd0aFwiLCBcIlNlcGFsLldpZHRoXCIsIFwiUGV0YWwuTGVuZ3RoXCIsIFwiUGV0YWwuV2lkdGhcIiwgXCJTcGVjaWVzXCIpXG5pcmlzWyw1XSA8LSBhcy5udW1lcmljKGlyaXNbLDVdKSAtMVxuaXJpcyA8LSBhcy5tYXRyaXgoaXJpcylcbmRpbW5hbWVzKGlyaXMpIDwtIE5VTEwiLCJzYW1wbGUiOiIjIERldGVybWluZSBzYW1wbGUgc2l6ZVxuaW5kIDwtIHNhbXBsZSgyLCBucm93KC4uLi4pLCByZXBsYWNlPVRSVUUsIHByb2I9YygwLjY3LCAwLjMzKSlcblxuIyBTcGxpdCB0aGUgYGlyaXNgIGRhdGFcbmlyaXMudHJhaW5pbmcgPC0gLi4uLltpbmQ9PTEsIDE6NF1cbmlyaXMudGVzdCA8LSBpcmlzW2luZD09MiwgMTo0XVxuXG4jIFNwbGl0IHRoZSBjbGFzcyBhdHRyaWJ1dGVcbmlyaXMudHJhaW5pbmd0YXJnZXQgPC0gaXJpc1suLi49PTEsIDVdXG5pcmlzLnRlc3R0YXJnZXQgPC0gaXJpc1tpbmQ9PTIsIDVdIiwic29sdXRpb24iOiIjIERldGVybWluZSBzYW1wbGUgc2l6ZVxuaW5kIDwtIHNhbXBsZSgyLCBucm93KGlyaXMpLCByZXBsYWNlPVRSVUUsIHByb2I9YygwLjY3LCAwLjMzKSlcblxuIyBTcGxpdCB0aGUgYGlyaXNgIGRhdGFcbmlyaXMudHJhaW5pbmcgPC0gaXJpc1tpbmQ9PTEsIDE6NF1cbmlyaXMudGVzdCA8LSBpcmlzW2luZD09MiwgMTo0XVxuXG4jIFNwbGl0IHRoZSBjbGFzcyBhdHRyaWJ1dGVcbmlyaXMudHJhaW5pbmd0YXJnZXQgPC0gaXJpc1tpbmQ9PTEsIDVdXG5pcmlzLnRlc3R0YXJnZXQgPC0gaXJpc1tpbmQ9PTIsIDVdIiwic2N0IjoibXNnX3VuZGVmaW5lZCA8LSBcIkRpZCB5b3UgZGVmaW5lIGBpbmRgP1wiXG5tc2dfdW5kZWZpbmVkMSA8LSBcIkRpZCB5b3Ugc3BsaXQgdGhlIGBpcmlzYCBkYXRhIGludG8gYSB0cmFpbmluZyBzZXQ/XCJcbm1zZ191bmRlZmluZWQyIDwtIFwiRGlkIHlvdSBzcGxpdCB0aGUgYGlyaXNgIGRhdGEgaW50byBhIHRlc3Qgc2V0P1wiXG5tc2dfdW5kZWZpbmVkMyA8LSBcIkRpZCB5b3UgaXNvbGF0ZSB0aGUgYGlyaXNgIHRyYWluaW5nIGxhYmVscz9cIlxubXNnX3VuZGVmaW5lZDQgPC0gXCJEaWQgeW91IGlzb2xhdGUgdGhlIGBpcmlzYCB0ZXN0IGxhYmVscz9cIlxuZXgoKSAlPiUgY2hlY2tfb2JqZWN0KCdpbmQnLCBtc2dfdW5kZWZpbmVkKSAlPiUgY2hlY2tfZXF1YWwobXNnX3VuZGVmaW5lZClcbmV4KCkgJT4lIGNoZWNrX29iamVjdCgnaXJpcy50cmFpbmluZycsIG1zZ191bmRlZmluZWQxKSAlPiUgY2hlY2tfZXF1YWwobXNnX3VuZGVmaW5lZDEpXG5leCgpICU+JSBjaGVja19vYmplY3QoJ2lyaXMudGVzdCcsIG1zZ191bmRlZmluZWQyKSAlPiUgY2hlY2tfZXF1YWwobXNnX3VuZGVmaW5lZDIpXG5leCgpICU+JSBjaGVja19vYmplY3QoJ2lyaXMudHJhaW5pbmd0YXJnZXQnLCBtc2dfdW5kZWZpbmVkMykgJT4lIGNoZWNrX2VxdWFsKG1zZ191bmRlZmluZWQzKVxuZXgoKSAlPiUgY2hlY2tfb2JqZWN0KCdpcmlzLnRlc3R0YXJnZXQnLCBtc2dfdW5kZWZpbmVkNCkgJT4lIGNoZWNrX2VxdWFsKG1zZ191bmRlZmluZWQ0KVxuc3VjY2Vzc19tc2coXCJXZWxsIGRvbmUhIElmIHlvdSB3YW50LCBtYWtlIHVzZSBvZiB0aGUgUiBjb25zb2xlIHRvIGNoZWNrIG91dCB5b3VyIG5ld2x5IGNyZWF0ZWQgdHJhaW5pbmcgYW5kIHRlc3Qgc2V0cyFcIikifQ==\u003c/div\u003e\r\n\r\n\u003cp\u003eThe \u003ccode\u003ereplace\u003c/code\u003e argument of the \u003ccode\u003esample()\u003c/code\u003e function is set to \u003ccode\u003eTRUE\u003c/code\u003e, which means that you assign a \u003ccode\u003e1\u003c/code\u003e or a \u003ccode\u003e2\u003c/code\u003e to a certain row and then reset the vector of \u003ccode\u003e2\u003c/code\u003e to its original state.\u003c/p\u003e\r\n\r\n\u003cp\u003eIn other words, for the next rows in your data set, you can either assign a \u003ccode\u003e1\u003c/code\u003e or a \u003ccode\u003e2\u003c/code\u003e, each time again. The probability of choosing a \u003ccode\u003e1\u003c/code\u003e or a \u003ccode\u003e2\u003c/code\u003e should not be proportional to the weights amongst the remaining items, so you specify probability weights.\u003c/p\u003e\r\n\r\n\u003cp\u003e\u003cem\u003eSide note:\u003c/em\u003e if you would have used a built-in dataset with the specific \u003ccode\u003edataset_imdb()\u003c/code\u003e function, for example, your data can easily be split by using the \u003ccode\u003e$\u003c/code\u003e operator:\u003c/p\u003e\r\n\r\n\u003cpre\u003e\r\n\u003ccode\u003ex_train \u0026lt;- imdb$train$x\r\ny_train \u0026lt;- imdb$train$y\r\nx_test \u0026lt;- imdb$test$x\r\ny_test \u0026lt;- imdb$test$y\u003c/code\u003e\u003c/pre\u003e\r\n\u003c/div\u003e\r\n\r\n\u003cdiv class=\"section level3\" id=\"one-hot-encoding\"\u003e\r\n\u003ch3\u003eOne-Hot Encoding\u003c/h3\u003e\r\n\r\n\u003cp\u003eYou have successfully split your data but there is still one step that you need to go through to start building your model. Can you guess which one?\u003c/p\u003e\r\n\r\n\u003cp\u003eWhen you want to model multi-class classification problems with neural networks, it is generally a good practice to make sure that you transform your target attribute from a vector that contains values for each class value to a matrix with a boolean for each class value and whether or not a given instance has that class value or not.\u003c/p\u003e\r\n\r\n\u003cp\u003eThis is a loose explanation of One Hot Encoding (OHE). It sounds quite complex, doesn\u0026rsquo;t it?\u003c/p\u003e\r\n\r\n\u003cp\u003eLuckily, the \u003ccode\u003ekeras\u003c/code\u003e package has a \u003ccode\u003eto_categorical()\u003c/code\u003e function that will do all of this for you; Pass in the \u003ccode\u003eiris.trainingtarget\u003c/code\u003e and the \u003ccode\u003eiris.testtarget\u003c/code\u003e to this function and store the result in \u003ccode\u003eiris.trainLabels\u003c/code\u003e and \u003ccode\u003eiris.testLabels\u003c/code\u003e:\u003c/p\u003e\r\n\r\n\u003cdiv data-datacamp-exercise=\"\" data-encoded=\"true\" data-height=\"300\"\u003eeyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6InNldC5zZWVkKDEyMzQpXG5saWJyYXJ5KGtlcmFzKVxuaXJpcyA8LSByZWFkLmNzdih1cmwoXCJodHRwOi8vYXJjaGl2ZS5pY3MudWNpLmVkdS9tbC9tYWNoaW5lLWxlYXJuaW5nLWRhdGFiYXNlcy9pcmlzL2lyaXMuZGF0YVwiKSwgaGVhZGVyID0gRkFMU0UpIFxubmFtZXMoaXJpcykgPC0gYyhcIlNlcGFsLkxlbmd0aFwiLCBcIlNlcGFsLldpZHRoXCIsIFwiUGV0YWwuTGVuZ3RoXCIsIFwiUGV0YWwuV2lkdGhcIiwgXCJTcGVjaWVzXCIpXG5pcmlzWyw1XSA8LSBhcy5udW1lcmljKGlyaXNbLDVdKSAtMVxuaXJpcyA8LSBhcy5tYXRyaXgoaXJpcylcbmRpbW5hbWVzKGlyaXMpIDwtIE5VTExcbmluZCA8LSBzYW1wbGUoMiwgbnJvdyhpcmlzKSwgcmVwbGFjZT1UUlVFLCBwcm9iPWMoMC42NywgMC4zMykpXG5pcmlzLnRyYWluaW5nIDwtIGlyaXNbaW5kPT0xLCAxOjRdXG5pcmlzLnRlc3QgPC0gaXJpc1tpbmQ9PTIsIDE6NF1cbmlyaXMudHJhaW5pbmd0YXJnZXQgPC0gaXJpc1tpbmQ9PTEsNV1cbmlyaXMudGVzdHRhcmdldCA8LSBpcmlzW2luZD09MiwgNV0iLCJzYW1wbGUiOiIjIE9uZSBob3QgZW5jb2RlIHRyYWluaW5nIHRhcmdldCB2YWx1ZXNcbmlyaXMudHJhaW5MYWJlbHMgPC0gdG9fY2F0ZWdvcmljYWwoLi4uLi4uLi4uLi4uLi4uLi4uKVxuXG4jIE9uZSBob3QgZW5jb2RlIHRlc3QgdGFyZ2V0IHZhbHVlc1xuaXJpcy50ZXN0TGFiZWxzIDwtIHRvX2NhdGVnb3JpY2FsKC4uLi4uLi4uLi4uLi4uLilcblxuIyBQcmludCBvdXQgdGhlIGlyaXMudGVzdExhYmVscyB0byBkb3VibGUgY2hlY2sgdGhlIHJlc3VsdFxucHJpbnQoLi4uLi4uLi4uLi4uLikiLCJzb2x1dGlvbiI6IiMgT25lIGhvdCBlbmNvZGUgdHJhaW5pbmcgdGFyZ2V0IHZhbHVlc1xuaXJpcy50cmFpbkxhYmVscyA8LSB0b19jYXRlZ29yaWNhbChpcmlzLnRyYWluaW5ndGFyZ2V0KVxuXG4jIE9uZSBob3QgZW5jb2RlIHRlc3QgdGFyZ2V0IHZhbHVlc1xuaXJpcy50ZXN0TGFiZWxzIDwtIHRvX2NhdGVnb3JpY2FsKGlyaXMudGVzdHRhcmdldClcblxuIyBQcmludCBvdXQgdGhlIGlyaXMudGVzdExhYmVscyB0byBkb3VibGUgY2hlY2sgdGhlIHJlc3VsdFxucHJpbnQoaXJpcy50ZXN0TGFiZWxzKSIsInNjdCI6Im1zZ191bmRlZmluZWQgPC0gXCJEaWQgeW91IHBhc3MgYGlyaXMudHJhaW5pbmd0YXJnZXRgIHRvIHRoZSBgdG9fY2F0ZWdvcmljYWwoKWAgZnVuY3Rpb24/XCJcbm1zZ191bmRlZmluZWQyIDwtIFwiRGlkIHlvdSBwYXNzIGBpcmlzLnRlc3R0YXJnZXRgIHRvIHRoZSBgdG9fY2F0ZWdvcmljYWwoKWAgZnVuY3Rpb24/XCJcbmV4KCkgJT4lIGNoZWNrX29iamVjdCgnaXJpcy50cmFpbkxhYmVscycsIG1zZ191bmRlZmluZWQpICU+JSBjaGVja19lcXVhbChtc2dfdW5kZWZpbmVkKVxuZXgoKSAlPiUgY2hlY2tfb2JqZWN0KCdpcmlzLnRlc3RMYWJlbHMnLCBtc2dfdW5kZWZpbmVkMikgJT4lIGNoZWNrX2VxdWFsKG1zZ191bmRlZmluZWQyKVxuZXgoKSAlPiUgY2hlY2tfZnVuY3Rpb24oXCJwcmludFwiKSAlPiUgY2hlY2tfcmVzdWx0KCkgJT4lIGNoZWNrX2VxdWFsKClcbnN1Y2Nlc3NfbXNnKFwiR29vZCBqb2IhIERvdWJsZSBjaGVjayB0aGUgcHJpbnQtb3V0IG9mIGBpcmlzLnRlc3RMYWJlbHNgIHRvIHNlZSBob3cgb25lLWhvdCBlbmNvZGluZyB3b3JrcyFcIikifQ==\u003c/div\u003e\r\n\r\n\u003cp\u003eNow you have officially reached the end of the exploration and preprocessing steps in this tutorial. You can now go on to building your neural network with \u003ccode\u003ekeras\u003c/code\u003e!\u003c/p\u003e\r\n\u003c/div\u003e\r\n\r\n\u003ch2 id=\"model\"\u003eConstructing the Model\u003c/h2\u003e\r\n\r\n\u003cp\u003eTo start constructing a model, you should first initialize a sequential model with the help of the \u003ccode\u003ekeras_model_sequential()\u003c/code\u003e function. Then, you\u0026rsquo;re ready to start modeling.\u003c/p\u003e\r\n\r\n\u003cp\u003eHowever, before you begin, it\u0026rsquo;s a good idea to revisit your original question about this data set: can you predict the species of a certain Iris flower? It\u0026rsquo;s easier to work with numerical data and you have preprocessed the data and one hot encoded the values of the target variable: a flower is either of type versicolor, setosa or virginica and this is reflected with binary \u003ccode\u003e1\u003c/code\u003e and \u003ccode\u003e0\u003c/code\u003e values.\u003c/p\u003e\r\n\r\n\u003cp\u003eA type of network that performs well on such a problem is a multi-layer perceptron. This type of neural network is often fully connected. That means that you\u0026rsquo;re looking to build a fairly simple stack of fully-connected layers to solve this problem. As for the activation functions that you will use, it\u0026rsquo;s best to use one of the most common ones here for the purpose of getting familiar with Keras and neural networks, which is the relu activation function. This rectifier activation function is used in a hidden layer, which is generally speaking a good practice.\u003c/p\u003e\r\n\r\n\u003cp\u003eIn addition, you also see that the softmax activation function is used in the output layer. You do this because you want to make sure that the output values are in the range of 0 and 1 and may be used as predicted probabilities:\u003c/p\u003e\r\n\r\n\u003cdiv data-datacamp-exercise=\"\" data-encoded=\"true\" data-height=\"300\"\u003eeyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6InNldC5zZWVkKDEyMzQpXG5saWJyYXJ5KGtlcmFzKVxuaXJpcyA8LSByZWFkLmNzdih1cmwoXCJodHRwOi8vYXJjaGl2ZS5pY3MudWNpLmVkdS9tbC9tYWNoaW5lLWxlYXJuaW5nLWRhdGFiYXNlcy9pcmlzL2lyaXMuZGF0YVwiKSwgaGVhZGVyID0gRkFMU0UpIFxubmFtZXMoaXJpcykgPC0gYyhcIlNlcGFsLkxlbmd0aFwiLCBcIlNlcGFsLldpZHRoXCIsIFwiUGV0YWwuTGVuZ3RoXCIsIFwiUGV0YWwuV2lkdGhcIiwgXCJTcGVjaWVzXCIpXG5pcmlzWyw1XSA8LSBhcy5udW1lcmljKGlyaXNbLDVdKSAtMVxuaXJpcyA8LSBhcy5tYXRyaXgoaXJpcylcbmRpbW5hbWVzKGlyaXMpIDwtIE5VTExcbmluZCA8LSBzYW1wbGUoMiwgbnJvdyhpcmlzKSwgcmVwbGFjZT1UUlVFLCBwcm9iPWMoMC42NywgMC4zMykpXG5pcmlzLnRyYWluaW5nIDwtIGlyaXNbaW5kPT0xLCAxOjRdXG5pcmlzLnRlc3QgPC0gaXJpc1tpbmQ9PTIsIDE6NF1cbmlyaXMudHJhaW5pbmd0YXJnZXQgPC0gaXJpc1tpbmQ9PTEsNV1cbmlyaXMudGVzdHRhcmdldCA8LSBpcmlzW2luZD09MiwgNV1cbmlyaXMudHJhaW5MYWJlbHMgPC0gdG9fY2F0ZWdvcmljYWwoaXJpcy50cmFpbmluZ3RhcmdldClcbmlyaXMudGVzdExhYmVscyA8LSB0b19jYXRlZ29yaWNhbChpcmlzLnRlc3R0YXJnZXQpIiwic2FtcGxlIjoiIyBJbml0aWFsaXplIGEgc2VxdWVudGlhbCBtb2RlbFxubW9kZWwgPC0gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLlxuXG4jIEFkZCBsYXllcnMgdG8gdGhlIG1vZGVsXG5tb2RlbCAlPiUgXG4gICAgbGF5ZXJfZGVuc2UodW5pdHMgPSA4LCBhY3RpdmF0aW9uID0gJ3JlbHUnLCBpbnB1dF9zaGFwZSA9IGMoNCkpICU+JSBcbiAgICBsYXllcl9kZW5zZSh1bml0cyA9IDMsIGFjdGl2YXRpb24gPSAnc29mdG1heCcpIiwic29sdXRpb24iOiIjIEluaXRpYWxpemUgYSBzZXF1ZW50aWFsIG1vZGVsXG5tb2RlbCA8LSBrZXJhc19tb2RlbF9zZXF1ZW50aWFsKCkgXG5cbiMgQWRkIGxheWVycyB0byB0aGUgbW9kZWxcbm1vZGVsICU+JSBcbiAgICBsYXllcl9kZW5zZSh1bml0cyA9IDgsIGFjdGl2YXRpb24gPSAncmVsdScsIGlucHV0X3NoYXBlID0gYyg0KSkgJT4lIFxuICAgIGxheWVyX2RlbnNlKHVuaXRzID0gMywgYWN0aXZhdGlvbiA9ICdzb2Z0bWF4JykiLCJzY3QiOiJtc2dfdW5kZWZpbmVkIDwtIFwiRGlkIHlvdSBpbml0aWFsaXplIGEgc2VxdWVudGlhbCBtb2RlbCB3aXRoIHRoZSBoZWxwIG9mIGBrZXJhc19tb2RlbF9zZXF1ZW50aWFsKClgP1wiXG5tc2dfaW5jb3JyZWN0IDwtIFwiRGlkIHlvdSBrZWVwIHRoZSBwcmVkZWZpbmVkIGxheWVycz9cIlxuZXgoKSAlPiUgY2hlY2tfb2JqZWN0KCdtb2RlbCcsIG1zZ191bmRlZmluZWQpICU+JSBjaGVja19lcXVhbChtc2dfaW5jb3JyZWN0KVxuc3VjY2Vzc19tc2coXCJHb29kIGpvYiEgWW91IGhhdmUgc3VjY2Vzc2Z1bGx5IGNvbnN0cnVjdGVkIGEgbW9kZWwgd2l0aCB0aGUgYGtlcmFzYCBwYWNrYWdlIGluIFIhXCIpIn0=\u003c/div\u003e\r\n\r\n\u003cp\u003e\u003cstrong\u003eNote\u003c/strong\u003e how the output layer creates 3 output values, one for each Iris class (versicolor, virginica or setosa). The first layer, which contains 8 hidden notes, on the other hand, has an \u003ccode\u003einput_shape\u003c/code\u003e of 4. This is because your training data \u003ccode\u003eiris.training\u003c/code\u003e has 4 columns.\u003c/p\u003e\r\n\r\n\u003cp\u003eYou can further inspect your model with the following functions:\u003c/p\u003e\r\n\r\n\u003cul\u003e\r\n\t\u003cli\u003eYou can use the \u003ccode\u003esummary()\u003c/code\u003e function to print a summary representation of your model;\u003c/li\u003e\r\n\t\u003cli\u003e\u003ccode\u003eget_config()\u003c/code\u003e will return a list that contains the configuration of the model;\u003c/li\u003e\r\n\t\u003cli\u003e\u003ccode\u003eget_layer()\u003c/code\u003e will return the layer configuration.\u003c/li\u003e\r\n\t\u003cli\u003e\u003ccode\u003elayers\u003c/code\u003e attribute can be used to retrieve a flattened list of the model\u0026rsquo;s layers;\u003c/li\u003e\r\n\t\u003cli\u003eTo list the input tensors, you can use the \u003ccode\u003einputs\u003c/code\u003e attribute; and\u003c/li\u003e\r\n\t\u003cli\u003eLastly, to retrieve the output tensors, you can make use of the \u003ccode\u003eoutputs\u003c/code\u003e attribute.\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\r\n\u003cdiv data-datacamp-exercise=\"\" data-encoded=\"true\" data-height=\"400\"\u003eeyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6InNldC5zZWVkKDEyMzQpXG5saWJyYXJ5KGtlcmFzKVxuaXJpcyA8LSByZWFkLmNzdih1cmwoXCJodHRwOi8vYXJjaGl2ZS5pY3MudWNpLmVkdS9tbC9tYWNoaW5lLWxlYXJuaW5nLWRhdGFiYXNlcy9pcmlzL2lyaXMuZGF0YVwiKSwgaGVhZGVyID0gRkFMU0UpIFxubmFtZXMoaXJpcykgPC0gYyhcIlNlcGFsLkxlbmd0aFwiLCBcIlNlcGFsLldpZHRoXCIsIFwiUGV0YWwuTGVuZ3RoXCIsIFwiUGV0YWwuV2lkdGhcIiwgXCJTcGVjaWVzXCIpXG5pcmlzWyw1XSA8LSBhcy5udW1lcmljKGlyaXNbLDVdKSAtMVxuaXJpcyA8LSBhcy5tYXRyaXgoaXJpcylcbmRpbW5hbWVzKGlyaXMpIDwtIE5VTExcbmluZCA8LSBzYW1wbGUoMiwgbnJvdyhpcmlzKSwgcmVwbGFjZT1UUlVFLCBwcm9iPWMoMC42NywgMC4zMykpXG5pcmlzLnRyYWluaW5nIDwtIGlyaXNbaW5kPT0xLCAxOjRdXG5pcmlzLnRlc3QgPC0gaXJpc1tpbmQ9PTIsIDE6NF1cbmlyaXMudHJhaW5pbmd0YXJnZXQgPC0gaXJpc1tpbmQ9PTEsNV1cbmlyaXMudGVzdHRhcmdldCA8LSBpcmlzW2luZD09MiwgNV1cbmlyaXMudHJhaW5MYWJlbHMgPC0gdG9fY2F0ZWdvcmljYWwoaXJpcy50cmFpbmluZ3RhcmdldClcbmlyaXMudGVzdExhYmVscyA8LSB0b19jYXRlZ29yaWNhbChpcmlzLnRlc3R0YXJnZXQpXG5tb2RlbCA8LSBrZXJhc19tb2RlbF9zZXF1ZW50aWFsKCkgXG5tb2RlbCAlPiUgXG4gICAgbGF5ZXJfZGVuc2UodW5pdHMgPSA4LCBhY3RpdmF0aW9uID0gJ3JlbHUnLCBpbnB1dF9zaGFwZSA9IGMoNCkpICU+JSBcbiAgICBsYXllcl9kZW5zZSh1bml0cyA9IDMsIGFjdGl2YXRpb24gPSAnc29mdG1heCcpIiwic2FtcGxlIjoiIyBQcmludCBhIHN1bW1hcnkgb2YgYSBtb2RlbFxuc3VtbWFyeShtb2RlbClcblxuIyBHZXQgbW9kZWwgY29uZmlndXJhdGlvblxuZ2V0X2NvbmZpZyhtb2RlbClcblxuIyBHZXQgbGF5ZXIgY29uZmlndXJhdGlvblxuZ2V0X2xheWVyKG1vZGVsLCBpbmRleCA9IDEpXG5cbiMgTGlzdCB0aGUgbW9kZWwncyBsYXllcnNcbm1vZGVsJGxheWVyc1xuXG4jIExpc3QgdGhlIGlucHV0IHRlbnNvcnNcbm1vZGVsJGlucHV0c1xuXG4jIExpc3QgdGhlIG91dHB1dCB0ZW5zb3JzXG5tb2RlbCRvdXRwdXRzIn0=\u003c/div\u003e\r\n\r\n\u003ch2 id=\"compile\"\u003eCompile And Fit The Model\u003c/h2\u003e\r\n\r\n\u003cp\u003eNow that you have set up the architecture of your model, it\u0026rsquo;s time to compile and fit the model to the data. To compile your model, you configure the model with the \u003ccode\u003eadam\u003c/code\u003e optimizer and the \u003ccode\u003ecategorical_crossentropy\u003c/code\u003e loss function. Additionally, you also monitor the accuracy during the training by passing \u003ccode\u003e\u0026#39;accuracy\u0026#39;\u003c/code\u003e to the metrics argument.\u003c/p\u003e\r\n\r\n\u003cdiv data-datacamp-exercise=\"\" data-encoded=\"true\" data-height=\"300\"\u003eeyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6InNldC5zZWVkKDEyMzQpXG5saWJyYXJ5KGtlcmFzKVxuaXJpcyA8LSByZWFkLmNzdih1cmwoXCJodHRwOi8vYXJjaGl2ZS5pY3MudWNpLmVkdS9tbC9tYWNoaW5lLWxlYXJuaW5nLWRhdGFiYXNlcy9pcmlzL2lyaXMuZGF0YVwiKSwgaGVhZGVyID0gRkFMU0UpIFxubmFtZXMoaXJpcykgPC0gYyhcIlNlcGFsLkxlbmd0aFwiLCBcIlNlcGFsLldpZHRoXCIsIFwiUGV0YWwuTGVuZ3RoXCIsIFwiUGV0YWwuV2lkdGhcIiwgXCJTcGVjaWVzXCIpXG5pcmlzWyw1XSA8LSBhcy5udW1lcmljKGlyaXNbLDVdKSAtMVxuaXJpcyA8LSBhcy5tYXRyaXgoaXJpcylcbmRpbW5hbWVzKGlyaXMpIDwtIE5VTExcbmluZCA8LSBzYW1wbGUoMiwgbnJvdyhpcmlzKSwgcmVwbGFjZT1UUlVFLCBwcm9iPWMoMC42NywgMC4zMykpXG5pcmlzLnRyYWluaW5nIDwtIGlyaXNbaW5kPT0xLCAxOjRdXG5pcmlzLnRlc3QgPC0gaXJpc1tpbmQ9PTIsIDE6NF1cbmlyaXMudHJhaW5pbmd0YXJnZXQgPC0gaXJpc1tpbmQ9PTEsNV1cbmlyaXMudGVzdHRhcmdldCA8LSBpcmlzW2luZD09MiwgNV1cbmlyaXMudHJhaW5MYWJlbHMgPC0gdG9fY2F0ZWdvcmljYWwoaXJpcy50cmFpbmluZ3RhcmdldClcbmlyaXMudGVzdExhYmVscyA8LSB0b19jYXRlZ29yaWNhbChpcmlzLnRlc3R0YXJnZXQpXG5tb2RlbCA8LSBrZXJhc19tb2RlbF9zZXF1ZW50aWFsKCkgXG5tb2RlbCAlPiUgXG4gICAgbGF5ZXJfZGVuc2UodW5pdHMgPSA4LCBhY3RpdmF0aW9uID0gJ3JlbHUnLCBpbnB1dF9zaGFwZSA9IGMoNCkpICU+JSBcbiAgICBsYXllcl9kZW5zZSh1bml0cyA9IDMsIGFjdGl2YXRpb24gPSAnc29mdG1heCcpIiwic2FtcGxlIjoiIyBDb21waWxlIHRoZSBtb2RlbFxubW9kZWwgJT4lIGNvbXBpbGUoXG4gICAgIGxvc3MgPSAnY2F0ZWdvcmljYWxfY3Jvc3NlbnRyb3B5JyxcbiAgICAgb3B0aW1pemVyID0gJ2FkYW0nLFxuICAgICBtZXRyaWNzID0gJ2FjY3VyYWN5J1xuICkifQ==\u003c/div\u003e\r\n\r\n\u003cp\u003eThe optimizer and the loss are two arguments that are required if you want to compile the model.\u003c/p\u003e\r\n\r\n\u003cp\u003eSome of the most popular optimization algorithms used are the Stochastic Gradient Descent (SGD), ADAM and RMSprop. Depending on whichever algorithm you choose, you\u0026rsquo;ll need to tune certain parameters, such as learning rate or momentum. The choice for a loss function depends on the task that you have at hand: for example, for a regression problem, you\u0026rsquo;ll usually use the Mean Squared Error (MSE).\u003c/p\u003e\r\n\r\n\u003cp\u003eAs you see in this example, you used \u003ccode\u003ecategorical_crossentropy\u003c/code\u003e loss function for the multi-class classification problem of determining whether an iris is of type versicolor, virginica or setosa. However, note that if you would have had a binary-class classification problem, you should have made use of the \u003ccode\u003ebinary_crossentropy\u003c/code\u003e loss function.\u003c/p\u003e\r\n\r\n\u003cp\u003eNext, you can also fit the model to your data; In this case, you train the model for 200 epochs or iterations over all the samples in \u003ccode\u003eiris.training\u003c/code\u003e and \u003ccode\u003eiris.trainLabels\u003c/code\u003e, in batches of 5 samples.\u003c/p\u003e\r\n\r\n\u003cdiv data-datacamp-exercise=\"\" data-encoded=\"true\" data-height=\"300\"\u003eeyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6InNldC5zZWVkKDEyMzQpXG5saWJyYXJ5KGtlcmFzKVxuaXJpcyA8LSByZWFkLmNzdih1cmwoXCJodHRwOi8vYXJjaGl2ZS5pY3MudWNpLmVkdS9tbC9tYWNoaW5lLWxlYXJuaW5nLWRhdGFiYXNlcy9pcmlzL2lyaXMuZGF0YVwiKSwgaGVhZGVyID0gRkFMU0UpIFxubmFtZXMoaXJpcykgPC0gYyhcIlNlcGFsLkxlbmd0aFwiLCBcIlNlcGFsLldpZHRoXCIsIFwiUGV0YWwuTGVuZ3RoXCIsIFwiUGV0YWwuV2lkdGhcIiwgXCJTcGVjaWVzXCIpXG5pcmlzWyw1XSA8LSBhcy5udW1lcmljKGlyaXNbLDVdKSAtMVxuaXJpcyA8LSBhcy5tYXRyaXgoaXJpcylcbmRpbW5hbWVzKGlyaXMpIDwtIE5VTExcbmluZCA8LSBzYW1wbGUoMiwgbnJvdyhpcmlzKSwgcmVwbGFjZT1UUlVFLCBwcm9iPWMoMC42NywgMC4zMykpXG5pcmlzLnRyYWluaW5nIDwtIGlyaXNbaW5kPT0xLCAxOjRdXG5pcmlzLnRlc3QgPC0gaXJpc1tpbmQ9PTIsIDE6NF1cbmlyaXMudHJhaW5pbmd0YXJnZXQgPC0gaXJpc1tpbmQ9PTEsNV1cbmlyaXMudGVzdHRhcmdldCA8LSBpcmlzW2luZD09MiwgNV1cbmlyaXMudHJhaW5MYWJlbHMgPC0gdG9fY2F0ZWdvcmljYWwoaXJpcy50cmFpbmluZ3RhcmdldClcbmlyaXMudGVzdExhYmVscyA8LSB0b19jYXRlZ29yaWNhbChpcmlzLnRlc3R0YXJnZXQpXG5tb2RlbCA8LSBrZXJhc19tb2RlbF9zZXF1ZW50aWFsKCkgXG5tb2RlbCAlPiUgXG4gICAgbGF5ZXJfZGVuc2UodW5pdHMgPSA4LCBhY3RpdmF0aW9uID0gJ3JlbHUnLCBpbnB1dF9zaGFwZSA9IGMoNCkpICU+JSBcbiAgICBsYXllcl9kZW5zZSh1bml0cyA9IDMsIGFjdGl2YXRpb24gPSAnc29mdG1heCcpXG5tb2RlbCAlPiUgY29tcGlsZShcbiAgICAgbG9zcyA9ICdjYXRlZ29yaWNhbF9jcm9zc2VudHJvcHknLFxuICAgICBvcHRpbWl6ZXIgPSAnYWRhbScsXG4gICAgIG1ldHJpY3MgPSAnYWNjdXJhY3knXG4gKSIsInNhbXBsZSI6IiMgRml0IHRoZSBtb2RlbCBcbm1vZGVsICU+JSBmaXQoXG4gICAgIGlyaXMudHJhaW5pbmcsIFxuICAgICBpcmlzLnRyYWluTGFiZWxzLCBcbiAgICAgZXBvY2hzID0gMjAwLCBcbiAgICAgYmF0Y2hfc2l6ZSA9IDUsIFxuICAgICB2YWxpZGF0aW9uX3NwbGl0ID0gMC4yXG4gKSJ9\u003c/div\u003e\r\n\r\n\u003cp\u003e\u003cstrong\u003eTip\u003c/strong\u003e if you want, you can also specify the verbose argument in the \u003ccode\u003efit()\u003c/code\u003e function. By setting this argument to \u003ccode\u003e1\u003c/code\u003e, you indicate that you want to see progress bar logging.\u003c/p\u003e\r\n\r\n\u003cp\u003eWhat you do with the code above is training the model for a specified number of epochs or exposures to the training dataset. An epoch is a single pass through the entire training set, followed by testing of the verification set. The batch size that you specify in the code above defines the number of samples that going to be propagated through the network. Also, by doing this, you optimize the efficiency because you make sure that you don\u0026rsquo;t load too many input patterns into memory at the same time.\u003c/p\u003e\r\n\r\n\u003ch2 id=\"viz\"\u003eVisualize The Model Training History\u003c/h2\u003e\r\n\r\n\u003cp\u003eAlso, it\u0026rsquo;s good to know that you can also visualize the fitting if you assign the lines of code in the DataCamp Light chunk above to a variable. You can then pass the variable to the \u003ccode\u003eplot()\u003c/code\u003e function, like you see in this particular code chunk!\u003c/p\u003e\r\n\r\n\u003cdiv data-datacamp-exercise=\"\" data-encoded=\"true\" data-height=\"300\"\u003eeyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6InNldC5zZWVkKDEyMzQpXG5saWJyYXJ5KGtlcmFzKVxuaXJpcyA8LSByZWFkLmNzdih1cmwoXCJodHRwOi8vYXJjaGl2ZS5pY3MudWNpLmVkdS9tbC9tYWNoaW5lLWxlYXJuaW5nLWRhdGFiYXNlcy9pcmlzL2lyaXMuZGF0YVwiKSwgaGVhZGVyID0gRkFMU0UpIFxubmFtZXMoaXJpcykgPC0gYyhcIlNlcGFsLkxlbmd0aFwiLCBcIlNlcGFsLldpZHRoXCIsIFwiUGV0YWwuTGVuZ3RoXCIsIFwiUGV0YWwuV2lkdGhcIiwgXCJTcGVjaWVzXCIpXG5pcmlzWyw1XSA8LSBhcy5udW1lcmljKGlyaXNbLDVdKSAtMVxuaXJpcyA8LSBhcy5tYXRyaXgoaXJpcylcbmRpbW5hbWVzKGlyaXMpIDwtIE5VTExcbmluZCA8LSBzYW1wbGUoMiwgbnJvdyhpcmlzKSwgcmVwbGFjZT1UUlVFLCBwcm9iPWMoMC42NywgMC4zMykpXG5pcmlzLnRyYWluaW5nIDwtIGlyaXNbaW5kPT0xLCAxOjRdXG5pcmlzLnRlc3QgPC0gaXJpc1tpbmQ9PTIsIDE6NF1cbmlyaXMudHJhaW5pbmd0YXJnZXQgPC0gaXJpc1tpbmQ9PTEsNV1cbmlyaXMudGVzdHRhcmdldCA8LSBpcmlzW2luZD09MiwgNV1cbmlyaXMudHJhaW5MYWJlbHMgPC0gdG9fY2F0ZWdvcmljYWwoaXJpcy50cmFpbmluZ3RhcmdldClcbmlyaXMudGVzdExhYmVscyA8LSB0b19jYXRlZ29yaWNhbChpcmlzLnRlc3R0YXJnZXQpXG5tb2RlbCA8LSBrZXJhc19tb2RlbF9zZXF1ZW50aWFsKCkgXG5tb2RlbCAlPiUgXG4gICAgbGF5ZXJfZGVuc2UodW5pdHMgPSA4LCBhY3RpdmF0aW9uID0gJ3JlbHUnLCBpbnB1dF9zaGFwZSA9IGMoNCkpICU+JSBcbiAgICBsYXllcl9kZW5zZSh1bml0cyA9IDMsIGFjdGl2YXRpb24gPSAnc29mdG1heCcpXG5tb2RlbCAlPiUgY29tcGlsZShcbiAgICAgbG9zcyA9ICdjYXRlZ29yaWNhbF9jcm9zc2VudHJvcHknLFxuICAgICBvcHRpbWl6ZXIgPSAnYWRhbScsXG4gICAgIG1ldHJpY3MgPSAnYWNjdXJhY3knXG4gKSIsInNhbXBsZSI6IiMgU3RvcmUgdGhlIGZpdHRpbmcgaGlzdG9yeSBpbiBgaGlzdG9yeWAgXG5oaXN0b3J5IDwtIG1vZGVsICU+JSBmaXQoXG4gICAgIGlyaXMudHJhaW5pbmcsIFxuICAgICBpcmlzLnRyYWluTGFiZWxzLCBcbiAgICAgZXBvY2hzID0gMjAwLFxuICAgICBiYXRjaF9zaXplID0gNSwgXG4gICAgIHZhbGlkYXRpb25fc3BsaXQgPSAwLjJcbiApXG5cbiMgUGxvdCB0aGUgaGlzdG9yeVxucGxvdChoaXN0b3J5KSJ9\u003c/div\u003e\r\n\r\n\u003cp\u003eMake sure to study the plot in more detail.\u003c/p\u003e\r\n\r\n\u003cp\u003e\u003cimg src=\"https://s3.amazonaws.com/assets.datacamp.com/blog_assets/Fitting-Plot.png\" /\u003e\u003c/p\u003e\r\n\r\n\u003cp\u003eAt first sight, it\u0026rsquo;s no surprise that this all looks a tad messy. You might not entirely know what you\u0026rsquo;re looking at, right?\u003c/p\u003e\r\n\r\n\u003cp\u003eOne good thing to know is that the \u003ccode\u003eloss\u003c/code\u003e and \u003ccode\u003eacc\u003c/code\u003e indicate the loss and accuracy of the model for the training data, while the \u003ccode\u003eval_loss\u003c/code\u003e and \u003ccode\u003eval_acc\u003c/code\u003e are the same metrics, loss and accuracy, for the test or validation data.\u003c/p\u003e\r\n\r\n\u003cp\u003eBut, even as you know this, it\u0026rsquo;s not easy to interpret these two graphs. Let\u0026rsquo;s try to break this up into pieces that you might understand more easily! You\u0026rsquo;ll split up these two plots and make two separate ones instead: you\u0026rsquo;ll make one for the model loss and another one for the model accuracy. Luckily, you can easily make use of the \u003ccode\u003e$\u003c/code\u003e operator to access the data and plot it step by step.\u003c/p\u003e\r\n\r\n\u003cp\u003eCheck out the DataCamp Light box below to see how you can do this:\u003c/p\u003e\r\n\r\n\u003cdiv data-datacamp-exercise=\"\" data-encoded=\"true\" data-height=\"300\"\u003eeyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6InNldC5zZWVkKDEyMzQpXG5saWJyYXJ5KGtlcmFzKVxuaXJpcyA8LSByZWFkLmNzdih1cmwoXCJodHRwOi8vYXJjaGl2ZS5pY3MudWNpLmVkdS9tbC9tYWNoaW5lLWxlYXJuaW5nLWRhdGFiYXNlcy9pcmlzL2lyaXMuZGF0YVwiKSwgaGVhZGVyID0gRkFMU0UpIFxubmFtZXMoaXJpcykgPC0gYyhcIlNlcGFsLkxlbmd0aFwiLCBcIlNlcGFsLldpZHRoXCIsIFwiUGV0YWwuTGVuZ3RoXCIsIFwiUGV0YWwuV2lkdGhcIiwgXCJTcGVjaWVzXCIpXG5pcmlzWyw1XSA8LSBhcy5udW1lcmljKGlyaXNbLDVdKSAtMVxuaXJpcyA8LSBhcy5tYXRyaXgoaXJpcylcbmRpbW5hbWVzKGlyaXMpIDwtIE5VTExcbmluZCA8LSBzYW1wbGUoMiwgbnJvdyhpcmlzKSwgcmVwbGFjZT1UUlVFLCBwcm9iPWMoMC42NywgMC4zMykpXG5pcmlzLnRyYWluaW5nIDwtIGlyaXNbaW5kPT0xLCAxOjRdXG5pcmlzLnRlc3QgPC0gaXJpc1tpbmQ9PTIsIDE6NF1cbmlyaXMudHJhaW5pbmd0YXJnZXQgPC0gaXJpc1tpbmQ9PTEsNV1cbmlyaXMudGVzdHRhcmdldCA8LSBpcmlzW2luZD09MiwgNV1cbmlyaXMudHJhaW5MYWJlbHMgPC0gdG9fY2F0ZWdvcmljYWwoaXJpcy50cmFpbmluZ3RhcmdldClcbmlyaXMudGVzdExhYmVscyA8LSB0b19jYXRlZ29yaWNhbChpcmlzLnRlc3R0YXJnZXQpXG5tb2RlbCA8LSBrZXJhc19tb2RlbF9zZXF1ZW50aWFsKCkgXG5tb2RlbCAlPiUgXG4gICAgbGF5ZXJfZGVuc2UodW5pdHMgPSA4LCBhY3RpdmF0aW9uID0gJ3JlbHUnLCBpbnB1dF9zaGFwZSA9IGMoNCkpICU+JSBcbiAgICBsYXllcl9kZW5zZSh1bml0cyA9IDMsIGFjdGl2YXRpb24gPSAnc29mdG1heCcpXG5tb2RlbCAlPiUgY29tcGlsZShcbiAgICAgbG9zcyA9ICdjYXRlZ29yaWNhbF9jcm9zc2VudHJvcHknLFxuICAgICBvcHRpbWl6ZXIgPSAnYWRhbScsXG4gICAgIG1ldHJpY3MgPSAnYWNjdXJhY3knXG4gKVxuaGlzdG9yeSA8LSBtb2RlbCAlPiUgZml0KFxuICAgICBpcmlzLnRyYWluaW5nLCBcbiAgICAgaXJpcy50cmFpbkxhYmVscywgXG4gICAgIGVwb2NocyA9IDIwMCxcbiAgICAgYmF0Y2hfc2l6ZSA9IDUsIFxuICAgICB2YWxpZGF0aW9uX3NwbGl0ID0gMC4yXG4gKSIsInNhbXBsZSI6IiMgUGxvdCB0aGUgbW9kZWwgbG9zcyBvZiB0aGUgdHJhaW5pbmcgZGF0YVxucGxvdChoaXN0b3J5JG1ldHJpY3MkbG9zcywgbWFpbj1cIk1vZGVsIExvc3NcIiwgeGxhYiA9IFwiZXBvY2hcIiwgeWxhYj1cImxvc3NcIiwgY29sPVwiYmx1ZVwiLCB0eXBlPVwibFwiKVxuXG4jIFBsb3QgdGhlIG1vZGVsIGxvc3Mgb2YgdGhlIHRlc3QgZGF0YVxubGluZXMoaGlzdG9yeSRtZXRyaWNzJHZhbF9sb3NzLCBjb2w9XCJncmVlblwiKVxuXG4jIEFkZCBsZWdlbmRcbmxlZ2VuZChcInRvcHJpZ2h0XCIsIGMoXCJ0cmFpblwiLFwidGVzdFwiKSwgY29sPWMoXCJibHVlXCIsIFwiZ3JlZW5cIiksIGx0eT1jKDEsMSkpIn0=\u003c/div\u003e\r\n\r\n\u003cp\u003e\u003cimg src=\"https://s3.amazonaws.com/assets.datacamp.com/blog_assets/Model-Loss.png\" /\u003e\u003c/p\u003e\r\n\r\n\u003cp\u003eIn this first plot, you plotted the loss of the model on the training and test data. Now it\u0026rsquo;s time to also do the same, but then for the accuracy of the model:\u003c/p\u003e\r\n\r\n\u003cdiv data-datacamp-exercise=\"\" data-encoded=\"true\" data-height=\"300\"\u003eeyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6InNldC5zZWVkKDEyMzQpXG5saWJyYXJ5KGtlcmFzKVxuaXJpcyA8LSByZWFkLmNzdih1cmwoXCJodHRwOi8vYXJjaGl2ZS5pY3MudWNpLmVkdS9tbC9tYWNoaW5lLWxlYXJuaW5nLWRhdGFiYXNlcy9pcmlzL2lyaXMuZGF0YVwiKSwgaGVhZGVyID0gRkFMU0UpIFxubmFtZXMoaXJpcykgPC0gYyhcIlNlcGFsLkxlbmd0aFwiLCBcIlNlcGFsLldpZHRoXCIsIFwiUGV0YWwuTGVuZ3RoXCIsIFwiUGV0YWwuV2lkdGhcIiwgXCJTcGVjaWVzXCIpXG5pcmlzWyw1XSA8LSBhcy5udW1lcmljKGlyaXNbLDVdKSAtMVxuaXJpcyA8LSBhcy5tYXRyaXgoaXJpcylcbmRpbW5hbWVzKGlyaXMpIDwtIE5VTExcbmluZCA8LSBzYW1wbGUoMiwgbnJvdyhpcmlzKSwgcmVwbGFjZT1UUlVFLCBwcm9iPWMoMC42NywgMC4zMykpXG5pcmlzLnRyYWluaW5nIDwtIGlyaXNbaW5kPT0xLCAxOjRdXG5pcmlzLnRlc3QgPC0gaXJpc1tpbmQ9PTIsIDE6NF1cbmlyaXMudHJhaW5pbmd0YXJnZXQgPC0gaXJpc1tpbmQ9PTEsNV1cbmlyaXMudGVzdHRhcmdldCA8LSBpcmlzW2luZD09MiwgNV1cbmlyaXMudHJhaW5MYWJlbHMgPC0gdG9fY2F0ZWdvcmljYWwoaXJpcy50cmFpbmluZ3RhcmdldClcbmlyaXMudGVzdExhYmVscyA8LSB0b19jYXRlZ29yaWNhbChpcmlzLnRlc3R0YXJnZXQpXG5tb2RlbCA8LSBrZXJhc19tb2RlbF9zZXF1ZW50aWFsKCkgXG5tb2RlbCAlPiUgXG4gICAgbGF5ZXJfZGVuc2UodW5pdHMgPSA4LCBhY3RpdmF0aW9uID0gJ3JlbHUnLCBpbnB1dF9zaGFwZSA9IGMoNCkpICU+JSBcbiAgICBsYXllcl9kZW5zZSh1bml0cyA9IDMsIGFjdGl2YXRpb24gPSAnc29mdG1heCcpXG5tb2RlbCAlPiUgY29tcGlsZShcbiAgICAgbG9zcyA9ICdjYXRlZ29yaWNhbF9jcm9zc2VudHJvcHknLFxuICAgICBvcHRpbWl6ZXIgPSAnYWRhbScsXG4gICAgIG1ldHJpY3MgPSAnYWNjdXJhY3knXG4gKVxuaGlzdG9yeSA8LSBtb2RlbCAlPiUgZml0KFxuICAgICBpcmlzLnRyYWluaW5nLCBcbiAgICAgaXJpcy50cmFpbkxhYmVscywgXG4gICAgIGVwb2NocyA9IDIwMCxcbiAgICAgYmF0Y2hfc2l6ZSA9IDUsIFxuICAgICB2YWxpZGF0aW9uX3NwbGl0ID0gMC4yXG4gKSIsInNhbXBsZSI6IiMgUGxvdCB0aGUgYWNjdXJhY3kgb2YgdGhlIHRyYWluaW5nIGRhdGEgXG5wbG90KGhpc3RvcnkkbWV0cmljcyRhY2MsIG1haW49XCJNb2RlbCBBY2N1cmFjeVwiLCB4bGFiID0gXCJlcG9jaFwiLCB5bGFiPVwiYWNjdXJhY3lcIiwgY29sPVwiYmx1ZVwiLCB0eXBlPVwibFwiKVxuXG4jIFBsb3QgdGhlIGFjY3VyYWN5IG9mIHRoZSB2YWxpZGF0aW9uIGRhdGFcbmxpbmVzKGhpc3RvcnkkbWV0cmljcyR2YWxfYWNjLCBjb2w9XCJncmVlblwiKVxuXG4jIEFkZCBMZWdlbmRcbmxlZ2VuZChcImJvdHRvbXJpZ2h0XCIsIGMoXCJ0cmFpblwiLFwidGVzdFwiKSwgY29sPWMoXCJibHVlXCIsIFwiZ3JlZW5cIiksIGx0eT1jKDEsMSkpIn0=\u003c/div\u003e\r\n\r\n\u003cp\u003e\u003cimg src=\"https://s3.amazonaws.com/assets.datacamp.com/blog_assets/Model-Accuracy.png\" /\u003e\u003c/p\u003e\r\n\r\n\u003cp\u003eSome things to keep in mind here are the following:\u003c/p\u003e\r\n\r\n\u003cul\u003e\r\n\t\u003cli\u003eIf your training data accuracy keeps improving while your validation data accuracy gets worse, you are probably overfitting: your model starts to just memorize the data instead of learning from it.\u003c/li\u003e\r\n\t\u003cli\u003eIf the trend for accuracy on both datasets is still rising for the last few epochs, you can clearly see that the model has not yet over-learned the training dataset.\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\r\n\u003ch2 id=\"predict\"\u003ePredict Labels of New Data\u003c/h2\u003e\r\n\r\n\u003cp\u003eNow that your model is created, compiled and has been fitted to the data, it\u0026rsquo;s time to actually use your model to predict the labels for your test set \u003ccode\u003eiris.test\u003c/code\u003e. As you might have expected, you can use the \u003ccode\u003epredict()\u003c/code\u003e function to do this. After, you can print out the confusion matrix to check out the predictions and the real labels of the \u003ccode\u003eiris.test\u003c/code\u003e data with the help of the \u003ccode\u003etable()\u003c/code\u003e function.\u003c/p\u003e\r\n\r\n\u003cdiv data-datacamp-exercise=\"\" data-height=\"300\" data-encoded=\"true\"\u003e\r\neyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6InNldC5zZWVkKDEyMzQpXG5saWJyYXJ5KGtlcmFzKVxuaXJpcyA8LSByZWFkLmNzdih1cmwoXCJodHRwOi8vYXJjaGl2ZS5pY3MudWNpLmVkdS9tbC9tYWNoaW5lLWxlYXJuaW5nLWRhdGFiYXNlcy9pcmlzL2lyaXMuZGF0YVwiKSwgaGVhZGVyID0gRkFMU0UpIFxubmFtZXMoaXJpcykgPC0gYyhcIlNlcGFsLkxlbmd0aFwiLCBcIlNlcGFsLldpZHRoXCIsIFwiUGV0YWwuTGVuZ3RoXCIsIFwiUGV0YWwuV2lkdGhcIiwgXCJTcGVjaWVzXCIpXG5pcmlzWyw1XSA8LSBhcy5udW1lcmljKGlyaXNbLDVdKSAtMVxuaXJpcyA8LSBhcy5tYXRyaXgoaXJpcylcbmRpbW5hbWVzKGlyaXMpIDwtIE5VTExcbmluZCA8LSBzYW1wbGUoMiwgbnJvdyhpcmlzKSwgcmVwbGFjZT1UUlVFLCBwcm9iPWMoMC42NywgMC4zMykpXG5pcmlzLnRyYWluaW5nIDwtIGlyaXNbaW5kPT0xLCAxOjRdXG5pcmlzLnRlc3QgPC0gaXJpc1tpbmQ9PTIsIDE6NF1cbmlyaXMudHJhaW5pbmd0YXJnZXQgPC0gaXJpc1tpbmQ9PTEsNV1cbmlyaXMudGVzdHRhcmdldCA8LSBpcmlzW2luZD09MiwgNV1cbmlyaXMudHJhaW5MYWJlbHMgPC0gdG9fY2F0ZWdvcmljYWwoaXJpcy50cmFpbmluZ3RhcmdldClcbmlyaXMudGVzdExhYmVscyA8LSB0b19jYXRlZ29yaWNhbChpcmlzLnRlc3R0YXJnZXQpXG5tb2RlbCA8LSBrZXJhc19tb2RlbF9zZXF1ZW50aWFsKCkgXG5tb2RlbCAlPiUgXG4gICAgbGF5ZXJfZGVuc2UodW5pdHMgPSA4LCBhY3RpdmF0aW9uID0gJ3JlbHUnLCBpbnB1dF9zaGFwZSA9IGMoNCkpICU+JSBcbiAgICBsYXllcl9kZW5zZSh1bml0cyA9IDMsIGFjdGl2YXRpb24gPSAnc29mdG1heCcpXG5tb2RlbCAlPiUgY29tcGlsZShcbiAgICAgbG9zcyA9ICdjYXRlZ29yaWNhbF9jcm9zc2VudHJvcHknLFxuICAgICBvcHRpbWl6ZXIgPSAnYWRhbScsXG4gICAgIG1ldHJpY3MgPSAnYWNjdXJhY3knXG4gKVxubW9kZWwgJT4lIGZpdChcbiAgICAgaXJpcy50cmFpbmluZywgaXJpcy50cmFpbkxhYmVscywgXG4gICAgIGVwb2NocyA9IDIwMCwgYmF0Y2hfc2l6ZSA9IDUsIFxuICAgICB2YWxpZGF0aW9uX3NwbGl0ID0gMC4yXG4gKSIsInNhbXBsZSI6IiMgUHJlZGljdCB0aGUgY2xhc3NlcyBmb3IgdGhlIHRlc3QgZGF0YVxuY2xhc3NlcyA8LSBtb2RlbCAlPiUgcHJlZGljdF9jbGFzc2VzKGlyaXMudGVzdCwgYmF0Y2hfc2l6ZSA9IDEyOClcblxuIyBDb25mdXNpb24gbWF0cml4XG50YWJsZShpcmlzLnRlc3R0YXJnZXQsIGNsYXNzZXMpIn0=\r\n\u003c/div\u003e\r\n\r\n\u003cp\u003eWhat do you think of the results? At first sight, does this model that you have created make the right predictions?\u003c/p\u003e\r\n\r\n\u003ch2 id=\"evaluate\"\u003eEvaluating Your Model\u003c/h2\u003e\r\n\r\n\u003cp\u003eEven though you already have a slight idea of how your model performed by looking at the predicted labels for \u003ccode\u003eiris.test\u003c/code\u003e, it\u0026rsquo;s still important that you take the time to evaluate your model. Use the \u003ccode\u003eevaluate()\u003c/code\u003e function to do this: pass in the test data \u003ccode\u003eiris.test\u003c/code\u003e, the test labels \u003ccode\u003eiris.testLabels\u003c/code\u003e and define the batch size. Store the result in a variable \u003ccode\u003escore\u003c/code\u003e, like in the code example below:\u003c/p\u003e\r\n\r\n\u003cdiv data-datacamp-exercise=\"\" data-encoded=\"true\" data-height=\"300\"\u003eeyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6InNldC5zZWVkKDEyMzQpXG5saWJyYXJ5KGtlcmFzKVxuaXJpcyA8LSByZWFkLmNzdih1cmwoXCJodHRwOi8vYXJjaGl2ZS5pY3MudWNpLmVkdS9tbC9tYWNoaW5lLWxlYXJuaW5nLWRhdGFiYXNlcy9pcmlzL2lyaXMuZGF0YVwiKSwgaGVhZGVyID0gRkFMU0UpIFxubmFtZXMoaXJpcykgPC0gYyhcIlNlcGFsLkxlbmd0aFwiLCBcIlNlcGFsLldpZHRoXCIsIFwiUGV0YWwuTGVuZ3RoXCIsIFwiUGV0YWwuV2lkdGhcIiwgXCJTcGVjaWVzXCIpXG5pcmlzWyw1XSA8LSBhcy5udW1lcmljKGlyaXNbLDVdKSAtMVxuaXJpcyA8LSBhcy5tYXRyaXgoaXJpcylcbmRpbW5hbWVzKGlyaXMpIDwtIE5VTExcbmluZCA8LSBzYW1wbGUoMiwgbnJvdyhpcmlzKSwgcmVwbGFjZT1UUlVFLCBwcm9iPWMoMC42NywgMC4zMykpXG5pcmlzLnRyYWluaW5nIDwtIGlyaXNbaW5kPT0xLCAxOjRdXG5pcmlzLnRlc3QgPC0gaXJpc1tpbmQ9PTIsIDE6NF1cbmlyaXMudHJhaW5pbmd0YXJnZXQgPC0gaXJpc1tpbmQ9PTEsNV1cbmlyaXMudGVzdHRhcmdldCA8LSBpcmlzW2luZD09MiwgNV1cbmlyaXMudHJhaW5MYWJlbHMgPC0gdG9fY2F0ZWdvcmljYWwoaXJpcy50cmFpbmluZ3RhcmdldClcbmlyaXMudGVzdExhYmVscyA8LSB0b19jYXRlZ29yaWNhbChpcmlzLnRlc3R0YXJnZXQpXG5tb2RlbCA8LSBrZXJhc19tb2RlbF9zZXF1ZW50aWFsKCkgXG5tb2RlbCAlPiUgXG4gICAgbGF5ZXJfZGVuc2UodW5pdHMgPSA4LCBhY3RpdmF0aW9uID0gJ3JlbHUnLCBpbnB1dF9zaGFwZSA9IGMoNCkpICU+JSBcbiAgICBsYXllcl9kZW5zZSh1bml0cyA9IDMsIGFjdGl2YXRpb24gPSAnc29mdG1heCcpXG5tb2RlbCAlPiUgY29tcGlsZShcbiAgICAgbG9zcyA9ICdjYXRlZ29yaWNhbF9jcm9zc2VudHJvcHknLFxuICAgICBvcHRpbWl6ZXIgPSAnYWRhbScsXG4gICAgIG1ldHJpY3MgPSAnYWNjdXJhY3knXG4gKVxubW9kZWwgJT4lIGZpdChcbiAgICAgaXJpcy50cmFpbmluZywgaXJpcy50cmFpbkxhYmVscywgXG4gICAgIGVwb2NocyA9IDIwMCwgYmF0Y2hfc2l6ZSA9IDUsIFxuICAgICB2YWxpZGF0aW9uX3NwbGl0ID0gMC4yXG4gKSIsInNhbXBsZSI6IiMgRXZhbHVhdGUgb24gdGVzdCBkYXRhIGFuZCBsYWJlbHNcbnNjb3JlIDwtIG1vZGVsICU+JSBldmFsdWF0ZShpcmlzLnRlc3QsIGlyaXMudGVzdExhYmVscywgYmF0Y2hfc2l6ZSA9IDEyOClcblxuIyBQcmludCB0aGUgc2NvcmVcbnByaW50KHNjb3JlKSJ9\u003c/div\u003e\r\n\r\n\u003cp\u003eBy printing \u003ccode\u003escore\u003c/code\u003e, you\u0026rsquo;ll get back the loss value and the metric value (in this case \u003ccode\u003e\u0026#39;accuracy\u0026#39;\u003c/code\u003e) back.\u003c/p\u003e\r\n\r\n\u003ch2 id=\"finetune\"\u003eFine-tuning Your Model\u003c/h2\u003e\r\n\r\n\u003cp\u003eFine-tuning your model is probably something that you\u0026rsquo;ll be doing a lot, especially in the beginning, because not all classification and regression problems are as straightforward as the one that you saw in the first part of this tutorial. As you read above, there are already two key decisions that you\u0026rsquo;ll probably want to adjust: how many layers you\u0026rsquo;re going to use and how many \u0026ldquo;hidden units\u0026rdquo; you will chose for each layer.\u003c/p\u003e\r\n\r\n\u003cp\u003eIn the beginning, this will really be quite a journey.\u003c/p\u003e\r\n\r\n\u003cp\u003eBesides playing around with the number of epochs or the batch size, there are other ways in which you can tweak your model in the hopes that it will perform better: by adding layers, by increasing the number of hidden units and by passing your own optimization parameters to the \u003ccode\u003ecompile()\u003c/code\u003e function. This section will go over these three options.\u003c/p\u003e\r\n\r\n\u003cdiv class=\"section level3\" id=\"adding-layers\"\u003e\r\n\u003ch3\u003eAdding Layers\u003c/h3\u003e\r\n\r\n\u003cp\u003eWhat would happen if you add another layer to your model? What if it would look like this?\u003c/p\u003e\r\n\r\n\u003cdiv data-datacamp-exercise=\"\" data-encoded=\"true\" data-height=\"600\"\u003eeyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6InNldC5zZWVkKDEyMzQpXG5saWJyYXJ5KGtlcmFzKVxuaXJpcyA8LSByZWFkLmNzdih1cmwoXCJodHRwOi8vYXJjaGl2ZS5pY3MudWNpLmVkdS9tbC9tYWNoaW5lLWxlYXJuaW5nLWRhdGFiYXNlcy9pcmlzL2lyaXMuZGF0YVwiKSwgaGVhZGVyID0gRkFMU0UpIFxubmFtZXMoaXJpcykgPC0gYyhcIlNlcGFsLkxlbmd0aFwiLCBcIlNlcGFsLldpZHRoXCIsIFwiUGV0YWwuTGVuZ3RoXCIsIFwiUGV0YWwuV2lkdGhcIiwgXCJTcGVjaWVzXCIpXG5pcmlzWyw1XSA8LSBhcy5udW1lcmljKGlyaXNbLDVdKSAtMVxuaXJpcyA8LSBhcy5tYXRyaXgoaXJpcylcbmRpbW5hbWVzKGlyaXMpIDwtIE5VTExcbmluZCA8LSBzYW1wbGUoMiwgbnJvdyhpcmlzKSwgcmVwbGFjZT1UUlVFLCBwcm9iPWMoMC42NywgMC4zMykpXG5pcmlzLnRyYWluaW5nIDwtIGlyaXNbaW5kPT0xLCAxOjRdXG5pcmlzLnRlc3QgPC0gaXJpc1tpbmQ9PTIsIDE6NF1cbmlyaXMudHJhaW5pbmd0YXJnZXQgPC0gaXJpc1tpbmQ9PTEsNV1cbmlyaXMudGVzdHRhcmdldCA8LSBpcmlzW2luZD09MiwgNV1cbmlyaXMudHJhaW5MYWJlbHMgPC0gdG9fY2F0ZWdvcmljYWwoaXJpcy50cmFpbmluZ3RhcmdldClcbmlyaXMudGVzdExhYmVscyA8LSB0b19jYXRlZ29yaWNhbChpcmlzLnRlc3R0YXJnZXQpIiwic2FtcGxlIjoiIyBJbml0aWFsaXplIHRoZSBzZXF1ZW50aWFsIG1vZGVsXG5tb2RlbCA8LSBrZXJhc19tb2RlbF9zZXF1ZW50aWFsKCkgXG5cbiMgQWRkIGxheWVycyB0byBtb2RlbFxubW9kZWwgJT4lIFxuICAgIGxheWVyX2RlbnNlKHVuaXRzID0gOCwgYWN0aXZhdGlvbiA9ICdyZWx1JywgaW5wdXRfc2hhcGUgPSBjKDQpKSAlPiUgXG4gICAgbGF5ZXJfZGVuc2UodW5pdHMgPSA1LCBhY3RpdmF0aW9uID0gJ3JlbHUnKSAlPiUgXG4gICAgbGF5ZXJfZGVuc2UodW5pdHMgPSAzLCBhY3RpdmF0aW9uID0gJ3NvZnRtYXgnKVxuXG4jIENvbXBpbGUgdGhlIG1vZGVsXG5tb2RlbCAlPiUgY29tcGlsZShcbiAgICAgbG9zcyA9ICdjYXRlZ29yaWNhbF9jcm9zc2VudHJvcHknLFxuICAgICBvcHRpbWl6ZXIgPSAnYWRhbScsXG4gICAgIG1ldHJpY3MgPSAnYWNjdXJhY3knXG4gKVxuXG4jIEZpdCB0aGUgbW9kZWwgdG8gdGhlIGRhdGFcbm1vZGVsICU+JSBmaXQoXG4gICAgIGlyaXMudHJhaW5pbmcsIGlyaXMudHJhaW5MYWJlbHMsIFxuICAgICBlcG9jaHMgPSAyMDAsIGJhdGNoX3NpemUgPSA1LCBcbiAgICAgdmFsaWRhdGlvbl9zcGxpdCA9IDAuMlxuIClcblxuIyBFdmFsdWF0ZSB0aGUgbW9kZWxcbnNjb3JlIDwtIG1vZGVsICU+JSBldmFsdWF0ZShpcmlzLnRlc3QsIGlyaXMudGVzdExhYmVscywgYmF0Y2hfc2l6ZSA9IDEyOClcblxuIyBQcmludCB0aGUgc2NvcmVcbnByaW50KHNjb3JlKSJ9\u003c/div\u003e\r\n\r\n\u003cp\u003e\u003cstrong\u003eNote\u003c/strong\u003e that you can also visualize the loss and accuracy metrics of this new model! Try this out in the DataCamp Light chunk below:\u003c/p\u003e\r\n\r\n\u003cdiv data-datacamp-exercise=\"\" data-encoded=\"true\" data-height=\"800\"\u003eeyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6InNldC5zZWVkKDEyMzQpXG5saWJyYXJ5KGtlcmFzKVxuaXJpcyA8LSByZWFkLmNzdih1cmwoXCJodHRwOi8vYXJjaGl2ZS5pY3MudWNpLmVkdS9tbC9tYWNoaW5lLWxlYXJuaW5nLWRhdGFiYXNlcy9pcmlzL2lyaXMuZGF0YVwiKSwgaGVhZGVyID0gRkFMU0UpIFxubmFtZXMoaXJpcykgPC0gYyhcIlNlcGFsLkxlbmd0aFwiLCBcIlNlcGFsLldpZHRoXCIsIFwiUGV0YWwuTGVuZ3RoXCIsIFwiUGV0YWwuV2lkdGhcIiwgXCJTcGVjaWVzXCIpXG5pcmlzWyw1XSA8LSBhcy5udW1lcmljKGlyaXNbLDVdKSAtMVxuaXJpcyA8LSBhcy5tYXRyaXgoaXJpcylcbmRpbW5hbWVzKGlyaXMpIDwtIE5VTExcbmluZCA8LSBzYW1wbGUoMiwgbnJvdyhpcmlzKSwgcmVwbGFjZT1UUlVFLCBwcm9iPWMoMC42NywgMC4zMykpXG5pcmlzLnRyYWluaW5nIDwtIGlyaXNbaW5kPT0xLCAxOjRdXG5pcmlzLnRlc3QgPC0gaXJpc1tpbmQ9PTIsIDE6NF1cbmlyaXMudHJhaW5pbmd0YXJnZXQgPC0gaXJpc1tpbmQ9PTEsNV1cbmlyaXMudGVzdHRhcmdldCA8LSBpcmlzW2luZD09MiwgNV1cbmlyaXMudHJhaW5MYWJlbHMgPC0gdG9fY2F0ZWdvcmljYWwoaXJpcy50cmFpbmluZ3RhcmdldClcbmlyaXMudGVzdExhYmVscyA8LSB0b19jYXRlZ29yaWNhbChpcmlzLnRlc3R0YXJnZXQpIiwic2FtcGxlIjoiIyBJbml0aWFsaXplIGEgc2VxdWVudGlhbCBtb2RlbFxubW9kZWwgPC0ga2VyYXNfbW9kZWxfc2VxdWVudGlhbCgpIFxuXG4jIEFkZCBsYXllcnMgdG8gdGhlIG1vZGVsXG5tb2RlbCAlPiUgXG4gICAgbGF5ZXJfZGVuc2UodW5pdHMgPSA4LCBhY3RpdmF0aW9uID0gJ3JlbHUnLCBpbnB1dF9zaGFwZSA9IGMoNCkpICU+JSBcbiAgICBsYXllcl9kZW5zZSh1bml0cyA9IDUsIGFjdGl2YXRpb24gPSAncmVsdScpICU+JSBcbiAgICBsYXllcl9kZW5zZSh1bml0cyA9IDMsIGFjdGl2YXRpb24gPSAnc29mdG1heCcpXG5cbiMgQ29tcGlsZSB0aGUgbW9kZWxcbm1vZGVsICU+JSBjb21waWxlKFxuICAgICBsb3NzID0gJ2NhdGVnb3JpY2FsX2Nyb3NzZW50cm9weScsXG4gICAgIG9wdGltaXplciA9ICdhZGFtJyxcbiAgICAgbWV0cmljcyA9ICdhY2N1cmFjeSdcbiApXG5cbiMgU2F2ZSB0aGUgdHJhaW5pbmcgaGlzdG9yeSBpbiBoaXN0b3J5XG5oaXN0b3J5IDwtIG1vZGVsICU+JSBmaXQoXG4gIGlyaXMudHJhaW5pbmcsIGlyaXMudHJhaW5MYWJlbHMsIFxuICBlcG9jaHMgPSAyMDAsIGJhdGNoX3NpemUgPSA1LFxuICB2YWxpZGF0aW9uX3NwbGl0ID0gMC4yXG4gKVxuXG4jIFBsb3QgdGhlIG1vZGVsIGxvc3NcbnBsb3QoaGlzdG9yeSRtZXRyaWNzJGxvc3MsIG1haW49XCJNb2RlbCBMb3NzXCIsIHhsYWIgPSBcImVwb2NoXCIsIHlsYWI9XCJsb3NzXCIsIGNvbD1cImJsdWVcIiwgdHlwZT1cImxcIilcbmxpbmVzKGhpc3RvcnkkbWV0cmljcyR2YWxfbG9zcywgY29sPVwiZ3JlZW5cIilcbmxlZ2VuZChcInRvcHJpZ2h0XCIsIGMoXCJ0cmFpblwiLFwidGVzdFwiKSwgY29sPWMoXCJibHVlXCIsIFwiZ3JlZW5cIiksIGx0eT1jKDEsMSkpXG5cbiMgUGxvdCB0aGUgbW9kZWwgYWNjdXJhY3lcbnBsb3QoaGlzdG9yeSRtZXRyaWNzJGFjYywgbWFpbj1cIk1vZGVsIEFjY3VyYWN5XCIsIHhsYWIgPSBcImVwb2NoXCIsIHlsYWI9XCJhY2N1cmFjeVwiLCBjb2w9XCJibHVlXCIsIHR5cGU9XCJsXCIpXG5saW5lcyhoaXN0b3J5JG1ldHJpY3MkdmFsX2FjYywgY29sPVwiZ3JlZW5cIilcbmxlZ2VuZChcImJvdHRvbXJpZ2h0XCIsIGMoXCJ0cmFpblwiLFwidGVzdFwiKSwgY29sPWMoXCJibHVlXCIsIFwiZ3JlZW5cIiksIGx0eT1jKDEsMSkpIn0=\u003c/div\u003e\r\n\r\n\u003ctable align=\"center\" border=\"0\" cellpadding=\"1\" cellspacing=\"1\" style=\"width: 800px;\"\u003e\r\n\t\u003ctbody\u003e\r\n\t\t\u003ctr\u003e\r\n\t\t\t\u003ctd align=\"center\"\u003e\r\n\t\t\t\u003cp\u003e\u003cimg alt=\"deep learning model layers\" src=\"https://s3.amazonaws.com/assets.datacamp.com/blog_assets/Modelfinetune-1a.png\" style=\"width: 430px; height: 304px;\" /\u003e\u003c/p\u003e\r\n\t\t\t\u003c/td\u003e\r\n\t\t\t\u003ctd align=\"center\"\u003e\r\n\t\t\t\u003cp\u003e\u003cimg alt=\"Keras Layers model\" src=\"https://s3.amazonaws.com/assets.datacamp.com/blog_assets/Modelfinetune-1b.png\" style=\"width: 430px; height: 304px;\" /\u003e\u003c/p\u003e\r\n\t\t\t\u003c/td\u003e\r\n\t\t\u003c/tr\u003e\r\n\t\u003c/tbody\u003e\r\n\u003c/table\u003e\r\n\u003c/div\u003e\r\n\r\n\u003cdiv class=\"section level3\" id=\"hidden-units\"\u003e\r\n\u003ch3\u003eHidden Units\u003c/h3\u003e\r\n\r\n\u003cp\u003eAlso try out the effect of adding more hidden units to your model\u0026rsquo;s architecture and study the effect on the evaluation, just like this:\u003c/p\u003e\r\n\r\n\u003cdiv data-datacamp-exercise=\"\" data-encoded=\"true\" data-height=\"600\"\u003eeyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6InNldC5zZWVkKDEyMzQpXG5saWJyYXJ5KGtlcmFzKVxuaXJpcyA8LSByZWFkLmNzdih1cmwoXCJodHRwOi8vYXJjaGl2ZS5pY3MudWNpLmVkdS9tbC9tYWNoaW5lLWxlYXJuaW5nLWRhdGFiYXNlcy9pcmlzL2lyaXMuZGF0YVwiKSwgaGVhZGVyID0gRkFMU0UpIFxubmFtZXMoaXJpcykgPC0gYyhcIlNlcGFsLkxlbmd0aFwiLCBcIlNlcGFsLldpZHRoXCIsIFwiUGV0YWwuTGVuZ3RoXCIsIFwiUGV0YWwuV2lkdGhcIiwgXCJTcGVjaWVzXCIpXG5pcmlzWyw1XSA8LSBhcy5udW1lcmljKGlyaXNbLDVdKSAtMVxuaXJpcyA8LSBhcy5tYXRyaXgoaXJpcylcbmRpbW5hbWVzKGlyaXMpIDwtIE5VTExcbmluZCA8LSBzYW1wbGUoMiwgbnJvdyhpcmlzKSwgcmVwbGFjZT1UUlVFLCBwcm9iPWMoMC42NywgMC4zMykpXG5pcmlzLnRyYWluaW5nIDwtIGlyaXNbaW5kPT0xLCAxOjRdXG5pcmlzLnRlc3QgPC0gaXJpc1tpbmQ9PTIsIDE6NF1cbmlyaXMudHJhaW5pbmd0YXJnZXQgPC0gaXJpc1tpbmQ9PTEsNV1cbmlyaXMudGVzdHRhcmdldCA8LSBpcmlzW2luZD09MiwgNV1cbmlyaXMudHJhaW5MYWJlbHMgPC0gdG9fY2F0ZWdvcmljYWwoaXJpcy50cmFpbmluZ3RhcmdldClcbmlyaXMudGVzdExhYmVscyA8LSB0b19jYXRlZ29yaWNhbChpcmlzLnRlc3R0YXJnZXQpIiwic2FtcGxlIjoiIyBJbml0aWFsaXplIGEgc2VxdWVudGlhbCBtb2RlbFxubW9kZWwgPC0ga2VyYXNfbW9kZWxfc2VxdWVudGlhbCgpIFxuXG4jIEFkZCBsYXllcnMgdG8gdGhlIG1vZGVsXG5tb2RlbCAlPiUgXG4gICAgbGF5ZXJfZGVuc2UodW5pdHMgPSAyOCwgYWN0aXZhdGlvbiA9ICdyZWx1JywgaW5wdXRfc2hhcGUgPSBjKDQpKSAlPiUgXG4gICAgbGF5ZXJfZGVuc2UodW5pdHMgPSAzLCBhY3RpdmF0aW9uID0gJ3NvZnRtYXgnKVxuXG4jIENvbXBpbGUgdGhlIG1vZGVsXG5tb2RlbCAlPiUgY29tcGlsZShcbiAgICAgbG9zcyA9ICdjYXRlZ29yaWNhbF9jcm9zc2VudHJvcHknLFxuICAgICBvcHRpbWl6ZXIgPSAnYWRhbScsXG4gICAgIG1ldHJpY3MgPSAnYWNjdXJhY3knXG4gKVxuXG4jIEZpdCB0aGUgbW9kZWwgdG8gdGhlIGRhdGFcbm1vZGVsICU+JSBmaXQoXG4gICAgIGlyaXMudHJhaW5pbmcsIGlyaXMudHJhaW5MYWJlbHMsIFxuICAgICBlcG9jaHMgPSAyMDAsIGJhdGNoX3NpemUgPSA1LCBcbiAgICAgdmFsaWRhdGlvbl9zcGxpdCA9IDAuMlxuIClcblxuIyBFdmFsdWF0ZSB0aGUgbW9kZWxcbnNjb3JlIDwtIG1vZGVsICU+JSBldmFsdWF0ZShpcmlzLnRlc3QsIGlyaXMudGVzdExhYmVscywgYmF0Y2hfc2l6ZSA9IDEyOClcblxuIyBQcmludCB0aGUgc2NvcmVcbnByaW50KHNjb3JlKSJ9\u003c/div\u003e\r\n\r\n\u003cp\u003eNote that, in general, this is not always the best optimilization because, if you don\u0026rsquo;t have a ton of data, the overfitting can and will be worse. That\u0026rsquo;s why you should try use a small network with small datasets as this one.\u003c/p\u003e\r\n\r\n\u003cp\u003eWhy don\u0026rsquo;t you try visualizing the effect of the addition of the hidden nodes in your model? Try it out below:\u003c/p\u003e\r\n\r\n\u003cdiv data-datacamp-exercise=\"\" data-encoded=\"true\" data-height=\"800\"\u003eeyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6InNldC5zZWVkKDEyMzQpXG5saWJyYXJ5KGtlcmFzKVxuaXJpcyA8LSByZWFkLmNzdih1cmwoXCJodHRwOi8vYXJjaGl2ZS5pY3MudWNpLmVkdS9tbC9tYWNoaW5lLWxlYXJuaW5nLWRhdGFiYXNlcy9pcmlzL2lyaXMuZGF0YVwiKSwgaGVhZGVyID0gRkFMU0UpIFxubmFtZXMoaXJpcykgPC0gYyhcIlNlcGFsLkxlbmd0aFwiLCBcIlNlcGFsLldpZHRoXCIsIFwiUGV0YWwuTGVuZ3RoXCIsIFwiUGV0YWwuV2lkdGhcIiwgXCJTcGVjaWVzXCIpXG5pcmlzWyw1XSA8LSBhcy5udW1lcmljKGlyaXNbLDVdKSAtMVxuaXJpcyA8LSBhcy5tYXRyaXgoaXJpcylcbmRpbW5hbWVzKGlyaXMpIDwtIE5VTExcbmluZCA8LSBzYW1wbGUoMiwgbnJvdyhpcmlzKSwgcmVwbGFjZT1UUlVFLCBwcm9iPWMoMC42NywgMC4zMykpXG5pcmlzLnRyYWluaW5nIDwtIGlyaXNbaW5kPT0xLCAxOjRdXG5pcmlzLnRlc3QgPC0gaXJpc1tpbmQ9PTIsIDE6NF1cbmlyaXMudHJhaW5pbmd0YXJnZXQgPC0gaXJpc1tpbmQ9PTEsNV1cbmlyaXMudGVzdHRhcmdldCA8LSBpcmlzW2luZD09MiwgNV1cbmlyaXMudHJhaW5MYWJlbHMgPC0gdG9fY2F0ZWdvcmljYWwoaXJpcy50cmFpbmluZ3RhcmdldClcbmlyaXMudGVzdExhYmVscyA8LSB0b19jYXRlZ29yaWNhbChpcmlzLnRlc3R0YXJnZXQpIiwic2FtcGxlIjoiIyBJbml0aWFsaXplIHRoZSBzZXF1ZW50aWFsIG1vZGVsXG5tb2RlbCA8LSBrZXJhc19tb2RlbF9zZXF1ZW50aWFsKCkgXG5cbiMgQWRkIGxheWVycyB0byB0aGUgbW9kZWxcbm1vZGVsICU+JSBcbiAgICBsYXllcl9kZW5zZSh1bml0cyA9IDI4LCBhY3RpdmF0aW9uID0gJ3JlbHUnLCBpbnB1dF9zaGFwZSA9IGMoNCkpICU+JSBcbiAgICBsYXllcl9kZW5zZSh1bml0cyA9IDMsIGFjdGl2YXRpb24gPSAnc29mdG1heCcpXG5cbiMgQ29tcGlsZSB0aGUgbW9kZWxcbm1vZGVsICU+JSBjb21waWxlKFxuICAgICBsb3NzID0gJ2NhdGVnb3JpY2FsX2Nyb3NzZW50cm9weScsXG4gICAgIG9wdGltaXplciA9ICdhZGFtJyxcbiAgICAgbWV0cmljcyA9ICdhY2N1cmFjeSdcbiApXG5cbiMgU2F2ZSB0aGUgdHJhaW5pbmcgaGlzdG9yeSBpbiB0aGUgaGlzdG9yeSB2YXJpYWJsZVxuaGlzdG9yeSA8LSBtb2RlbCAlPiUgZml0KFxuICBpcmlzLnRyYWluaW5nLCBpcmlzLnRyYWluTGFiZWxzLCBcbiAgZXBvY2hzID0gMjAwLCBiYXRjaF9zaXplID0gNSwgXG4gIHZhbGlkYXRpb25fc3BsaXQgPSAwLjJcbiApXG5cbiMgUGxvdCB0aGUgbW9kZWwgbG9zc1xucGxvdChoaXN0b3J5JG1ldHJpY3MkbG9zcywgbWFpbj1cIk1vZGVsIExvc3NcIiwgeGxhYiA9IFwiZXBvY2hcIiwgeWxhYj1cImxvc3NcIiwgY29sPVwiYmx1ZVwiLCB0eXBlPVwibFwiKVxubGluZXMoaGlzdG9yeSRtZXRyaWNzJHZhbF9sb3NzLCBjb2w9XCJncmVlblwiKVxubGVnZW5kKFwidG9wcmlnaHRcIiwgYyhcInRyYWluXCIsXCJ0ZXN0XCIpLCBjb2w9YyhcImJsdWVcIiwgXCJncmVlblwiKSwgbHR5PWMoMSwxKSlcblxuIyBQbG90IHRoZSBtb2RlbCBhY2N1cmFjeVxucGxvdChoaXN0b3J5JG1ldHJpY3MkYWNjLCBtYWluPVwiTW9kZWwgQWNjdXJhY3lcIiwgeGxhYiA9IFwiZXBvY2hcIiwgeWxhYj1cImFjY3VyYWN5XCIsIGNvbD1cImJsdWVcIiwgdHlwZT1cImxcIilcbmxpbmVzKGhpc3RvcnkkbWV0cmljcyR2YWxfYWNjLCBjb2w9XCJncmVlblwiKVxubGVnZW5kKFwiYm90dG9tcmlnaHRcIiwgYyhcInRyYWluXCIsXCJ0ZXN0XCIpLCBjb2w9YyhcImJsdWVcIiwgXCJncmVlblwiKSwgbHR5PWMoMSwxKSkifQ==\u003c/div\u003e\r\n\r\n\u003ctable align=\"center\" border=\"0\" cellpadding=\"1\" cellspacing=\"1\" style=\"width: 800px;\"\u003e\r\n\t\u003ctbody\u003e\r\n\t\t\u003ctr\u003e\r\n\t\t\t\u003ctd align=\"center\"\u003e\r\n\t\t\t\u003cp\u003e\u003cimg alt=\"neural network model\" src=\"https://s3.amazonaws.com/assets.datacamp.com/blog_assets/Modelfinetune-2a.png\" style=\"width: 430px; height: 304px;\" /\u003e\u003c/p\u003e\r\n\t\t\t\u003c/td\u003e\r\n\t\t\t\u003ctd align=\"center\"\u003e\r\n\t\t\t\u003cp\u003e\u003cimg alt=\"hidden units ann\" src=\"https://s3.amazonaws.com/assets.datacamp.com/blog_assets/Modelfinetune-2b.png\" style=\"width: 430px; height: 304px;\" /\u003e\u003c/p\u003e\r\n\t\t\t\u003c/td\u003e\r\n\t\t\u003c/tr\u003e\r\n\t\u003c/tbody\u003e\r\n\u003c/table\u003e\r\n\u003c/div\u003e\r\n\r\n\u003cdiv class=\"section level3\" id=\"optimization-parameters\"\u003e\r\n\u003ch3\u003eOptimization Parameters\u003c/h3\u003e\r\n\r\n\u003cp\u003eBesides adding layers and playing around with the hidden units, you can also try to adjust (some of) the parameters of the optimization algorithm that you give to the \u003ccode\u003ecompile()\u003c/code\u003e function. Up until now, you have always passed a vector with a string, \u003ccode\u003eadam\u003c/code\u003e, to the \u003ccode\u003eoptimizer\u003c/code\u003e argument.\u003c/p\u003e\r\n\r\n\u003cp\u003eBut that doesn\u0026rsquo;t always need to be like this!\u003c/p\u003e\r\n\r\n\u003cp\u003eAlso, try out experimenting with other optimization algorithms, like the Stochastic Gradient Descent (SGD). Try, for example, using the \u003ccode\u003eoptimizer_sgd()\u003c/code\u003e function to adjust the learning rate \u003ccode\u003elr\u003c/code\u003e. Do you notice an effect?\u003c/p\u003e\r\n\r\n\u003cdiv data-datacamp-exercise=\"\" data-encoded=\"true\" data-height=\"600\"\u003eeyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImxpYnJhcnkoa2VyYXMpXG5pcmlzIDwtIHJlYWQuY3N2KHVybChcImh0dHA6Ly9hcmNoaXZlLmljcy51Y2kuZWR1L21sL21hY2hpbmUtbGVhcm5pbmctZGF0YWJhc2VzL2lyaXMvaXJpcy5kYXRhXCIpLCBoZWFkZXIgPSBGQUxTRSkgXG5uYW1lcyhpcmlzKSA8LSBjKFwiU2VwYWwuTGVuZ3RoXCIsIFwiU2VwYWwuV2lkdGhcIiwgXCJQZXRhbC5MZW5ndGhcIiwgXCJQZXRhbC5XaWR0aFwiLCBcIlNwZWNpZXNcIilcbmlyaXNbLDVdIDwtIGFzLm51bWVyaWMoaXJpc1ssNV0pIC0xXG5pcmlzIDwtIGFzLm1hdHJpeChpcmlzKVxuZGltbmFtZXMoaXJpcykgPC0gTlVMTFxuaW5kIDwtIHNhbXBsZSgyLCBucm93KGlyaXMpLCByZXBsYWNlPVRSVUUsIHByb2I9YygwLjY3LCAwLjMzKSlcbmlyaXMudHJhaW5pbmcgPC0gaXJpc1tpbmQ9PTEsIDE6NF1cbmlyaXMudGVzdCA8LSBpcmlzW2luZD09MiwgMTo0XVxuaXJpcy50cmFpbmluZ3RhcmdldCA8LSBpcmlzW2luZD09MSw1XVxuaXJpcy50ZXN0dGFyZ2V0IDwtIGlyaXNbaW5kPT0yLCA1XVxuaXJpcy50cmFpbkxhYmVscyA8LSB0b19jYXRlZ29yaWNhbChpcmlzLnRyYWluaW5ndGFyZ2V0KVxuaXJpcy50ZXN0TGFiZWxzIDwtIHRvX2NhdGVnb3JpY2FsKGlyaXMudGVzdHRhcmdldCkiLCJzYW1wbGUiOiIjIEluaXRpYWxpemUgYSBzZXF1ZW50aWFsIG1vZGVsXG5tb2RlbCA8LSBrZXJhc19tb2RlbF9zZXF1ZW50aWFsKCkgXG5cbiMgQnVpbGQgdXAgeW91ciBtb2RlbCBieSBhZGRpbmcgbGF5ZXJzIHRvIGl0XG5tb2RlbCAlPiUgXG4gICAgbGF5ZXJfZGVuc2UodW5pdHMgPSA4LCBhY3RpdmF0aW9uID0gJ3JlbHUnLCBpbnB1dF9zaGFwZSA9IGMoNCkpICU+JSBcbiAgICBsYXllcl9kZW5zZSh1bml0cyA9IDMsIGFjdGl2YXRpb24gPSAnc29mdG1heCcpXG5cbiMgRGVmaW5lIGFuIG9wdGltaXplclxuc2dkIDwtIG9wdGltaXplcl9zZ2QobHIgPSAwLjAxKVxuXG4jIFVzZSB0aGUgb3B0aW1pemVyIHRvIGNvbXBpbGUgdGhlIG1vZGVsXG5tb2RlbCAlPiUgY29tcGlsZShvcHRpbWl6ZXI9c2dkLCBcbiAgICAgICAgICAgICAgICAgIGxvc3M9J2NhdGVnb3JpY2FsX2Nyb3NzZW50cm9weScsIFxuICAgICAgICAgICAgICAgICAgbWV0cmljcz0nYWNjdXJhY3knKVxuXG4jIEZpdCB0aGUgbW9kZWwgdG8gdGhlIHRyYWluaW5nIGRhdGFcbm1vZGVsICU+JSBmaXQoXG4gICAgIGlyaXMudHJhaW5pbmcsIGlyaXMudHJhaW5MYWJlbHMsIFxuICAgICBlcG9jaHMgPSAyMDAsIGJhdGNoX3NpemUgPSA1LCBcbiAgICAgdmFsaWRhdGlvbl9zcGxpdCA9IDAuMlxuIClcblxuIyBFdmFsdWF0ZSB0aGUgbW9kZWxcbnNjb3JlIDwtIG1vZGVsICU+JSBldmFsdWF0ZShpcmlzLnRlc3QsIGlyaXMudGVzdExhYmVscywgYmF0Y2hfc2l6ZSA9IDEyOClcblxuIyBQcmludCB0aGUgbG9zcyBhbmQgYWNjdXJhY3kgbWV0cmljc1xucHJpbnQoc2NvcmUpIn0=\u003c/div\u003e\r\n\r\n\u003cp\u003eBesides using another optimizer, you can also try using a smaller learning rate to train your network. This is one of the most common fine-tuning techniques; A common practice is to make the initial learning rate 10 times smaller than the one that you used to train the model before.\u003c/p\u003e\r\n\r\n\u003cp\u003eLet\u0026rsquo;s visualize the training history one more time to see the effect of this small adjustment:\u003c/p\u003e\r\n\r\n\u003cdiv data-datacamp-exercise=\"\" data-encoded=\"true\" data-height=\"700\"\u003eeyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImxpYnJhcnkoa2VyYXMpXG5pcmlzIDwtIHJlYWQuY3N2KHVybChcImh0dHA6Ly9hcmNoaXZlLmljcy51Y2kuZWR1L21sL21hY2hpbmUtbGVhcm5pbmctZGF0YWJhc2VzL2lyaXMvaXJpcy5kYXRhXCIpLCBoZWFkZXIgPSBGQUxTRSkgXG5uYW1lcyhpcmlzKSA8LSBjKFwiU2VwYWwuTGVuZ3RoXCIsIFwiU2VwYWwuV2lkdGhcIiwgXCJQZXRhbC5MZW5ndGhcIiwgXCJQZXRhbC5XaWR0aFwiLCBcIlNwZWNpZXNcIilcbmlyaXNbLDVdIDwtIGFzLm51bWVyaWMoaXJpc1ssNV0pIC0xXG5pcmlzIDwtIGFzLm1hdHJpeChpcmlzKVxuZGltbmFtZXMoaXJpcykgPC0gTlVMTFxuaW5kIDwtIHNhbXBsZSgyLCBucm93KGlyaXMpLCByZXBsYWNlPVRSVUUsIHByb2I9YygwLjY3LCAwLjMzKSlcbmlyaXMudHJhaW5pbmcgPC0gaXJpc1tpbmQ9PTEsIDE6NF1cbmlyaXMudGVzdCA8LSBpcmlzW2luZD09MiwgMTo0XVxuaXJpcy50cmFpbmluZ3RhcmdldCA8LSBpcmlzW2luZD09MSw1XVxuaXJpcy50ZXN0dGFyZ2V0IDwtIGlyaXNbaW5kPT0yLCA1XVxuaXJpcy50cmFpbkxhYmVscyA8LSB0b19jYXRlZ29yaWNhbChpcmlzLnRyYWluaW5ndGFyZ2V0KVxuaXJpcy50ZXN0TGFiZWxzIDwtIHRvX2NhdGVnb3JpY2FsKGlyaXMudGVzdHRhcmdldClcbm1vZGVsIDwtIGtlcmFzX21vZGVsX3NlcXVlbnRpYWwoKSBcbm1vZGVsICU+JSBcbiAgICBsYXllcl9kZW5zZSh1bml0cyA9IDgsIGFjdGl2YXRpb24gPSAncmVsdScsIGlucHV0X3NoYXBlID0gYyg0KSkgJT4lIFxuICAgIGxheWVyX2RlbnNlKHVuaXRzID0gMywgYWN0aXZhdGlvbiA9ICdzb2Z0bWF4JykiLCJzYW1wbGUiOiIjIERlZmluZSBhbiBvcHRpbWl6ZXJcbnNnZCA8LSBvcHRpbWl6ZXJfc2dkKGxyID0gMC4wMSlcblxuIyBDb21waWxlIHRoZSBtb2RlbFxubW9kZWwgJT4lIGNvbXBpbGUob3B0aW1pemVyPXNnZCwgXG4gICAgICAgICAgICAgICAgICBsb3NzPSdjYXRlZ29yaWNhbF9jcm9zc2VudHJvcHknLCBcbiAgICAgICAgICAgICAgICAgIG1ldHJpY3M9J2FjY3VyYWN5JylcblxuIyBGaXQgdGhlIG1vZGVsIHRvIHRoZSB0cmFpbmluZyBkYXRhXG5oaXN0b3J5IDwtIG1vZGVsICU+JSBmaXQoXG4gIGlyaXMudHJhaW5pbmcsIGlyaXMudHJhaW5MYWJlbHMsIFxuICBlcG9jaHMgPSAyMDAsIGJhdGNoX3NpemUgPSA1LCBcbiAgdmFsaWRhdGlvbl9zcGxpdCA9IDAuMlxuIClcblxuIyBQbG90IHRoZSBtb2RlbCBsb3NzXG5wbG90KGhpc3RvcnkkbWV0cmljcyRsb3NzLCBtYWluPVwiTW9kZWwgTG9zc1wiLCB4bGFiID0gXCJlcG9jaFwiLCB5bGFiPVwibG9zc1wiLCBjb2w9XCJibHVlXCIsIHR5cGU9XCJsXCIpXG5saW5lcyhoaXN0b3J5JG1ldHJpY3MkdmFsX2xvc3MsIGNvbD1cImdyZWVuXCIpXG5sZWdlbmQoXCJ0b3ByaWdodFwiLCBjKFwidHJhaW5cIixcInRlc3RcIiksIGNvbD1jKFwiYmx1ZVwiLCBcImdyZWVuXCIpLCBsdHk9YygxLDEpKVxuXG4jIFBsb3QgdGhlIG1vZGVsIGFjY3VyYWN5XG5wbG90KGhpc3RvcnkkbWV0cmljcyRhY2MsIG1haW49XCJNb2RlbCBBY2N1cmFjeVwiLCB4bGFiID0gXCJlcG9jaFwiLCB5bGFiPVwiYWNjdXJhY3lcIiwgY29sPVwiYmx1ZVwiLCB0eXBlPVwibFwiKVxubGluZXMoaGlzdG9yeSRtZXRyaWNzJHZhbF9hY2MsIGNvbD1cImdyZWVuXCIpXG5sZWdlbmQoXCJib3R0b21yaWdodFwiLCBjKFwidHJhaW5cIixcInRlc3RcIiksIGNvbD1jKFwiYmx1ZVwiLCBcImdyZWVuXCIpLCBsdHk9YygxLDEpKSJ9\u003c/div\u003e\r\n\r\n\u003ctable align=\"center\" border=\"0\" cellpadding=\"1\" cellspacing=\"1\" style=\"width: 800px;\"\u003e\r\n\t\u003ctbody\u003e\r\n\t\t\u003ctr\u003e\r\n\t\t\t\u003ctd align=\"center\"\u003e\r\n\t\t\t\u003cp\u003e\u003cimg alt=\"neural network model\" src=\"https://s3.amazonaws.com/assets.datacamp.com/blog_assets/Modelfinetune-3a.png\" style=\"width: 430px; height: 304px;\" /\u003e\u003c/p\u003e\r\n\t\t\t\u003c/td\u003e\r\n\t\t\t\u003ctd align=\"center\"\u003e\r\n\t\t\t\u003cp\u003e\u003cimg alt=\"hidden units ann\" src=\"https://s3.amazonaws.com/assets.datacamp.com/blog_assets/Modelfinetune-3b.png\" style=\"width: 430px; height: 304px;\" /\u003e\u003c/p\u003e\r\n\t\t\t\u003c/td\u003e\r\n\t\t\u003c/tr\u003e\r\n\t\u003c/tbody\u003e\r\n\u003c/table\u003e\r\n\u003c/div\u003e\r\n\r\n\u003ch2 id=\"save\"\u003eSaving, Loading or Exporting Your Model\u003c/h2\u003e\r\n\r\n\u003cp\u003eThere is one last thing that remains in your journey with the \u003ccode\u003ekeras\u003c/code\u003e package and that is saving or exporting your model so that you can load it back in at another moment.\u003c/p\u003e\r\n\r\n\u003cul\u003e\r\n\t\u003cli\u003eFirstly, you can easily make use of the \u003ccode\u003esave_model_hdf5()\u003c/code\u003e and \u003ccode\u003eload_model_hdf5()\u003c/code\u003e functions to save and load your model into your workspace:\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\r\n\u003cpre\u003e\r\n\u003ccode\u003esave_model_hdf5(model, \"my_model.h5\")\r\nmodel \u0026lt;- load_model_hdf5(\"my_model.h5\")\u003c/code\u003e\u003c/pre\u003e\r\n\r\n\u003cul\u003e\r\n\t\u003cli\u003eAdditionally, you can also save and load the model weights with the \u003ccode\u003esave_model_weights_hdf5()\u003c/code\u003e and \u003ccode\u003eload_model_weights_hdf5()\u003c/code\u003e functions:\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\r\n\u003cpre\u003e\r\n\u003ccode\u003esave_model_weights_hdf5(\"my_model_weights.h5\")\r\nmodel %\u0026gt;% load_model_weights_hdf5(\"my_model_weights.h5\")\u003c/code\u003e\u003c/pre\u003e\r\n\r\n\u003cul\u003e\r\n\t\u003cli\u003eLastly, it\u0026rsquo;s good to know that you can also export your model configuration to JSON or YAML. Here, the functions \u003ccode\u003emodel_to_json()\u003c/code\u003e and \u003ccode\u003emodel_to_yaml()\u003c/code\u003e will help you out. To load the configurations back into your workspace, you can just use the \u003ccode\u003emodel_from_json()\u003c/code\u003e and \u003ccode\u003emodel_from yaml()\u003c/code\u003e functions:\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\r\n\u003cpre\u003e\r\n\u003ccode\u003ejson_string \u0026lt;- model_to_json(model)\r\nmodel \u0026lt;- model_from_json(json_string)\r\n\r\nyaml_string \u0026lt;- model_to_yaml(model)\r\nmodel \u0026lt;- model_from_yaml(yaml_string)\u003c/code\u003e\u003c/pre\u003e\r\n\r\n\u003cp\u003e\u003ca href=\"https://www.datacamp.com/courses/\" target=\"_blank\"\u003e\u003cimg alt=\"Learn Python for Data Science With DataCamp\" src=\"http://community.datacamp.com.s3.amazonaws.com/community/production/ckeditor_assets/pictures/293/content_blog_banner.png\" /\u003e\u003c/a\u003e\u003c/p\u003e\r\n\r\n\u003cdiv class=\"section level2\" id=\"deep-learning-with-keras\"\u003e\r\n\u003ch2\u003eDeep Learning With Keras\u003c/h2\u003e\r\n\r\n\u003cp\u003eCongrats! You\u0026rsquo;ve made it through this deep learning tutorial in R with \u003ccode\u003ekeras\u003c/code\u003e. This tutorial was just one small step in your deep learning journey with R; There\u0026rsquo;s much more to cover! If you haven\u0026rsquo;t taken DataCamp\u0026rsquo;s \u003ca href=\"https://www.datacamp.com/courses/deep-learning-in-python\"\u003eDeep Learning in Python\u003c/a\u003e course, you might consider doing so.\u003c/p\u003e\r\n\r\n\u003cp\u003eIn the meantime, also make sure to check out the \u003ca href=\"https://keras.io/\"\u003eKeras documentation\u003c/a\u003e and the RStudio \u003ca href=\"https://rstudio.github.io/keras/\"\u003e\u003ccode\u003ekeras\u003c/code\u003e documentation\u003c/a\u003e if you haven\u0026rsquo;t done so already. You\u0026rsquo;ll find more examples and information on all functions, arguments, more layers, etc\u0026hellip; Also check out Fran\u0026ccedil;ois Chollet\u0026rsquo;s book \u003ca href=\"https://www.manning.com/books/deep-learning-with-python\"\u003e\u0026ldquo;Deep Learning with Python\u0026rdquo;\u003c/a\u003e. All these resources will undoubtedly be indispensable in learning how to work with neural networks in R!\u003c/p\u003e\r\n\u003c/div\u003e\r\n","contentUrl":"http://www.datacamp.com/community/tutorials/keras-r-deep-learning","userContentUrl":null,"illustrationUrl":null,"seoTitle":"keras: Deep Learning in R","seoMetaDescription":"In this tutorial to deep learning in R with RStudio's keras package, you'll learn how to build a Multi-Layer Perceptron (MLP).","seoKeyword":"keras R","mustRead":true,"programmingLanguage":null,"submissionDate":"2017-06-28T12:50:19.000Z","publishDate":"2017-06-28T14:09:19.000Z","episode":null,"isLatest":null,"externalUrl":null,"transcriptUrl":null,"guests":null,"links":null,"isSpam":false,"xp":0,"flaggingUsers":[],"isDisabled":false,"createdAt":"2017-09-08T15:37:41.007Z","updatedAt":"2017-10-30T15:20:06.217Z","upvoting":{"voteCount":16,"voted":false},"tags":["r programming","machine learning"],"author":{"id":494311,"slug":"karlijn","avatarUrlSquare":"https://assets.datacamp.com/users/avatars/000/494/311/square/Screenshot_2017-04-26_16.02.58.png?1493215479","fullName":"Karlijn Willems"},"recommendedArticles":[]},"isFetched":true,"isFetching":false,"statusMessage":""},"countdownBanner":{"isBannerOpen":false},"form":{},"list":{"isFetched":false,"isFetching":false,"statusMessage":"","flagAsSpam":{"isFlaggingAsSpam":false,"isSucceeded":false,"statusMessage":"","isFlagAsSpamModalOpen":false}},"menu":{"isSidebarMenuOpen":false},"preview":{"isFetching":false,"isFetched":false,"statusMessage":"","content":{}},"recommendCS":{"isPosting":false,"isPosted":false,"statusMessage":"","isModalOpen":false,"currentStep":"form"},"tag":{"isRequesting":false,"isSucceeded":false,"statusMessage":"","isDeleteTagModalOpen":false},"tagList":{"isFetched":false,"isFetching":false,"statusMessage":"","list":[],"total":0},"tagSearch":{"isFetching":false,"isFetched":false,"statusMessage":"","content":{}},"user":{"isFetching":false,"isFetched":false,"statusMessage":"","unBan":{"isUnBanning":false,"isSucceeded":false,"statusMessage":"","isUnBanUserModalOpen":false},"ban":{"isBanning":false,"isSucceeded":false,"statusMessage":"","isBanUserModalOpen":false}},"writeTutorial":{"isPosting":false,"isPosted":false,"statusMessage":"","isModalOpen":false,"currentStep":"form"},"submitArticle":{"isPosting":false,"isPosted":false,"statusMessage":"","timer":0,"articleSlug":"","isModalOpen":false,"currentStep":"form","slug":""}},"initialProps":{"asPath":"/community/tutorials/keras-r-deep-learning"}},"pathname":"/community/tutorial","query":{"0":"/community","slug":"keras-r-deep-learning"},"buildId":"7759f328-f79b-4d89-8dde-23ed7b7ad722","buildStats":{"app.js":{"hash":"b43ba2541e01c338d45f9bbeef2327b8"}},"assetPrefix":"/community","nextExport":false,"err":null,"chunks":[]}
          module={}
          __NEXT_LOADED_PAGES__ = []
          __NEXT_LOADED_CHUNKS__ = []

          __NEXT_REGISTER_PAGE = function (route, fn) {
            __NEXT_LOADED_PAGES__.push({ route: route, fn: fn })
          }

          __NEXT_REGISTER_CHUNK = function (chunkName, fn) {
            __NEXT_LOADED_CHUNKS__.push({ chunkName: chunkName, fn: fn })
          }
        </script><script async="" id="__NEXT_PAGE__/community/tutorial" type="text/javascript" src="./keras_ Deep Learning in R (article) - DataCamp_files/tutorial"></script><script async="" id="__NEXT_PAGE__/_error" type="text/javascript" src="./keras_ Deep Learning in R (article) - DataCamp_files/index.js.téléchargement"></script><div></div><script type="text/javascript" src="./keras_ Deep Learning in R (article) - DataCamp_files/app.js.téléchargement" async=""></script></div><div class="ReactModalPortal"><!-- react-empty: 1 --></div><div class="ReactModalPortal"><!-- react-empty: 1 --></div><div class="ReactModalPortal"><!-- react-empty: 1 --></div><div class="ReactModalPortal"><!-- react-empty: 1 --></div><script type="text/javascript" src="./keras_ Deep Learning in R (article) - DataCamp_files/script-8fa338a2dc.js.téléchargement" charset="utf-8"></script></body></html>